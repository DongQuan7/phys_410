(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 7.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[    266674,       7168]
NotebookOptionsPosition[    254577,       6839]
NotebookOutlinePosition[    255816,       6879]
CellTagsIndexPosition[    255648,       6872]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[" "], "Input",
 CellChangeTimes->{3.509873126009877*^9}],

Cell[CellGroupData[{

Cell["Maxwell's Equations and FDTD Methods", "Title",
 CellChangeTimes->{{3.483180423412797*^9, 3.483180450596274*^9}},
 TextAlignment->Center,
 TextJustification->0.],

Cell[TextData[{
 "Richard Gass\nDepartment of Physics, University of Cincinnati\nCincinnati, \
OH 45221-0011\n",
 ButtonBox["Richard.Gass@uc.edu",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["mailto:Richard.Gass@uc.edu"], None}],
 "\n"
}], "Text",
 CellChangeTimes->{{3.36360110496947*^9, 3.36360115623952*^9}, {
   3.36360153573163*^9, 3.36360156883206*^9}, 3.36360428621033*^9},
 TextAlignment->Center,
 TextJustification->0.],

Cell["Last Revision June 18, 2011", "Subsubsubsection",
 CellChangeTimes->{{3.3913330875829363`*^9, 3.3913331101017857`*^9}, 
   3.391850253548749*^9, {3.3926335367524443`*^9, 3.392633539452767*^9}, {
   3.396950314611517*^9, 3.3969503238019867`*^9}, {3.407667540541306*^9, 
   3.4076675463911123`*^9}, {3.411813773066407*^9, 3.411813791856448*^9}, {
   3.413630609506401*^9, 3.413630613942868*^9}, {3.416044239791071*^9, 
   3.416044244004476*^9}, {3.4187496091967382`*^9, 3.4187496103237257`*^9}, 
   3.419066960568866*^9, 3.4193474084497557`*^9, {3.419582904649321*^9, 
   3.4195829049002333`*^9}, {3.4197565025385933`*^9, 3.4197565071475487`*^9}, 
   3.419950597599698*^9, 3.420046054209593*^9, {3.42044805993511*^9, 
   3.4204480600918703`*^9}, {3.423560937710206*^9, 3.4235609419457417`*^9}, {
   3.4253733282095003`*^9, 3.4253733340957537`*^9}, {3.42891543323608*^9, 
   3.428915442951768*^9}, {3.434907171826824*^9, 3.43490717877463*^9}, {
   3.4391181798103237`*^9, 3.439118183376328*^9}, {3.448377625739274*^9, 
   3.4483776363873177`*^9}, 3.4487061613954363`*^9, 3.44898918110893*^9, {
   3.4493105016958933`*^9, 3.449310505627624*^9}, {3.4501969867134323`*^9, 
   3.450196989646714*^9}, 3.4501971874403963`*^9, 3.450719805903612*^9, {
   3.5147365668097963`*^9, 3.5147365705354633`*^9}, {3.517417106330099*^9, 
   3.517417106894211*^9}}],

Cell[CellGroupData[{

Cell["Note to the student", "Subsubsection",
 CellChangeTimes->{{3.391250661063683*^9, 3.391250668130063*^9}}],

Cell["\<\
All the exercises in this notebook call for written responses not just code. \
You should clearly explain what you are doing, why you are doing it and why \
you believe (or don't believe) your results.  You should discuss what your \
results mean and if appropriate what further lines of investigation might be \
fruitful. Each exercise is both a conceptual and writing exercise as well as \
a physics/computational problem.\
\>", "Text",
 CellChangeTimes->{{3.391250684042802*^9, 3.391250920507225*^9}, {
  3.449310637707385*^9, 3.449310795628626*^9}}],

Cell[CellGroupData[{

Cell["What to do if the code does not work", "Subsubsubsection",
 CellChangeTimes->{{3.39125093353386*^9, 3.3912509447016373`*^9}}],

Cell[TextData[{
 "This notebook is designed to run with ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " 7 and 8. The code will probably work in future versions of ",
 StyleBox["Mathematica,",
  FontSlant->"Italic"],
 " but large portions of the code will not work in version 5. Most of the \
code should work in version 6.  If the code does not work in versions 7 or 8 \
the problem is almost certainly one of two things: 1) you forgot to run a \
line of code earlier in the notebook or 2) you used a variable or a name that \
is used for another propose in the notebook, and you now have a naming \
conflict."
}], "Text",
 CellChangeTimes->{{3.391250995224416*^9, 3.391251278467778*^9}, {
   3.392541475514779*^9, 3.3925415571210814`*^9}, {3.4391156727848577`*^9, 
   3.43911569179067*^9}, 3.4391182117710657`*^9, {3.448377611590144*^9, 
   3.448377613417856*^9}, {3.5147365798172483`*^9, 3.514736636203493*^9}, {
   3.5173251045500107`*^9, 3.517325125932527*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Note to the instructor", "Subsubsection",
 CellChangeTimes->{{3.391252493036511*^9, 3.391252522202464*^9}}],

Cell["\<\
I have tried to arrange the material in this notebook so that it can be used \
in a flexible manner.  The sections on one and two-dimensional propagation \
are essentially independent so you could skip one of them if you are pressed \
for time.\
\>", "Text",
 CellChangeTimes->{{3.391252518563972*^9, 3.39125284969843*^9}, {
   3.391331272538376*^9, 3.391331297037087*^9}, {3.391332473781488*^9, 
   3.3913325170531816`*^9}, {3.39133284511215*^9, 3.39133287030167*^9}, {
   3.3913330053582487`*^9, 3.391333005404449*^9}, {3.391790301803994*^9, 
   3.391790323335936*^9}, 3.391790370009686*^9, {3.39179042182712*^9, 
   3.391790443599861*^9}, {3.39254161514739*^9, 3.392541658296438*^9}, {
   3.439115902047827*^9, 3.439116072374901*^9}, {3.4391165336556273`*^9, 
   3.439116535190691*^9}, 3.4391176959445477`*^9, 3.4391182385781507`*^9, 
   3.4501971998948812`*^9, {3.514738147767149*^9, 3.514738191494996*^9}, {
   3.517325132348588*^9, 3.517325132668461*^9}}],

Cell["", "Text"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Prerequisites ", "Subsubsection",
 CellChangeTimes->{{3.397298243948084*^9, 3.39729829455844*^9}}],

Cell[CellGroupData[{

Cell["Software", "Subsubsubsection",
 CellChangeTimes->{{3.39729834423457*^9, 3.397298345758226*^9}}],

Cell[TextData[{
 StyleBox["Students should have a basic familiarity with ",
  FontFamily->"Times New Roman",
  FontSize->12,
  FontWeight->"Plain"],
 StyleBox["Mathematica",
  FontFamily->"Times New Roman",
  FontSize->12,
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[". They do not need to be ",
  FontFamily->"Times New Roman",
  FontSize->12,
  FontWeight->"Plain"],
 StyleBox["Mathematica",
  FontFamily->"Times New Roman",
  FontSize->12,
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[" experts but they do need to know how to run code, make simple \
plots, and understand the basics of ",
  FontFamily->"Times New Roman",
  FontSize->12,
  FontWeight->"Plain"],
 StyleBox["Mathematica",
  FontFamily->"Times New Roman",
  FontSize->12,
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[" syntax.",
  FontFamily->"Times New Roman",
  FontSize->12,
  FontWeight->"Plain"]
}], "Text",
 CellChangeTimes->{{3.397299488378887*^9, 3.397299520759121*^9}, 
   3.450197208527246*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Mathematics", "Subsubsubsection",
 CellChangeTimes->{{3.397298788018077*^9, 3.3972988001743507`*^9}}],

Cell[TextData[StyleBox["The minimum mathematics prerequisite is a full year \
of calculus and an introduction to vector calculus.",
 FontFamily->"Times New Roman",
 FontSize->12,
 FontWeight->"Plain"]], "Text",
 CellChangeTimes->{{3.3973008707296658`*^9, 3.397300878702862*^9}, 
   3.397315467931181*^9, {3.439116201622632*^9, 3.439116286071046*^9}, {
   3.51473686049365*^9, 3.5147368717474527`*^9}, {3.51473746567601*^9, 
   3.514737497099684*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Physics", "Subsubsubsection",
 CellChangeTimes->{{3.397298803231997*^9, 3.3972988046942787`*^9}, {
  3.397298876841387*^9, 3.3972988963105173`*^9}}],

Cell[TextData[StyleBox["The desired physics prerequisite is a full year of \
calculus-based physics with a co-requisite of a second or third year course \
in electricity and magnetism. The minimum physics prerequisite is a full year \
of calculus-based physics and having seen Maxwell\[CloseCurlyQuote]s \
equations in differential form.",
 FontFamily->"Times New Roman",
 FontSize->12,
 FontWeight->"Plain"]], "Text",
 CellChangeTimes->{{3.3973156597397337`*^9, 3.397315676776623*^9}, {
   3.397315709039543*^9, 3.3973158152741203`*^9}, 3.397316312635676*^9, {
   3.3973163585382137`*^9, 3.397316360593012*^9}, {3.439116116479341*^9, 
   3.439116178167921*^9}, 3.4391177173442307`*^9, 3.450197325647094*^9, {
   3.514736695164497*^9, 3.5147368358019753`*^9}, 3.517325150365448*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Module Objectives", "Subsubsection",
 CellChangeTimes->{{3.3972989005781813`*^9, 3.3972989174385433`*^9}}],

Cell["\<\
After completion of this module students should:

\[Bullet]\tUnderstand forward difference time domain methods.

\[Bullet]\tUnderstand how to implement the Yee method.

\[Bullet]\tUnderstand how to go from computational units to physical units.

\[Bullet]\tUnderstand how to check the accuracy of their solutions.

\[Bullet]\tHave developed a better intuition about electromagnetic wave \
propagation.\
\>", "Text",
 CellChangeTimes->{{3.3973158382507963`*^9, 3.397315862912442*^9}, {
   3.397315918248431*^9, 3.3973159219468327`*^9}, 3.397316346019843*^9, {
   3.5147377427354603`*^9, 3.514737756487275*^9}, 3.5173251756938334`*^9}],

Cell["", "Text",
 CellChangeTimes->{{3.3973161255496817`*^9, 3.397316147696436*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Competencies covered in this notebook", "Subsubsection",
 CellChangeTimes->{{3.391333011649397*^9, 3.391333064741597*^9}, {
  3.392541666840343*^9, 3.3925416674169416`*^9}}],

Cell[TextData[StyleBox["Modeling", "Subsubsubsection",
 FontFamily->"Times",
 FontSlant->"Plain"]], "Text",
 CellChangeTimes->{{3.3918521888010817`*^9, 3.391852190447682*^9}}],

Cell[TextData[{
 "1.3 ",
 StyleBox["Create a conceptual model ",
  FontFamily->"Times New Roman"],
 "\n",
 StyleBox["1.4 Examine various mathematical representations of functions",
  FontFamily->"Times New Roman",
  FontSize->12],
 "\n",
 StyleBox["1.5 Analyze issues in accuracy and precision",
  FontFamily->"Times New Roman",
  FontSize->12],
 "\n",
 StyleBox["1.7 Demonstrate computational programming utilizing a higher level \
language ",
  FontFamily->"Times New Roman",
  FontSize->12]
}], "Text",
 CellChangeTimes->{{3.3918521195929193`*^9, 3.391852119622875*^9}, 
   3.391852224698697*^9}],

Cell[TextData[StyleBox["Programming and Algorithms",
 FontWeight->"Bold"]], "Text",
 CellChangeTimes->{{3.391854313692523*^9, 3.3918543183360167`*^9}, {
  3.439117438703961*^9, 3.439117451006323*^9}}],

Cell[TextData[{
 StyleBox["2.4 Write code in a programming language",
  FontFamily->"Times New Roman",
  FontSize->12],
 "\n2.6 Understanding and use of fundamental programming Algorithms"
}], "Text",
 CellChangeTimes->{{3.391854364808996*^9, 3.391854380704938*^9}, {
   3.391854591747476*^9, 3.391854594592107*^9}, {3.392541788245043*^9, 
   3.3925417903952637`*^9}, {3.439117354000338*^9, 3.4391173551426783`*^9}, {
   3.439117475931288*^9, 3.439117513486521*^9}, {3.4391175439518414`*^9, 
   3.43911757729434*^9}, 3.4391177249989758`*^9}],

Cell[TextData[StyleBox["Numerical Methods",
 FontWeight->"Bold"]], "Text",
 CellChangeTimes->{{3.391854313692523*^9, 3.3918543183360167`*^9}}],

Cell[TextData[{
 "4.7",
 StyleBox[" Describe numerical methods for Partial Differential Equations ",
  FontFamily->"Times New Roman"]
}], "Text",
 CellChangeTimes->{{3.391854364808996*^9, 3.391854380704938*^9}, {
   3.391854591747476*^9, 3.391854594592107*^9}, {3.392541788245043*^9, 
   3.3925417903952637`*^9}, {3.439117354000338*^9, 3.4391173551426783`*^9}, 
   3.5147377043653717`*^9, 3.5147377674086246`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Key Words", "Subsubsection",
 CellChangeTimes->{{3.3972989005781813`*^9, 3.3972989174385433`*^9}, {
   3.449413563556991*^9, 3.449413566194931*^9}, 3.517325198919338*^9}],

Cell["\<\
Forward Difference Time Domain, Yee Algorithm, Yee Method, Maxwell\
\[CloseCurlyQuote]s equations,
photonic structures, meta-materials\
\>", "Text",
 CellChangeTimes->{{3.3973158382507963`*^9, 3.397315862912442*^9}, {
   3.397315918248431*^9, 3.3973159219468327`*^9}, 3.397316346019843*^9, {
   3.449413571972061*^9, 3.449413673851117*^9}, {3.514737316310835*^9, 
   3.5147373865755367`*^9}, {3.514737424210227*^9, 3.514737445930233*^9}, 
   3.514737653419417*^9}],

Cell["", "Text",
 CellChangeTimes->{{3.3973161255496817`*^9, 3.397316147696436*^9}}],

Cell[TextData[{
 "The development of photonic structures and meta-materials has made \
classical optics a hot topic in physics and engineering. Photonic structures \
are periodic structures in which the dielectric constant varies on the \
nanometer scale.  This is sometimes called designer electromagnetism, since \
you can tailor your material to produce the optical properties you desire. A \
clear and comprehensive if somewhat advanced book on the subject is \
\[OpenCurlyDoubleQuote]",
 StyleBox["Photonic Crystals: Molding the Flow of Light",
  FontSlant->"Italic"],
 "\[CloseCurlyDoubleQuote] by Joannopoulas, Johnson, Winn and Meade [1]. It \
is available on-line at ",
 ButtonBox["http://ab-initio.mit.edu/book/",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://ab-initio.mit.edu/book/"], None},
  ButtonNote->"http://ab-initio.mit.edu/book/"],
 ".  Photonic structures are often man-made but also occur in nature. \
Photonics structure are responsible for the iridescent spots of some \
butterfly wings and the coloration of some beetles (see for example Vukusic \
and Sambles[2]).\n\nMetamaterials are also periodic structures but have \
features that are smaller than the wavelength of the electromagnetic \
radiation they are designed for. As a result they can be treated as \
homogeneous materials. They can have indexes of refraction that are negative.\
\n"
}], "Text",
 CellChangeTimes->{{3.4831805262722263`*^9, 3.483180624450963*^9}, {
   3.4831818129152*^9, 3.483181818071581*^9}, {3.4831970554016333`*^9, 
   3.483197062055613*^9}, {3.485512834529447*^9, 3.485512900003975*^9}, {
   3.485512951133809*^9, 3.4855129967117653`*^9}, {3.485513196762577*^9, 
   3.4855132351684437`*^9}, {3.485879047040962*^9, 3.4858790503366632`*^9}, {
   3.514738221442285*^9, 3.514738251193418*^9}, {3.514738372463368*^9, 
   3.5147383830782223`*^9}, {3.5147385036445007`*^9, 3.514738599639059*^9}, {
   3.514738995703795*^9, 3.51473904344812*^9}, {3.514739081754148*^9, 
   3.514739318674917*^9}, {3.514739710848171*^9, 3.514739814022691*^9}, {
   3.514740609040163*^9, 3.5147407372184153`*^9}, {3.514740935577745*^9, 
   3.5147409867974157`*^9}, {3.514741317909602*^9, 3.514741381907731*^9}, {
   3.514814650221599*^9, 3.5148148463553677`*^9}, 3.514815777734726*^9, {
   3.5148169806555033`*^9, 3.5148169868888407`*^9}, {3.514819410444509*^9, 
   3.514819424453141*^9}, {3.517325233888698*^9, 3.517325335831388*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["The Yee method", "Subtitle",
 CellChangeTimes->{{3.4861417198888617`*^9, 3.486141730391938*^9}}],

Cell["\<\
A common method for solving Maxwell's equations is the forward difference \
time domain, or FDTD method. A common implementation of the method uses Yee's \
method [3].  The basic idea behind the method is simple and easy to program. \
See Ward and Nelson [4] for a spreadsheet implementation and Sipos and \
Thompson [5] for a good introduction with an application to cloaking. \
Maxwell's equations are \
\>", "Text",
 CellChangeTimes->{{3.4831805262722263`*^9, 3.483180624450963*^9}, {
  3.4831818129152*^9, 3.483181818071581*^9}, {3.4831970554016333`*^9, 
  3.483197062055613*^9}, {3.485512834529447*^9, 3.485512900003975*^9}, {
  3.485512951133809*^9, 3.4855129967117653`*^9}, {3.485513196762577*^9, 
  3.485513226007999*^9}, {3.486141118644418*^9, 3.486141168778861*^9}, {
  3.4862877187857237`*^9, 3.486287724593627*^9}, {3.514739684282319*^9, 
  3.514739689011653*^9}, {3.514740988966131*^9, 3.5147409934695272`*^9}, {
  3.517325345525776*^9, 3.517325346020797*^9}}],

Cell[TextData[Cell[BoxData[
 FormBox[GridBox[{
    {GridBox[{
       {
        RowBox[{
         RowBox[{
          RowBox[{"\[Del]", 
           RowBox[{"\[CenterDot]", 
            StyleBox["D",
             FontWeight->"Bold"]}]}], "=", "\[Rho]"}], "\[IndentingNewLine]", 
         
         RowBox[{
          RowBox[{"\[Del]", 
           RowBox[{"\[Cross]", "H"}]}], "=", 
          RowBox[{"J", "+", 
           FractionBox[
            RowBox[{"\[PartialD]", 
             StyleBox["D",
              FontWeight->"Bold"]}], 
            RowBox[{"\[PartialD]", "t"}]]}]}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Del]", 
            RowBox[{"\[Cross]", 
             StyleBox["E",
              FontWeight->"Bold"]}]}], "+", 
           FractionBox[
            RowBox[{"\[PartialD]", 
             StyleBox["B",
              FontWeight->"Bold"]}], 
            RowBox[{"\[PartialD]", "t"}]]}], "=", "0"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"\[Del]", 
           RowBox[{"\[CenterDot]", 
            StyleBox["B",
             FontWeight->"Bold"]}]}], "=", "0"}]}]}
      },
      GridBoxAlignment->{"Columns" -> {{"Center"}}}]}
   },
   GridBoxItemSize->{"Columns" -> {{
        Scaled[0.96]}}}], TraditionalForm]]]], "Text",
 CellChangeTimes->{
  3.4831996286395693`*^9, {3.483199681085103*^9, 3.483199872003273*^9}, {
   3.483200274446169*^9, 3.483200283211649*^9}, {3.483200332845186*^9, 
   3.4832003343326817`*^9}}],

Cell[TextData[{
 "where ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    StyleBox["D",
     FontWeight->"Bold"], "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["\[Epsilon]", "0"], 
       StyleBox["E",
        FontWeight->"Bold"]}], "+", 
      RowBox[{
       StyleBox["P",
        FontWeight->"Bold"], " ", "and", " ", 
       StyleBox["H",
        FontWeight->"Bold"]}]}], "=", 
     RowBox[{
      RowBox[{
       FractionBox["1", 
        SubscriptBox["\[Mu]", "0"]], 
       StyleBox["B",
        FontWeight->"Bold"]}], "-", 
      StyleBox["M",
       FontWeight->"Bold"]}]}]}], TraditionalForm]]],
 ". Here ",
 Cell[BoxData[
  FormBox[
   StyleBox["P",
    FontWeight->"Bold"], TraditionalForm]]],
 " is the electric polarization, that is the dipole moment per unit volume, \
and ",
 Cell[BoxData[
  FormBox[
   StyleBox["M",
    FontWeight->"Bold"], TraditionalForm]]],
 " is the magnetization which is the magnetic moment density. In free space \
with no sources or sinks, Maxwell's equations reduce to"
}], "Text",
 CellChangeTimes->{{3.483199931357321*^9, 3.483200011783688*^9}, {
  3.483200337291607*^9, 3.483200421194868*^9}, {3.4832005063464117`*^9, 
  3.4832006040539713`*^9}, {3.483201562019375*^9, 3.483201565026291*^9}, {
  3.517325377081233*^9, 3.517325383039125*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{"\t\t\t\t\t", GridBox[{
     {
      RowBox[{
       RowBox[{
        RowBox[{"\[Del]", 
         RowBox[{"\[CenterDot]", 
          StyleBox["E",
           FontWeight->"Bold"]}]}], "=", "0"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Del]", 
         RowBox[{"\[Cross]", "H"}]}], "=", 
        FractionBox[
         RowBox[{"\[PartialD]", 
          StyleBox["D",
           FontWeight->"Bold"]}], 
         RowBox[{"\[PartialD]", "t"}]]}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Del]", 
          RowBox[{"\[Cross]", 
           StyleBox["E",
            FontWeight->"Bold"]}]}], "+", 
         FractionBox[
          RowBox[{"\[PartialD]", 
           StyleBox["B",
            FontWeight->"Bold"]}], 
          RowBox[{"\[PartialD]", "t"}]]}], "=", "0"}], "\[IndentingNewLine]", 
       
       RowBox[{
        RowBox[{"\[Del]", 
         RowBox[{"\[CenterDot]", 
          StyleBox["B",
           FontWeight->"Bold"]}]}], "=", "0"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{"Center"}}}]}], 
  TraditionalForm]], "Input",
 CellChangeTimes->{{3.4832006198353033`*^9, 3.48320062216774*^9}, {
  3.4832007943534727`*^9, 3.483200794797555*^9}, {3.483201701594552*^9, 
  3.483201705730548*^9}},
 TextAlignment->Left,
 TextJustification->0.],

Cell[TextData[{
 "where since in empty space ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    StyleBox["P",
     FontWeight->"Bold"], "=", 
    RowBox[{
     RowBox[{"0", " ", "and", " ", 
      StyleBox["M",
       FontWeight->"Bold"]}], "=", "0"}]}], TraditionalForm]]],
 " we have ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    StyleBox["D",
     FontWeight->"Bold"], "=", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[Epsilon]", "0"], " ", 
      StyleBox["E",
       FontWeight->"Bold"], 
      StyleBox[" ",
       FontWeight->"Bold"], "and", " ", 
      StyleBox["H",
       FontWeight->"Bold"]}], "=", 
     RowBox[{
      FractionBox["1", 
       SubscriptBox["\[Mu]", "0"]], 
      StyleBox["B",
       FontWeight->"Bold"]}]}]}], TraditionalForm]]],
 ".  If we are not in free space but in a linear isotropic media, then ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    StyleBox["D",
     FontWeight->"Bold"], "=", 
    RowBox[{
     RowBox[{"\[Epsilon]", " ", 
      StyleBox["E",
       FontWeight->"Bold"], 
      StyleBox[" ",
       FontWeight->"Bold"], "and", " ", 
      StyleBox["H",
       FontWeight->"Bold"]}], "=", 
     RowBox[{
      FractionBox["1", "\[Mu]"], 
      StyleBox["B",
       FontWeight->"Bold"]}]}]}], TraditionalForm]]],
 "."
}], "Text",
 CellChangeTimes->{{3.483201568889811*^9, 3.4832016503167458`*^9}, {
   3.4832017151460857`*^9, 3.4832017670573187`*^9}, {3.485511231561049*^9, 
   3.4855112479894047`*^9}, {3.4855138497228518`*^9, 3.4855138921856213`*^9}, 
   3.485878871259763*^9, {3.486114517779009*^9, 3.486114559082736*^9}, {
   3.486114623452499*^9, 3.486114703191409*^9}, {3.5173254103505774`*^9, 
   3.5173254301499567`*^9}}],

Cell[TextData[{
 "In the FDTD method we replace both the spatial and temporal derivatives by \
central differences but we stagger them so that the electric and magnetic \
fields are interleaved in both space and time. We do this by making the \
replacements\n ",
 Cell[BoxData[{
  FormBox[
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{"\[PartialD]", 
       RowBox[{
        SubscriptBox["E", "x"], "(", 
        RowBox[{"z", ",", " ", "t"}], ")"}]}], 
      RowBox[{"\[PartialD]", "t"}]], "\[Rule]", 
     FractionBox[
      RowBox[{
       RowBox[{
        SubscriptBox["E", "x"], "(", 
        RowBox[{"z", ",", " ", 
         RowBox[{"t", "+", 
          RowBox[{"\[CapitalDelta]t", "/", "2"}]}]}], ")"}], "-", 
       RowBox[{
        SubscriptBox["E", "x"], "(", 
        RowBox[{"z", ",", " ", 
         RowBox[{"t", "-", 
          RowBox[{"\[CapitalDelta]t", "/", "2"}]}]}], ")"}]}], 
      "\[CapitalDelta]t"]}], ",", "\[IndentingNewLine]", 
    RowBox[{
     FractionBox[
      RowBox[{"\[PartialD]", 
       RowBox[{
        SubscriptBox["E", "x"], "(", 
        RowBox[{"z", ",", " ", "t"}], ")"}]}], 
      RowBox[{"\[PartialD]", "z"}]], "\[Rule]", 
     FractionBox[
      RowBox[{
       RowBox[{
        SubscriptBox["E", "x"], "(", 
        RowBox[{
         RowBox[{"z", "+", "\[CapitalDelta]z"}], ",", " ", "t"}], ")"}], "-", 
       
       RowBox[{
        SubscriptBox["E", "x"], "(", 
        RowBox[{"z", ",", " ", "t"}], ")"}]}], "\[CapitalDelta]z"]}], ",", 
    "\[IndentingNewLine]", "and"}], TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{"\[PartialD]", 
       RowBox[{
        SubscriptBox["H", "y"], "(", 
        RowBox[{"z", ",", " ", "t"}], ")"}]}], 
      RowBox[{"\[PartialD]", "t"}]], "\[Rule]", 
     FractionBox[
      RowBox[{
       RowBox[{
        SubscriptBox["H", "y"], "(", 
        RowBox[{"z", ",", " ", 
         RowBox[{"t", "+", "\[CapitalDelta]t"}]}], ")"}], "-", 
       RowBox[{
        SubscriptBox["H", "y"], "(", 
        RowBox[{"z", ",", " ", "t"}], ")"}]}], "\[CapitalDelta]t"]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     FractionBox[
      RowBox[{"\[PartialD]", 
       RowBox[{
        SubscriptBox["H", "y"], "(", 
        RowBox[{"z", ",", " ", "t"}], ")"}]}], 
      RowBox[{"\[PartialD]", "z"}]], "\[Rule]", 
     RowBox[{
      FractionBox[
       RowBox[{
        RowBox[{
         SubscriptBox["H", "y"], "(", 
         RowBox[{
          RowBox[{"z", "+", 
           RowBox[{"\[CapitalDelta]z", "/", "2"}]}], ",", " ", "t"}], ")"}], 
        "-", 
        RowBox[{
         SubscriptBox["H", "y"], "(", 
         RowBox[{
          RowBox[{"z", "-", 
           RowBox[{"\[CapitalDelta]z", "/", "2"}]}], ",", " ", "t"}], ")"}]}],
        "\[CapitalDelta]z"], "."}]}]}], TraditionalForm]}]]
}], "Text",
 CellChangeTimes->{{3.485513263290947*^9, 3.485513275889731*^9}, {
  3.485514103956244*^9, 3.485514156170953*^9}, {3.485514348956089*^9, 
  3.485514351866229*^9}, {3.4855942302294827`*^9, 3.485594259407399*^9}, {
  3.485594430450821*^9, 3.485594452859239*^9}, {3.485595683459487*^9, 
  3.485595930865911*^9}, {3.485596414350334*^9, 3.485596480396558*^9}, {
  3.4855967919900618`*^9, 3.485596838440772*^9}, {3.48568539615375*^9, 
  3.485685438157159*^9}, {3.4862877300917873`*^9, 3.486287732507616*^9}, {
  3.490028014583075*^9, 3.490028052919393*^9}}],

Cell["\<\
This has the effect of solving for the electric field at 1/2 integer time \
steps, but integer spacial steps while solving for the magnetic field at \
integer time steps and 1/2 integer spacial steps. This means that each field \
component is surrounded by the components needed to calculate its curl. \
\>", "Text",
 CellChangeTimes->{{3.485596843467019*^9, 3.485596992124041*^9}, {
   3.485685360790277*^9, 3.485685368795109*^9}, {3.485685458288698*^9, 
   3.485685510393116*^9}, {3.485876386399042*^9, 3.485876392076256*^9}, {
   3.4858782368191032`*^9, 3.485878255258143*^9}, {3.485878339189643*^9, 
   3.485878370909651*^9}, {3.485878411993636*^9, 3.48587843242519*^9}, {
   3.48587864834028*^9, 3.485878661908264*^9}, 3.485878978727449*^9, 
   3.517325446369083*^9}],

Cell[BoxData[
 Graphics3DBox[{{{
     Arrow3DBox[
      NCache[{{0, 0, -1}, {0, 0, Rational[-2, 3]}}, {{0, 0, -1}, {
        0, 0, -0.6666666666666666}}]], 
     Arrow3DBox[
      NCache[{{0, 0, 1}, {0, 0, Rational[4, 3]}}, {{0, 0, 1}, {
        0, 0, 1.3333333333333333`}}]]}, {
     Arrow3DBox[
      NCache[{{-1, 0, 0}, {Rational[-2, 3], 0, 0}}, {{-1, 0, 
        0}, {-0.6666666666666666, 0, 0}}]], 
     Arrow3DBox[
      NCache[{{1, 0, 0}, {Rational[4, 3], 0, 0}}, {{1, 0, 0}, {
        1.3333333333333333`, 0, 0}}]]}, {
     Arrow3DBox[
      NCache[{{0, -1, 0}, {0, Rational[-2, 3], 0}}, {{0, -1, 0}, {
        0, -0.6666666666666666, 0}}]], 
     Arrow3DBox[
      NCache[{{0, 1, 0}, {0, Rational[4, 3], 0}}, {{0, 1, 0}, {
        0, 1.3333333333333333`, 0}}]]}}, {{Text3DBox[
      FormBox["\<\"\\!\\(\\*SubscriptBox[\\(H\\), \\(y\\)]\\)\"\>", 
       StandardForm], {0, -1, 0}], Text3DBox[
      FormBox["\<\"\\!\\(\\*SubscriptBox[\\(H\\), \\(y\\)]\\)\"\>", 
       StandardForm], {0, 1, 0}]}, {Text3DBox[
      FormBox["\<\"\\!\\(\\*SubscriptBox[\\(H\\), \\(z\\)]\\)\"\>", 
       StandardForm], {0, 0, -1}], Text3DBox[
      FormBox["\<\"\\!\\(\\*SubscriptBox[\\(H\\), \\(z\\)]\\)\"\>", 
       StandardForm], {0, 0, 1}]}, {Text3DBox[
      FormBox["\<\"\\!\\(\\*SubscriptBox[\\(H\\), \\(x\\)]\\)\"\>", 
       StandardForm], {-1, 0, 0}], Text3DBox[
      FormBox["\<\"\\!\\(\\*SubscriptBox[\\(H\\), \\(x\\)]\\)\"\>", 
       StandardForm], {1, 0, 0}]}}, 
   {RGBColor[
    1, 0, 0], {{
      Arrow3DBox[
       NCache[{{0, -1, -1}, {Rational[1, 3], -1, -1}}, {{0, -1, -1}, {
         0.3333333333333333, -1, -1}}]], 
      Arrow3DBox[
       NCache[{{0, -1, 1}, {Rational[1, 3], -1, 1}}, {{0, -1, 1}, {
         0.3333333333333333, -1, 1}}]]}, {
      Arrow3DBox[
       NCache[{{0, 1, -1}, {Rational[1, 3], 1, -1}}, {{0, 1, -1}, {
         0.3333333333333333, 1, -1}}]], 
      Arrow3DBox[
       NCache[{{0, 1, 1}, {Rational[1, 3], 1, 1}}, {{0, 1, 1}, {
         0.3333333333333333, 1, 1}}]]}}, {{
      Arrow3DBox[
       NCache[{{-1, 0, -1}, {-1, Rational[1, 2], -1}}, {{-1, 
         0, -1}, {-1, 0.5, -1}}]], 
      Arrow3DBox[
       NCache[{{-1, 0, 1}, {-1, Rational[1, 2], 1}}, {{-1, 0, 
         1}, {-1, 0.5, 1}}]]}, {
      Arrow3DBox[
       NCache[{{1, 0, -1}, {1, Rational[1, 2], -1}}, {{1, 0, -1}, {
         1, 0.5, -1}}]], 
      Arrow3DBox[
       NCache[{{1, 0, 1}, {1, Rational[1, 2], 1}}, {{1, 0, 1}, {
         1, 0.5, 1}}]]}}, {{
      Arrow3DBox[
       NCache[{{-1, -1, 0}, {-1, -1, Rational[1, 3]}}, {{-1, -1, 
         0}, {-1, -1, 0.3333333333333333}}]], 
      Arrow3DBox[
       NCache[{{-1, 1, 0}, {-1, 1, Rational[1, 3]}}, {{-1, 1, 
         0}, {-1, 1, 0.3333333333333333}}]]}, {
      Arrow3DBox[
       NCache[{{1, -1, 0}, {1, -1, Rational[1, 3]}}, {{1, -1, 0}, {
         1, -1, 0.3333333333333333}}]], 
      Arrow3DBox[
       NCache[{{1, 1, 0}, {1, 1, Rational[1, 3]}}, {{1, 1, 0}, {
         1, 1, 0.3333333333333333}}]]}}}, 
   {RGBColor[1, 0, 0], {{Text3DBox[
       FormBox["\<\"\\!\\(\\*SubscriptBox[\\(E\\), \\(x\\)]\\)\"\>", 
        StandardForm], {0, -1, -1}], Text3DBox[
       FormBox["\<\"\\!\\(\\*SubscriptBox[\\(E\\), \\(x\\)]\\)\"\>", 
        StandardForm], {0, -1, 1}]}, {Text3DBox[
       FormBox["\<\"\\!\\(\\*SubscriptBox[\\(E\\), \\(x\\)]\\)\"\>", 
        StandardForm], {0, 1, -1}], Text3DBox[
       FormBox["\<\"\\!\\(\\*SubscriptBox[\\(E\\), \\(x\\)]\\)\"\>", 
        StandardForm], {0, 1, 1}]}}, {{Text3DBox[
       FormBox["\<\"\\!\\(\\*SubscriptBox[\\(E\\), \\(y\\)]\\)\"\>", 
        StandardForm], {-1, 0, -1}], Text3DBox[
       FormBox["\<\"\\!\\(\\*SubscriptBox[\\(E\\), \\(y\\)]\\)\"\>", 
        StandardForm], {-1, 0, 1}]}, {Text3DBox[
       FormBox["\<\"\\!\\(\\*SubscriptBox[\\(E\\), \\(y\\)]\\)\"\>", 
        StandardForm], {1, 0, -1}], Text3DBox[
       FormBox["\<\"\\!\\(\\*SubscriptBox[\\(E\\), \\(y\\)]\\)\"\>", 
        StandardForm], {1, 0, 1}]}}, {{Text3DBox[
       FormBox["\<\"\\!\\(\\*SubscriptBox[\\(E\\), \\(z\\)]\\)\"\>", 
        StandardForm], {-1, -1, 0}], Text3DBox[
       FormBox["\<\"\\!\\(\\*SubscriptBox[\\(E\\), \\(z\\)]\\)\"\>", 
        StandardForm], {-1, 1, 0}]}, {Text3DBox[
       FormBox["\<\"\\!\\(\\*SubscriptBox[\\(E\\), \\(z\\)]\\)\"\>", 
        StandardForm], {1, -1, 0}], Text3DBox[
       FormBox["\<\"\\!\\(\\*SubscriptBox[\\(E\\), \\(z\\)]\\)\"\>", 
        StandardForm], {1, 1, 0}]}}}, 
   {Dashing[0.01], Line3DBox[{{-1, -1, 0}, {-1, 1, 0}}], 
    Line3DBox[{{1, -1, 0}, {1, 1, 0}}], 
    Line3DBox[{{-1, -1, -1}, {-1, 1, -1}}], 
    Line3DBox[{{-1, 1, 0}, {1, 1, 0}}], Line3DBox[{{1, -1, -1}, {1, 1, -1}}], 
    Line3DBox[{{-1, -1, 0}, {1, -1, 0}}], 
    Line3DBox[{{-1, -1, 1}, {-1, 1, 1}}], Line3DBox[{{1, -1, 1}, {1, 1, 1}}], 
    Line3DBox[{{1, 1, -1}, {1, 1, 1}}], Line3DBox[{{-1, 1, -1}, {-1, 1, 1}}], 
    Line3DBox[{{-1, -1, -1}, {1, -1, -1}}], 
    Line3DBox[{{-1, 1, 1}, {1, 1, 1}}], Line3DBox[{{-1, -1, 1}, {1, -1, 1}}], 
    Line3DBox[{{1, -1, -1}, {1, -1, 1}}], 
    Line3DBox[{{-1, -1, -1}, {-1, -1, 1}}], 
    Line3DBox[{{0, -1, -1}, {0, -1, 1}}], Line3DBox[{{0, 1, -1}, {0, 1, 1}}], 
    Line3DBox[{{-1, 0, -1}, {-1, 0, 1}}], Line3DBox[{{1, 0, -1}, {1, 0, 1}}]}},
  Axes->True,
  AxesLabel->{
    FormBox["\"x\"", TraditionalForm], 
    FormBox["\"y\"", TraditionalForm], 
    FormBox["\"z\"", TraditionalForm]}]], "Input",
 CellChangeTimes->{3.485767940811214*^9}],

Cell[TextData[StyleBox["Figure One: The Yee cube showing the spatial \
interlacing of the electric and magnetic fields. The fields are also \
interlaced in time. You can rotate the cube in order to get a better feel for \
the spatial interlacing.",
 FontSize->10]], "Text",
 CellChangeTimes->{{3.485767972017584*^9, 3.4857680472015963`*^9}, {
  3.485768218984508*^9, 3.4857682488096237`*^9}, {3.485880097705778*^9, 
  3.485880122122019*^9}, {3.485880154899665*^9, 3.485880155267124*^9}, {
  3.517325612632332*^9, 3.5173256175999117`*^9}},
 TextAlignment->Left,
 TextJustification->1],

Cell[TextData[{
 "If we focus on one plane of the Yee cube say the ",
 Cell[BoxData[
  FormBox[
   RowBox[{"z", "=", 
    RowBox[{"-", "1"}]}], TraditionalForm]]],
 " plane you can see that the field ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["H", "z"], TraditionalForm]]],
 " is surrounded by the fields needed to compute  ",
 Cell[BoxData[
  FormBox["z", TraditionalForm]]],
 " component of the curl of ",
 Cell[BoxData[
  FormBox[
   StyleBox["E",
    FontWeight->"Bold"], TraditionalForm]]],
 ", which is what we need to step ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["H", "z"], TraditionalForm]]],
 " forward in time.\n\n An important feature of the Yee algorithm is that it \
automatically satisfies the divergence equations. To see this recall that \n ",
 Cell[BoxData[
  FormBox[GridBox[{
     {
      RowBox[{
       RowBox[{"\[Del]", 
        RowBox[{"\[CenterDot]", 
         StyleBox["F",
          FontWeight->"Bold"]}]}], "=", 
       RowBox[{
        UnderscriptBox["lim", 
         RowBox[{"\[CapitalDelta]V", "\[Rule]", "0"}]], 
        RowBox[{
         FractionBox["1", "\[CapitalDelta]V"], 
         RowBox[{"\[Integral]", 
          RowBox[{
           SubscriptBox["\[Integral]", 
            RowBox[{" ", "S"}]], 
           RowBox[{
            RowBox[{
             StyleBox["F",
              FontWeight->"Bold"], "\[CenterDot]", 
             OverscriptBox[
              StyleBox["n",
               FontWeight->"Bold"], "^"]}], 
            RowBox[{"\[DifferentialD]", "S"}]}]}]}]}]}]}]}
    },
    GridBoxItemSize->{"Columns" -> {{
         Scaled[0.96]}}}], TraditionalForm]]],
 "\nwhere ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    OverscriptBox[
     StyleBox["n",
      FontWeight->"Bold"], "^"], " "}], TraditionalForm]]],
 "is the outward pointing normal to the surface ",
 Cell[BoxData[
  FormBox["S", TraditionalForm]]],
 " and ",
 Cell[BoxData[
  FormBox["S", TraditionalForm]]],
 " bounds the volume ",
 Cell[BoxData[
  FormBox["\[CapitalDelta]V", TraditionalForm]]],
 ".  Now ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Integral]", 
    RowBox[{
     SubscriptBox["\[Integral]", 
      RowBox[{" ", "S"}]], 
     RowBox[{
      RowBox[{
       StyleBox["F",
        FontWeight->"Bold"], "\[CenterDot]", 
       OverscriptBox[
        StyleBox["n",
         FontWeight->"Bold"], "^"]}], 
      RowBox[{"\[DifferentialD]", "S"}]}]}]}], TraditionalForm]]],
 " is the flux through ",
 Cell[BoxData[
  FormBox["S", TraditionalForm]]],
 ". If we can show this is constant, then the divergence equation will be \
satisfied since at ",
 Cell[BoxData[
  FormBox[
   RowBox[{"t", "=", "0"}], TraditionalForm]]],
 " the flux must be zero or we have not picked a good initial field \
configuration. For simplicity let\[CloseCurlyQuote]s restrict ourselves to \
two dimensions. The argument is similar but more tedious in three \
dimensions[6]. \n\nIf the fields do not depend on ",
 Cell[BoxData[
  FormBox["z", TraditionalForm]]],
 ", Maxwell\[CloseCurlyQuote]s equations become"
}], "Text",
 CellChangeTimes->{{3.48587898936723*^9, 3.48587903416024*^9}, {
   3.485879756614765*^9, 3.4858798773867407`*^9}, {3.485879923485991*^9, 
   3.485879944930854*^9}, {3.486141182715407*^9, 3.486141183243073*^9}, {
   3.486287734478065*^9, 3.486287738909136*^9}, 3.514739674082624*^9, 
   3.514741002086133*^9, {3.5173254793424187`*^9, 3.517325502719734*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{"\t\t\t\t\t", GridBox[{
     {
      RowBox[{"\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         FractionBox[
          RowBox[{"\[PartialD]", 
           SubscriptBox["H", "z"]}], 
          RowBox[{"\[PartialD]", " ", "t"}]], "=", 
         RowBox[{
          RowBox[{"-", 
           FractionBox["1", "\[Mu]"]}], " ", 
          RowBox[{"(", " ", 
           RowBox[{
            FractionBox[
             RowBox[{"\[PartialD]", 
              SubscriptBox["E", "y"]}], 
             RowBox[{"\[PartialD]", " ", "x"}]], "-", 
            FractionBox[
             RowBox[{"\[PartialD]", 
              SubscriptBox["E", "x"]}], 
             RowBox[{"\[PartialD]", "y"}]]}], ")"}]}]}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         FractionBox[
          RowBox[{"\[PartialD]", 
           SubscriptBox["H", "x"]}], 
          RowBox[{"\[PartialD]", "t"}]], "=", 
         RowBox[{
          RowBox[{"-", 
           FractionBox["1", "\[Mu]"]}], 
          FractionBox[
           RowBox[{"\[PartialD]", 
            SubscriptBox["E", "z"]}], 
           RowBox[{"\[PartialD]", "y"}]]}]}], "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{
         FractionBox[
          RowBox[{"\[PartialD]", 
           SubscriptBox["H", "y"]}], 
          RowBox[{"\[PartialD]", "t"}]], "=", 
         RowBox[{
          FractionBox["1", "\[Mu]"], 
          FractionBox[
           RowBox[{"\[PartialD]", 
            SubscriptBox["E", "z"]}], 
           RowBox[{"\[PartialD]", "x"}]]}]}], "\[IndentingNewLine]", 
        RowBox[{
         FractionBox[
          RowBox[{"\[PartialD]", 
           SubscriptBox["E", "z"]}], 
          RowBox[{"\[PartialD]", "t"}]], "=", 
         RowBox[{
          FractionBox["1", "\[Epsilon]"], 
          RowBox[{"(", " ", 
           RowBox[{
            FractionBox[
             RowBox[{"\[PartialD]", 
              SubscriptBox["\[CapitalEta]", "y"]}], 
             RowBox[{"\[PartialD]", "x"}]], "-", 
            FractionBox[
             RowBox[{"\[PartialD]", 
              SubscriptBox["H", "x"]}], 
             RowBox[{"\[PartialD]", "y"}]]}], ")"}]}]}], 
        "\[IndentingNewLine]", 
        RowBox[{
         FractionBox[
          RowBox[{"\[PartialD]", 
           SubscriptBox["E", "x"]}], 
          RowBox[{"\[PartialD]", "t"}]], "=", 
         RowBox[{
          FractionBox["1", "\[Epsilon]"], 
          FractionBox[
           RowBox[{"\[PartialD]", 
            SubscriptBox["H", "z"]}], 
           RowBox[{"\[PartialD]", "y"}]]}]}], "\[IndentingNewLine]", 
        RowBox[{
         FractionBox[
          RowBox[{"\[PartialD]", 
           SubscriptBox["E", "y"]}], 
          RowBox[{"\[PartialD]", "t"}]], "=", 
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            RowBox[{" ", "1"}], "\[Epsilon]"]}], 
          FractionBox[
           RowBox[{"\[PartialD]", 
            SubscriptBox["H", "z"]}], 
           RowBox[{"\[PartialD]", "x"}]]}]}], "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"\[Del]", 
          RowBox[{"\[CenterDot]", "E"}]}], "=", "0"}], "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"\[Del]", 
          RowBox[{"\[CenterDot]", "B"}]}], "=", "0"}]}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{"Center"}}}]}], 
  TraditionalForm]], "Input",
 CellChangeTimes->{{3.4832006198353033`*^9, 3.48320062216774*^9}, {
   3.4832007943534727`*^9, 3.483200794797555*^9}, {3.483201701594552*^9, 
   3.483201705730548*^9}, {3.485512382347275*^9, 3.485512606410881*^9}, {
   3.485878664732164*^9, 3.485878685093293*^9}, {3.4858787251267977`*^9, 
   3.485878757240057*^9}, 3.48587900675313*^9, {3.485879484958219*^9, 
   3.485879585327115*^9}, {3.4861128281645937`*^9, 3.4861128565971193`*^9}, {
   3.486112887999008*^9, 3.4861130948229723`*^9}, {3.486113131931333*^9, 
   3.486113167233302*^9}, {3.486113457242914*^9, 3.486113503238923*^9}, 
   3.486113535616929*^9, {3.486114717885149*^9, 3.486114733332986*^9}, {
   3.486114936334333*^9, 3.486114947077001*^9}, {3.486115077385652*^9, 
   3.48611508173521*^9}, {3.4861151177043858`*^9, 3.486115186351157*^9}},
 TextAlignment->Left,
 TextJustification->0.],

Cell[TextData[{
 "This tells us that we can separate the equations into two modes, a TM  mode \
with ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["E", "x"], "=", 
    RowBox[{
     SubscriptBox["E", "y"], "=", 
     RowBox[{
      SubscriptBox["H", "z"], "=", "0"}]}]}], TraditionalForm]]],
 " and a TE mode with ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["H", "x"], "=", 
    RowBox[{
     SubscriptBox["H", "y"], "=", 
     RowBox[{
      SubscriptBox["E", "z"], "=", "0"}]}]}], TraditionalForm]]],
 ". For the TM mode we have "
}], "Text",
 CellChangeTimes->{{3.485879604261572*^9, 3.485879715570738*^9}, {
   3.486115214389442*^9, 3.486115221754527*^9}, 3.486115394428234*^9, {
   3.486287743298614*^9, 3.4862877471383457`*^9}, 3.4862878797907753`*^9, {
   3.486486656651844*^9, 3.486486657721045*^9}, {3.517325560557583*^9, 
   3.517325566469511*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{"\t\t\t\t\t", 
   RowBox[{GridBox[{
      {
       RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         StyleBox[
          RowBox[{
           RowBox[{
            SubscriptBox["E", "x"], "=", 
            RowBox[{
             SubscriptBox["E", "y"], "=", "0"}]}], ",", 
           RowBox[{
            SubscriptBox["H", "z"], "=", "0"}]}],
          FontWeight->"Plain"], "\[IndentingNewLine]", 
         RowBox[{
          FractionBox[
           RowBox[{"\[PartialD]", 
            SubscriptBox["H", "x"]}], 
           RowBox[{"\[PartialD]", "t"}]], "=", 
          RowBox[{
           RowBox[{"-", 
            FractionBox["1", "\[Mu]"]}], 
           FractionBox[
            RowBox[{"\[PartialD]", 
             SubscriptBox["E", "z"]}], 
            RowBox[{"\[PartialD]", "y"}]]}]}], "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{
          FractionBox[
           RowBox[{"\[PartialD]", 
            SubscriptBox["H", "y"]}], 
           RowBox[{"\[PartialD]", "t"}]], "=", 
          RowBox[{
           FractionBox["1", "\[Mu]"], 
           FractionBox[
            RowBox[{"\[PartialD]", 
             SubscriptBox["E", "z"]}], 
            RowBox[{"\[PartialD]", "x"}]]}]}], "\[IndentingNewLine]", 
         RowBox[{
          FractionBox[
           RowBox[{"\[PartialD]", 
            SubscriptBox["E", "z"]}], 
           RowBox[{"\[PartialD]", "t"}]], "=", 
          RowBox[{
           FractionBox["1", "\[Epsilon]"], 
           RowBox[{"(", " ", 
            RowBox[{
             FractionBox[
              RowBox[{"\[PartialD]", 
               SubscriptBox["\[CapitalEta]", "y"]}], 
              RowBox[{"\[PartialD]", "x"}]], "-", 
             FractionBox[
              RowBox[{"\[PartialD]", 
               SubscriptBox["H", "x"]}], 
              RowBox[{"\[PartialD]", "y"}]]}], ")"}]}]}], 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"\[Del]", 
           RowBox[{"\[CenterDot]", "E"}]}], "=", "0"}], "\[IndentingNewLine]",
          "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"\[Del]", 
           RowBox[{"\[CenterDot]", "B"}]}], "=", "0"}]}]}]}
     },
     GridBoxAlignment->{"Columns" -> {{"Center"}}}], "       ", "TM", " ", 
    "Mode"}]}], TraditionalForm]], "Input",
 CellChangeTimes->{{3.4832006198353033`*^9, 3.48320062216774*^9}, {
   3.4832007943534727`*^9, 3.483200794797555*^9}, {3.483201701594552*^9, 
   3.483201705730548*^9}, {3.485512382347275*^9, 3.485512606410881*^9}, {
   3.485878664732164*^9, 3.485878685093293*^9}, {3.4858787251267977`*^9, 
   3.485878757240057*^9}, 3.48587900675313*^9, {3.485879484958219*^9, 
   3.485879585327115*^9}, {3.4861128281645937`*^9, 3.4861128565971193`*^9}, {
   3.486112887999008*^9, 3.4861130948229723`*^9}, {3.486113131931333*^9, 
   3.486113167233302*^9}, {3.486113457242914*^9, 3.486113503238923*^9}, 
   3.486113535616929*^9, {3.486114717885149*^9, 3.486114733332986*^9}, {
   3.486114936334333*^9, 3.486114947077001*^9}, {3.486115077385652*^9, 
   3.48611508173521*^9}, {3.4861151177043858`*^9, 3.486115186351157*^9}, {
   3.486115408750252*^9, 3.4861154684145737`*^9}, {3.4861155098103523`*^9, 
   3.4861155328706913`*^9}, {3.502705824277815*^9, 3.502705824557399*^9}, {
   3.517325549873734*^9, 3.517325550256646*^9}},
 TextAlignment->Left,
 TextJustification->0.],

Cell["and for the TE mode we have", "Text",
 CellChangeTimes->{{3.486115558364965*^9, 3.486115568616765*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{"\t\t\t\t\t", 
   RowBox[{GridBox[{
      {
       RowBox[{"\[IndentingNewLine]", 
        RowBox[{
         StyleBox[
          RowBox[{
           RowBox[{
            SubscriptBox["H", "x"], "=", 
            RowBox[{
             SubscriptBox["H", "y"], "=", "0"}]}], ",", 
           RowBox[{
            SubscriptBox["E", "z"], "=", "0"}]}],
          FontWeight->"Plain"], "\[IndentingNewLine]", 
         RowBox[{
          FractionBox[
           RowBox[{"\[PartialD]", 
            SubscriptBox["H", "z"]}], 
           RowBox[{"\[PartialD]", " ", "t"}]], "=", 
          RowBox[{
           RowBox[{"-", 
            FractionBox["1", "\[Mu]"]}], " ", 
           RowBox[{"(", " ", 
            RowBox[{
             FractionBox[
              RowBox[{"\[PartialD]", 
               SubscriptBox["E", "y"]}], 
              RowBox[{"\[PartialD]", " ", "x"}]], "-", 
             FractionBox[
              RowBox[{"\[PartialD]", 
               SubscriptBox["E", "x"]}], 
              RowBox[{"\[PartialD]", "y"}]]}], ")"}]}]}], 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          FractionBox[
           RowBox[{"\[PartialD]", 
            SubscriptBox["E", "x"]}], 
           RowBox[{"\[PartialD]", "t"}]], "=", 
          RowBox[{
           FractionBox["1", "\[Epsilon]"], 
           FractionBox[
            RowBox[{"\[PartialD]", 
             SubscriptBox["H", "z"]}], 
            RowBox[{"\[PartialD]", "y"}]]}]}], "\[IndentingNewLine]", 
         RowBox[{
          FractionBox[
           RowBox[{"\[PartialD]", 
            SubscriptBox["E", "y"]}], 
           RowBox[{"\[PartialD]", "t"}]], "=", 
          RowBox[{
           RowBox[{"-", 
            FractionBox[
             RowBox[{" ", "1"}], "\[Epsilon]"]}], 
           FractionBox[
            RowBox[{"\[PartialD]", 
             SubscriptBox["H", "z"]}], 
            RowBox[{"\[PartialD]", "x"}]]}]}], "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"\[Del]", 
           RowBox[{"\[CenterDot]", "E"}]}], "=", "0"}], "\[IndentingNewLine]",
          "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"\[Del]", 
           RowBox[{"\[CenterDot]", "B"}]}], "=", "0"}]}]}]}
     },
     GridBoxAlignment->{"Columns" -> {{"Center"}}}], "TE", " ", "Mode"}]}], 
  TraditionalForm]], "Input",
 CellChangeTimes->{{3.4832006198353033`*^9, 3.48320062216774*^9}, {
   3.4832007943534727`*^9, 3.483200794797555*^9}, {3.483201701594552*^9, 
   3.483201705730548*^9}, {3.485512382347275*^9, 3.485512606410881*^9}, {
   3.485878664732164*^9, 3.485878685093293*^9}, {3.4858787251267977`*^9, 
   3.485878757240057*^9}, 3.48587900675313*^9, {3.485879484958219*^9, 
   3.485879585327115*^9}, {3.4861128281645937`*^9, 3.4861128565971193`*^9}, {
   3.486112887999008*^9, 3.4861130948229723`*^9}, {3.486113131931333*^9, 
   3.486113167233302*^9}, {3.486113457242914*^9, 3.486113503238923*^9}, 
   3.486113535616929*^9, {3.486114717885149*^9, 3.486114733332986*^9}, {
   3.486114936334333*^9, 3.486114947077001*^9}, {3.486115077385652*^9, 
   3.48611508173521*^9}, {3.4861151177043858`*^9, 3.486115186351157*^9}, {
   3.4861155730587473`*^9, 3.486115651880002*^9}, {3.486115711273682*^9, 
   3.486115712512904*^9}},
 TextAlignment->Left,
 TextJustification->0.],

Cell[TextData[{
 " Consider a rectangular loop around say ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["E", "z"], TraditionalForm]]],
 " oriented so that ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["E", "z"], TraditionalForm]]],
 " points out of the page. This is the TM mode.  From Figure One we see that \
the flux through the loop is\n \n",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[CapitalPhi]", "=", 
    RowBox[{
     RowBox[{"\[Mu]\[CapitalDelta]y", "(", 
      RowBox[{
       RowBox[{
        SubscriptBox["H", "x"], "(", 
        RowBox[{
         RowBox[{"i", "+", "1"}], ",", 
         RowBox[{"j", "+", 
          RowBox[{"1", "/", "2"}]}]}], ")"}], "-", 
       RowBox[{
        SubscriptBox["H", "x"], "(", 
        RowBox[{"i", ",", 
         RowBox[{"j", "+", 
          RowBox[{"1", "/", "2"}]}]}], ")"}]}], ")"}], "+", 
     RowBox[{
      RowBox[{"\[Mu]\[CapitalDelta]x", "(", 
       RowBox[{
        RowBox[{
         SubscriptBox["H", "y"], "(", 
         RowBox[{
          RowBox[{"i", "+", 
           RowBox[{"1", "/", "2"}]}], ",", 
          RowBox[{"j", "+", "1"}]}], ")"}], "-", 
        RowBox[{
         SubscriptBox["H", "y"], "(", 
         RowBox[{
          RowBox[{"i", "+", 
           RowBox[{"1", "/", "2"}]}], ",", "j"}], ")"}]}], ")"}], "."}]}]}], 
   TraditionalForm]]],
 "\n\n Thus ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox[
     RowBox[{"\[PartialD]", "\[CapitalPhi]"}], 
     RowBox[{"\[PartialD]", "t"}]], "=", 
    RowBox[{
     RowBox[{"\[Mu]\[CapitalDelta]y", "(", " ", 
      RowBox[{
       FractionBox[
        RowBox[{"\[PartialD]", 
         RowBox[{
          SubscriptBox["H", "x"], "(", 
          RowBox[{
           RowBox[{"i", "+", "1"}], ",", 
           RowBox[{"j", "+", 
            RowBox[{"1", "/", "2"}]}]}], ")"}]}], 
        RowBox[{"\[PartialD]", "t"}]], "-", 
       FractionBox[
        RowBox[{"\[PartialD]", 
         RowBox[{
          SubscriptBox["H", "x"], "(", 
          RowBox[{"i", ",", 
           RowBox[{"j", "+", 
            RowBox[{"1", "/", "2"}]}]}], ")"}]}], 
        RowBox[{"\[PartialD]", "t"}]]}], ")"}], "+", 
     RowBox[{"\[Mu]\[CapitalDelta]x", "(", " ", 
      RowBox[{
       FractionBox[
        RowBox[{"\[PartialD]", 
         RowBox[{
          SubscriptBox["H", "y"], "(", 
          RowBox[{
           RowBox[{"i", "+", 
            RowBox[{"1", "/", "2"}]}], ",", 
           RowBox[{"j", "+", "1"}]}], ")"}]}], 
        RowBox[{"\[PartialD]", "t"}]], "-", 
       FractionBox[
        RowBox[{"\[PartialD]", 
         RowBox[{
          SubscriptBox["H", "y"], "(", 
          RowBox[{
           RowBox[{"i", "+", 
            RowBox[{"1", "/", "2"}]}], ",", "j"}], ")"}]}], 
        RowBox[{"\[PartialD]", "t"}]]}], ")"}]}]}], TraditionalForm]]],
 ". \nNow ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox[
     RowBox[{"\[PartialD]", " ", 
      SubscriptBox["H", "x"]}], 
     RowBox[{"\[PartialD]", "t"}]], "=", 
    RowBox[{
     RowBox[{
      FractionBox[
       RowBox[{"-", "1"}], "\[Mu]"], 
      FractionBox[
       RowBox[{"\[PartialD]", 
        SubscriptBox["E", "z"]}], 
       RowBox[{"\[PartialD]", "y"}]], "and", " ", 
      FractionBox[
       RowBox[{"\[PartialD]", 
        SubscriptBox["H", "y"]}], 
       RowBox[{"\[PartialD]", "t"}]]}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        FractionBox["1", "\[Mu]"], 
        FractionBox[
         RowBox[{"\[PartialD]", 
          SubscriptBox["E", "z"]}], 
         RowBox[{"\[PartialD]", "x"}]]}], "\[Implies]", 
       FractionBox[
        RowBox[{"\[PartialD]", "\[CapitalPhi]"}], 
        RowBox[{"\[PartialD]", "t"}]]}], "=", 
      RowBox[{"-", 
       RowBox[{"\[CapitalDelta]y", "("}]}]}]}]}], TraditionalForm]]],
 Cell[BoxData[
  FormBox[
   FractionBox[
    RowBox[{
     RowBox[{
      SubsuperscriptBox["E", "z", "n"], "(", 
      RowBox[{
       RowBox[{"i", "+", "1"}], ",", 
       RowBox[{"j", "+", "1"}]}], ")"}], " ", "-", " ", 
     RowBox[{
      SubsuperscriptBox["E", "z", "n"], "(", 
      RowBox[{
       RowBox[{"i", "+", "1"}], ",", "j"}], ")"}]}], "\[CapitalDelta]y"], 
   TraditionalForm]]],
 "-",
 Cell[BoxData[
  FormBox[
   FractionBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubsuperscriptBox["E", "z", "n"], "(", 
       RowBox[{"i", ",", 
        RowBox[{"j", "+", "1"}]}], ")"}], " ", "-", " ", 
      RowBox[{
       SubsuperscriptBox["E", "z", "n"], "(", 
       RowBox[{"i", ",", "j"}], ")"}]}], ")"}], "\[CapitalDelta]y"], 
   TraditionalForm]]],
 ")+\[CapitalDelta]x(",
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SubsuperscriptBox["E", "z", "n"], "(", 
        RowBox[{"i", "+", 
         RowBox[{"1", "j"}], "+", "1"}], ")"}], " ", "-", " ", 
       RowBox[{
        SubsuperscriptBox["E", "z", "n"], "(", 
        RowBox[{"i", ",", 
         RowBox[{"j", "+", "1"}]}], ")"}]}], ")"}], "\[CapitalDelta]x"], "-", 
    
    FractionBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SubsuperscriptBox["E", "z", "n"], "(", 
        RowBox[{
         RowBox[{"i", "+", "1"}], ",", "j"}], ")"}], " ", "-", " ", 
       RowBox[{
        SubsuperscriptBox["E", "z", "n"], "(", 
        RowBox[{"i", ",", "j"}], ")"}]}], ")"}], "\[CapitalDelta]x"]}], 
   TraditionalForm]]],
 ")=0."
}], "Text",
 CellChangeTimes->{
  3.485879890747491*^9, {3.485879972276906*^9, 3.48587999694104*^9}, {
   3.4858800358782883`*^9, 3.4858800393585243`*^9}, {3.4858801383385057`*^9, 
   3.4858801809873238`*^9}, {3.485880434735359*^9, 3.485880438804749*^9}, {
   3.485880486562405*^9, 3.4858806492782297`*^9}, {3.485880687419524*^9, 
   3.485880692062598*^9}, {3.4858811830447893`*^9, 3.485881403340023*^9}, {
   3.486116394103324*^9, 3.486116428167487*^9}, {3.486116503767284*^9, 
   3.486116535776762*^9}, {3.4861169158494263`*^9, 3.486116933190099*^9}, {
   3.48613461756594*^9, 3.486134742386491*^9}, {3.4861350286646347`*^9, 
   3.486135028664658*^9}, {3.486135188867444*^9, 3.4861352225024643`*^9}, {
   3.486135271150341*^9, 3.486135460960875*^9}, {3.486135859755115*^9, 
   3.48613592995061*^9}, {3.486136040960998*^9, 3.486136094116272*^9}, {
   3.48613623429112*^9, 3.486136315002378*^9}, {3.4861365253239813`*^9, 
   3.4861365280898027`*^9}, {3.486136617529209*^9, 3.486136675881884*^9}, {
   3.486140296350573*^9, 3.4861403051579533`*^9}, {3.486140342247571*^9, 
   3.486140347213501*^9}, {3.486140438648067*^9, 3.486140486915743*^9}, {
   3.486140527571176*^9, 3.4861405292421827`*^9}, 3.4862877622231617`*^9, {
   3.5173255829995413`*^9, 3.517325587199391*^9}, {3.517325629893195*^9, 
   3.5173256309761953`*^9}}],

Cell[TextData[{
 "Thus, if the fields are divergent-less at ",
 Cell[BoxData[
  FormBox[
   RowBox[{"t", "=", "0"}], TraditionalForm]]],
 " they will remain so at later times. This means that we need only solve the \
curl equations. Not all finite difference schemes are divergence free. A \
discussion of non-standard schemes is given by Yang and Balanis [6]."
}], "Text",
 CellChangeTimes->{{3.4861413947718477`*^9, 3.486141557091674*^9}, {
   3.4862877750995398`*^9, 3.4862877844759912`*^9}, 3.514739665825654*^9}],

Cell[CellGroupData[{

Cell["One-dimensional propagation", "Section",
 CellChangeTimes->{{3.486141754184795*^9, 3.486141769193665*^9}, {
  3.51732564627427*^9, 3.517325646601591*^9}}],

Cell[TextData[{
 "Before looking at either the TE or TM modes lets look at a still simpler \
case, one-dimensional propagation in say the ",
 Cell[BoxData[
  FormBox["z", TraditionalForm]]],
 " direction. The equations then become (where we have chosen to polarize the \
electric field in the z direction)."
}], "Text",
 CellChangeTimes->{{3.485878878350512*^9, 3.485878902739668*^9}, 
   3.486116332038621*^9, 3.486287789420188*^9, {3.4863097241073713`*^9, 
   3.4863097783632917`*^9}, {3.5173256575140047`*^9, 3.517325674226042*^9}}],

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{"\t\t\t\t\t", GridBox[{
     {
      RowBox[{"\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         FractionBox[
          RowBox[{"\[PartialD]", 
           SubscriptBox["H", "y"]}], 
          RowBox[{"\[PartialD]", " ", "t"}]], "=", 
         RowBox[{
          FractionBox[
           RowBox[{"-", "1"}], "\[Mu]"], "  ", 
          FractionBox[
           RowBox[{"\[PartialD]", 
            SubscriptBox["E", "x"]}], 
           RowBox[{"\[PartialD]", " ", "z"}]]}]}], "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{
         FractionBox[
          RowBox[{"\[PartialD]", 
           SubscriptBox["E", "x"]}], 
          RowBox[{"\[PartialD]", "t"}]], "=", 
         RowBox[{
          FractionBox[
           RowBox[{"-", "1"}], "\[Epsilon]"], " ", 
          FractionBox[
           RowBox[{"\[PartialD]", 
            SubscriptBox["\[CapitalEta]", "y"]}], 
           RowBox[{"\[PartialD]", "z"}]]}]}], "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"\[Del]", 
          RowBox[{"\[CenterDot]", 
           StyleBox["E",
            FontWeight->"Bold"]}]}], "=", "0"}], "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"\[Del]", 
          RowBox[{"\[CenterDot]", "B"}]}], "=", "0"}]}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{"Center"}}}]}], 
  TraditionalForm]], "Input",
 CellChangeTimes->{{3.4832006198353033`*^9, 3.48320062216774*^9}, {
  3.4832007943534727`*^9, 3.483200794797555*^9}, {3.483201701594552*^9, 
  3.483201705730548*^9}, {3.485512382347275*^9, 3.485512606410881*^9}},
 TextAlignment->Left,
 TextJustification->0.]], "Text",
 CellChangeTimes->{
  3.485878949239925*^9, {3.486114747893718*^9, 3.486114751173077*^9}, {
   3.486290079283839*^9, 3.486290079283923*^9}}],

Cell[TextData[{
 "This is not a special case of either the TE or TM modes since for those \
modes we assumed that the fields did not depend on ",
 Cell[BoxData[
  FormBox["z", TraditionalForm]]],
 " whereas here we assume that the fields only depend on ",
 Cell[BoxData[
  FormBox["z", TraditionalForm]]],
 ". Suppose we have a wave that propagates in free space for ",
 Cell[BoxData[
  FormBox[
   RowBox[{"z", "<", "0"}], TraditionalForm]]],
 " and then hits a medium with ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Epsilon]", "\[NotEqual]", "1"}], TraditionalForm]]],
 ". We can make such a function using ",
 ButtonBox["Piecewise",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://reference.wolfram.com/mathematica/ref/Piecewise.html"], None},
  
  ButtonNote->"http://reference.wolfram.com/mathematica/ref/Piecewise.html"],
 "."
}], "Text",
 CellChangeTimes->{{3.486141597866317*^9, 3.4861416721419764`*^9}, {
  3.486199430958798*^9, 3.486199452068475*^9}, {3.486199545642804*^9, 
  3.4861995456440277`*^9}, {3.486200914963374*^9, 3.486200914963401*^9}, {
  3.486309798420397*^9, 3.486309908544588*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"edge", "[", "\[Epsilon]_", "]"}], "=", 
  RowBox[{"Piecewise", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", 
       RowBox[{"z", "<=", "0"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Epsilon]", ",", 
       RowBox[{"z", ">", "0"}]}], "}"}]}], "}"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.485514522442483*^9, 3.485514596549328*^9}, 
   3.486200856020956*^9, {3.486200902774494*^9, 3.48620090553293*^9}}],

Cell[TextData[{
 "The change in \[Epsilon] is shown below. You can think of this simple \
example as going from air (\[Epsilon]=1) to glass (\[Epsilon]=1.5). Both \
materials have ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Mu]", "=", "1"}], TraditionalForm]]],
 "."
}], "Text",
 CellChangeTimes->{{3.4862045431248426`*^9, 3.4862045436675377`*^9}, {
   3.48620458437465*^9, 3.486204694642085*^9}, 3.51732569793954*^9}],

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"edge", "[", "1.5", "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"z", ",", 
     RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
   RowBox[{"Exclusions", "\[Rule]", "None"}], ",", 
   RowBox[{"PlotStyle", "\[Rule]", "Thick"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.4855146013313503`*^9, 3.485514625750429*^9}, 
   3.486200926302932*^9, {3.486204570030545*^9, 3.48620457675062*^9}}],

Cell[TextData[{
 "The equations are particularly simple for this case since we only need to \
take the spatial derivative of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["E", "x"], TraditionalForm]]],
 " to update ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["H", "z"], TraditionalForm]]],
 " and vice-versa.  We are solving the equations on a grid which I will take \
to run from ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"-", "8"}], "\[LessEqual]", "z", "\[LessEqual]", " ", "8"}], 
   TraditionalForm]]],
 ". The spacing between the grid points is determined by the variable called \
\[OpenCurlyDoubleQuote]step\[CloseCurlyDoubleQuote]. To solve the equations \
we must sample ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Epsilon]", "(", "z", ")"}], TraditionalForm]]],
 " and the initial ",
 Cell[BoxData[
  FormBox["E", TraditionalForm]]],
 " and ",
 Cell[BoxData[
  FormBox["H", TraditionalForm]]],
 " fields on the grid. The grid spacing needs to be smaller than the \
wavelength and the rule of thumb is to take the grid spacing to be between ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[Lambda]", "/", "10"}], " ", "and", " ", 
    RowBox[{"\[Lambda]", "/", "40"}]}], TraditionalForm]]],
 ".  We will take the initial electric field configuration to a Gaussian \
pulse with no initial magnetic field. The Gaussian is peak at ",
 Cell[BoxData[
  FormBox[
   RowBox[{"z", "=", 
    RowBox[{"-", "2"}]}], TraditionalForm]]],
 " so that the wave starts in free space. The initial electric field sampled \
on the grid is plotted below. I have used a grid spacing of 0.05. Since the \
minimum wavelength is about two, this gives me about 40 grid points for one \
wavelength."
}], "Text",
 CellChangeTimes->{{3.486204709321828*^9, 3.486205039686432*^9}, {
   3.486205266184333*^9, 3.486205320633013*^9}, {3.4862214588848267`*^9, 
   3.4862216136728277`*^9}, {3.486221958917499*^9, 3.486221978228387*^9}, {
   3.486222314556954*^9, 3.486222337898695*^9}, {3.486285538557378*^9, 
   3.486285680321128*^9}, {3.486286717866036*^9, 3.4862867599408073`*^9}, {
   3.486286795335019*^9, 3.4862868315092287`*^9}, 3.486287789583085*^9, 
   3.4862879112873583`*^9, {3.4864867158524733`*^9, 3.486486721051099*^9}, {
   3.486487319383696*^9, 3.4864873196775618`*^9}, {3.489918174545394*^9, 
   3.4899182272428017`*^9}, 3.514819430065477*^9, {3.5173257309747057`*^9, 
   3.5173257631093388`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"step", "=", "0.05"}], ";"}]], "Input",
 CellChangeTimes->{{3.4861996365784197`*^9, 3.486199636580172*^9}, {
  3.4861996680291643`*^9, 3.486199717165619*^9}, {3.486199755967423*^9, 
  3.486199801518949*^9}, {3.486199837075695*^9, 3.486199880363924*^9}, {
  3.486199944075514*^9, 3.486199945598172*^9}, {3.486200490513076*^9, 
  3.486200530591237*^9}, {3.486200722589739*^9, 3.486200777853425*^9}, {
  3.486200931340748*^9, 3.486200977484435*^9}, {3.486221695205914*^9, 
  3.486221724189661*^9}, {3.486221770055135*^9, 3.486221770573153*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Ei", "[", "z_", "]"}], "=", " ", 
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{"-", "2"}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"z", "+", "2"}], ")"}], "2"]}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"Hi", "[", "x_", "]"}], "=", "   ", "0"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"EData", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Ei", "[", "z", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"z", ",", 
         RowBox[{"-", "8"}], ",", "8", ",", "step"}], "}"}]}], "]"}]}], ";"}],
    "\n", 
   RowBox[{
    RowBox[{"grid", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"z", ",", 
       RowBox[{"{", 
        RowBox[{"z", ",", 
         RowBox[{"-", "8"}], ",", "8", ",", "step"}], "}"}]}], "]"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"HData", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Hi", "[", "z", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"z", ",", 
         RowBox[{"-", "8"}], ",", "8", ",", "step"}], "}"}]}], "]"}]}], ";"}],
    "\n", 
   RowBox[{"ListPlot", "[", 
    RowBox[{
     RowBox[{"Transpose", "[", 
      RowBox[{"{", 
       RowBox[{"grid", ",", "EData"}], "}"}], "]"}], ",", 
     RowBox[{"Joined", "\[Rule]", "True"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
     RowBox[{"AxesLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "\"\<z\>\"", ",", "\"\<\!\(\*SubscriptBox[\(E\), \(x\)]\)\>\""}], 
       "}"}]}], ",", 
     RowBox[{"PlotLabel", "\[Rule]", "\"\<Electric field at t=0\>\""}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.486200217182102*^9, 3.486200225238225*^9}, {
   3.4862216616704807`*^9, 3.486221698515481*^9}, {3.4862221443784227`*^9, 
   3.4862221477262087`*^9}, {3.486222266492096*^9, 3.486222272435574*^9}, {
   3.486222345798456*^9, 3.4862225016454983`*^9}, 3.48628552734688*^9}],

Cell[TextData[{
 "A quick way to take a numerical derivative of a list in ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " is to use rotate the list using ",
 ButtonBox["RotateLeft",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://reference.wolfram.com/mathematica/ref/RotateLeft.html"], None},
  ButtonNote->
   "http://reference.wolfram.com/mathematica/ref/RotateLeft.html"],
 " and/or ",
 ButtonBox["RotateRight",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://reference.wolfram.com/mathematica/ref/RotateRight.html"], 
    None},
  ButtonNote->"http://reference.wolfram.com/mathematica/ref/RotateRight.html"],
 ". To see how this works lets\[CloseCurlyQuote]s look at a small symbolic \
list."
}], "Text",
 CellChangeTimes->{{3.4862868465271997`*^9, 3.4862869509056377`*^9}, {
  3.486286997148628*^9, 3.486287033664576*^9}, {3.4862872422632103`*^9, 
  3.486287264381266*^9}}],

Cell[BoxData[
 RowBox[{"testData", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"f", "[", "i", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "6"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.486287269108098*^9, 3.486287286731916*^9}}],

Cell["\<\
Notice that rotating the list to the left and subtracting the original list \
gives us a forward difference except at the ends of the list which will need \
to be fixed by the boundary conditions.\
\>", "Text",
 CellChangeTimes->{{3.486287343041749*^9, 3.486287456029265*^9}, 
   3.4862876728073797`*^9, {3.517325787151496*^9, 3.5173257875424547`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"RotateLeft", "[", "testData", "]"}], "-", "testData"}]], "Input",
 CellChangeTimes->{{3.486287296532205*^9, 3.486287335744639*^9}}],

Cell[BoxData[
 RowBox[{"testData", "-", 
  RowBox[{"RotateLeft", "[", "testData", "]"}]}]], "Input",
 CellChangeTimes->{{3.490695794686544*^9, 3.490695820779583*^9}}],

Cell["Rotating the list to the right gives a backwards difference ", "Text",
 CellChangeTimes->{{3.486287550361559*^9, 3.4862875852255487`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"RotateRight", "[", "testData", "]"}], "-", "testData"}]], "Input",
 CellChangeTimes->{{3.4862875219466143`*^9, 3.486287529040967*^9}}],

Cell["\<\
and rotating left minus the right rotation gives a central difference.\
\>", "Text",
 CellChangeTimes->{{3.4862875888571863`*^9, 3.486287612058395*^9}, 
   3.4862876769191523`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"RotateLeft", "[", "testData", "]"}], "-", 
  RowBox[{"RotateRight", "[", "testData", "]"}]}]], "Input",
 CellChangeTimes->{{3.48628762284652*^9, 3.486287631916727*^9}}],

Cell[TextData[{
 "By using a right rotation for the spatial derivative of the magnetic field \
and a left rotation for the spatial derivative of the electric field, we \
ensure the appropriate spatial interleaving of the fields. We step forward in \
steps of \[CapitalDelta]t/2 so that the time is given by ",
 Cell[BoxData[
  FormBox[
   RowBox[{"t", "=", 
    RowBox[{
     SubscriptBox["t", "0"], "+", 
     RowBox[{"n", " ", 
      RowBox[{"\[CapitalDelta]t", "/", "2"}]}]}]}], TraditionalForm]]],
 ". We will take ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["t", "0"], "=", "0"}], TraditionalForm]]],
 ". We are using an explicit method for solving our equations and explicit \
methods are only conditionally stable. For stability we must satisfy the \
Courant condition [8] ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[CapitalDelta]t", "\[LessEqual]", " ", 
    FractionBox["\[CapitalDelta]z", 
     RowBox[{"2", "c"}]]}], TraditionalForm]]],
 "where ",
 Cell[BoxData[
  FormBox["c", TraditionalForm]]],
 " is the speed of light in a vacuum. In our units ",
 Cell[BoxData[
  FormBox[
   RowBox[{"c", "=", "1"}], TraditionalForm]]],
 " since ",
 Cell[BoxData[
  FormBox[
   RowBox[{"c", "=", 
    RowBox[{"1", "/", 
     SqrtBox[
      RowBox[{
       SubscriptBox["\[Mu]", "0"], 
       SubscriptBox["\[Epsilon]", "0"]}]]}]}], TraditionalForm]]],
 " and we have taken the values of both  ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Mu]", "0"], " ", "and", " ", 
    SubscriptBox["\[Epsilon]", "0"]}], TraditionalForm]]],
 " to be one. We will take ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[CapitalDelta]t", "=", 
    RowBox[{
     RowBox[{"\[CapitalDelta]z", "/", "2"}], "c"}]}], TraditionalForm]]],
 ". Notice that ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[CapitalDelta]t", " "}], TraditionalForm]]],
 " does not appear in the equations anymore. The module \
\[OpenCurlyDoubleQuote]reflection\[CloseCurlyDoubleQuote] solves Maxwell\
\[CloseCurlyQuote]s equations for  wave incident on a medium with ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Epsilon]", "\[NotEqual]", "1"}], TraditionalForm]]],
 " after every 10 time steps the solution is plotted. So far we have not \
worried about boundary conditions. The boundary conditions imposed by list \
rotation are periodic ones. As the wave propagates of the end of the grid it \
will show up on the side. Thus, our solution is only valid for a finite time. "
}], "Text",
 CellChangeTimes->{{3.486310215260207*^9, 3.486310314354776*^9}, {
   3.486310352408431*^9, 3.486310449565209*^9}, {3.486311640483996*^9, 
   3.486311732164806*^9}, {3.486316523733055*^9, 3.486316526562811*^9}, 
   3.486372793384342*^9, {3.4863728411005697`*^9, 3.4863730171309233`*^9}, {
   3.486373479951226*^9, 3.486373595960693*^9}, {3.486373798938156*^9, 
   3.4863739674338713`*^9}, {3.4863759778849573`*^9, 3.486376107898939*^9}, {
   3.486460490863793*^9, 3.486460495583294*^9}, {3.486486732516261*^9, 
   3.486486769283552*^9}, {3.5027106956376123`*^9, 3.502710696235734*^9}, 
   3.514739649300358*^9, 3.514741068275898*^9, {3.5173258155251904`*^9, 
   3.517325831688899*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"reflection", "[", 
   StyleBox[
    RowBox[{"\[Epsilon]", 
     StyleBox["_",
      FontColor->GrayLevel[0]]}]], 
   StyleBox["]",
    FontColor->GrayLevel[0]]}], 
  StyleBox[":=",
   FontColor->GrayLevel[0]], 
  RowBox[{
   StyleBox["Module",
    FontColor->GrayLevel[0]], 
   StyleBox["[",
    FontColor->GrayLevel[0]], 
   RowBox[{
    StyleBox[
     RowBox[{"{", "}"}],
     FontColor->GrayLevel[0]], 
    StyleBox[",",
     FontColor->GrayLevel[0]], 
    StyleBox["\[IndentingNewLine]",
     FontColor->GrayLevel[0]], 
    RowBox[{
     RowBox[{"\[Epsilon]Data", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"edge", "[", "\[Epsilon]", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"z", ",", 
          RowBox[{"-", "8"}], ",", "8", ",", "step"}], "}"}]}], "]"}]}], ";", 
     "\n", 
     RowBox[{"Clear", "[", 
      RowBox[{"EField", ",", "HField"}], "]"}], ";", "\n", 
     RowBox[{"EField", "=", "EData"}], ";", "\n", 
     RowBox[{"HField", "=", "HData"}], ";", "\n", "  ", 
     RowBox[{"ListAnimate", "[", "\n", "\t", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Do", "[", "\n", "\t", 
          RowBox[{
           RowBox[{
            RowBox[{"EField", "=", 
             RowBox[{"EField", "+", 
              RowBox[{
               RowBox[{"1", "/", 
                RowBox[{"(", 
                 RowBox[{"2", "\[Epsilon]Data"}], ")"}]}], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"RotateRight", "[", "HField", "]"}], " ", "-", " ", 
                 "HField"}], ")"}]}]}]}], ";", "\n", "\t", 
            RowBox[{"HField", "=", 
             RowBox[{"HField", "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "/", "2"}], ")"}], 
               RowBox[{"(", 
                RowBox[{"EField", "-", 
                 RowBox[{"RotateLeft", "[", "EField", "]"}]}], ")"}]}]}]}]}], 
           ",", "\n", "\t\t", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", "10"}], "}"}]}], "]"}], ";", "\n", 
         "\t\t", "\n", "\t\t", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Transpose", "[", 
              RowBox[{"{", 
               RowBox[{"grid", ",", "EField"}], "}"}], "]"}], ",", 
             RowBox[{"Transpose", "[", 
              RowBox[{"{", 
               RowBox[{"grid", ",", "HField"}], "}"}], "]"}], ",", 
             RowBox[{"Transpose", "[", 
              RowBox[{"{", 
               RowBox[{"grid", ",", "\[Epsilon]Data"}], "}"}], "]"}]}], "}"}],
            ",", 
           RowBox[{"Joined", "->", "True"}], ",", "\n", "\t\t", 
           RowBox[{"PlotRange", "->", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "2"}], ",", "2"}], "}"}]}], ",", "\n", "\t\t", 
           RowBox[{"PlotLabel", "\[Rule]", 
            RowBox[{"StringJoin", "[", 
             StyleBox[
              RowBox[{
              "\"\<Blue Curve is the E field \\n Red is the H field field \\n \
Green is \[Epsilon](x)\\n t=\>\"", " ", ",", 
               RowBox[{"ToString", "[", 
                RowBox[{"10", " ", "i", " ", 
                 RowBox[{"step", "/", "2"}]}], "]"}]}],
              FontColor->GrayLevel[0]], 
             StyleBox["]",
              FontColor->GrayLevel[0]]}]}], 
           StyleBox[",",
            FontColor->GrayLevel[0]], 
           StyleBox["\n",
            FontColor->GrayLevel[0]], 
           StyleBox["\t\t",
            FontColor->GrayLevel[0]], 
           StyleBox[
            RowBox[{"PlotStyle", "->", 
             RowBox[{"{", 
              RowBox[{"Blue", ",", "Red", ",", "Green"}], "}"}]}],
            FontColor->GrayLevel[0]]}], 
          StyleBox["]",
           FontColor->GrayLevel[0]]}]}], 
        StyleBox[",",
         FontColor->GrayLevel[0]], 
        StyleBox["\n",
         FontColor->GrayLevel[0]], 
        StyleBox["\t\t\t\t",
         FontColor->GrayLevel[0]], 
        StyleBox[
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "20"}], "}"}],
         FontColor->GrayLevel[0]]}], 
       StyleBox["]",
        FontColor->GrayLevel[0]]}], 
      StyleBox["]",
       FontColor->GrayLevel[0]]}]}]}], 
   StyleBox["]",
    FontColor->GrayLevel[0]]}]}]], "Input",
 CellChangeTimes->{{3.4861996365784197`*^9, 3.486199636580172*^9}, {
   3.4861996680291643`*^9, 3.486199717165619*^9}, {3.486199755967423*^9, 
   3.486199801518949*^9}, {3.486199837075695*^9, 3.486199880363924*^9}, {
   3.486199944075514*^9, 3.486199945598172*^9}, {3.486200490513076*^9, 
   3.486200530591237*^9}, {3.486200722589739*^9, 3.486200777853425*^9}, {
   3.486200931340748*^9, 3.486200977484435*^9}, 3.486221695205914*^9, {
   3.486221807862805*^9, 3.4862218244474287`*^9}, {3.486222253863407*^9, 
   3.486222256670624*^9}, {3.486222518084107*^9, 3.486222561417838*^9}, {
   3.4863770063236856`*^9, 3.486377049733717*^9}, {3.490029617598773*^9, 
   3.490029619685142*^9}, {3.490717476112414*^9, 3.490717529345853*^9}}],

Cell["\<\
Running the function \
\[OpenCurlyDoubleQuote]reflection\[CloseCurlyDoubleQuote] shows the \
generation of the magnetic pulse and the forward and backward propagation of \
the pulse and the reflection off the boundary. You should play with the value \
of \[Epsilon] to see if the results are what you expect.\
\>", "Text",
 CellChangeTimes->{{3.486376119369034*^9, 3.48637615836556*^9}, {
  3.486376190811645*^9, 3.4863762704938593`*^9}, {3.486486776391602*^9, 
  3.486486781095811*^9}, {3.5173258521054296`*^9, 3.5173258534487257`*^9}}],

Cell[BoxData[
 RowBox[{"reflection", "[", "2", "]"}]], "Input",
 CellChangeTimes->{{3.486200805206249*^9, 3.4862008112880497`*^9}, {
   3.486220589010488*^9, 3.4862206467385807`*^9}, {3.48628968280514*^9, 
   3.486289691580083*^9}, {3.4905434460911703`*^9, 3.49054344712342*^9}, 
   3.4905435226905518`*^9, 3.490632450094379*^9, 3.490717449064953*^9, {
   3.490717541392297*^9, 3.490717545222349*^9}}],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{3.490689578561646*^9}],

Cell[TextData[{
 "We should check propagation in free space which we can do by setting ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Epsilon]", "=", "1"}], TraditionalForm]]],
 ". One thing to check is the wave propagation speed which should be one. The \
wave starts centered at ",
 Cell[BoxData[
  FormBox[
   RowBox[{"z", "=", 
    RowBox[{"-", "2"}]}], TraditionalForm]]],
 " at ",
 Cell[BoxData[
  FormBox[
   RowBox[{"t", "=", "0"}], TraditionalForm]]],
 " and by looking at the animation you can see that the backward propagating \
piece is at ",
 Cell[BoxData[
  FormBox[
   RowBox[{"z", "=", 
    RowBox[{"-", "3"}]}], TraditionalForm]]],
 " at ",
 Cell[BoxData[
  FormBox[
   RowBox[{"t", "=", "1"}], TraditionalForm]]],
 " as it should be."
}], "Text",
 CellChangeTimes->{{3.486376396940091*^9, 3.486376433388715*^9}, {
  3.486377096766941*^9, 3.486377124494809*^9}, {3.4863771664974937`*^9, 
  3.486377298405278*^9}, {3.48648678648913*^9, 3.4864867935212183`*^9}}],

Cell[BoxData[
 RowBox[{"reflection", "[", "1", "]"}]], "Input",
 CellChangeTimes->{{3.4863763102535267`*^9, 3.486376370708571*^9}}],

Cell[TextData[{
 "If we take ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Epsilon]", "=", "4"}], TraditionalForm]]],
 " then the wave in the medium should propagate with a speed of one-half, and \
checking the figure shows that this is true. These are just basic sanity \
checks on our code."
}], "Text",
 CellChangeTimes->{{3.48637737880173*^9, 3.486377480396615*^9}, 
   3.489941407766986*^9, 3.517325891202868*^9}],

Cell[BoxData[
 RowBox[{"reflection", "[", "4", "]"}]], "Input",
 CellChangeTimes->{{3.486377315561612*^9, 3.4863773188646*^9}}],

Cell[TextData[{
 "We also need to think about units. How do we get from our computational \
units to physical units? Suppose our grid is 16 millimeters (since it runs \
from -8 to 8), then in meters each spacial step is ",
 Cell[BoxData[
  FormBox[
   RowBox[{"1", " ", 
    RowBox[{
     SuperscriptBox["10", 
      RowBox[{"-", "3"}]], "\[Cross]", "step"}], " ", "size"}], 
   TraditionalForm]]],
 ". In our case this is ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"5", "\[Cross]", 
     SuperscriptBox["10", 
      RowBox[{"-", "5"}]]}], " ", "m"}], TraditionalForm]]],
 ".  The units on the time steps are seconds and each time step is ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[CapitalDelta]t", " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"\[CapitalDelta]z", "/", "2"}], " ", "c"}], " ", "=", " ", 
     RowBox[{
      RowBox[{"2.5", " ", 
       SuperscriptBox["10", 
        RowBox[{"-", "5"}]], 
       RowBox[{"m", "/", "c"}]}], " ", "=", 
      RowBox[{"8.33", " ", 
       SuperscriptBox["10", 
        RowBox[{"-", "14"}]], "seconds"}]}]}]}], TraditionalForm]]]
}], "Text",
 CellChangeTimes->{{3.486377669508387*^9, 3.486377798184162*^9}, {
   3.486377904462034*^9, 3.4863780759386578`*^9}, {3.486378108819892*^9, 
   3.4863782114720287`*^9}, {3.48637827339643*^9, 3.486378299265245*^9}, {
   3.486457485374613*^9, 3.4864574969736834`*^9}, {3.4864575363330793`*^9, 
   3.4864575480225286`*^9}, {3.486457907454001*^9, 3.486457930161187*^9}, 
   3.486486824098522*^9, 3.486487046834847*^9, {3.509701660013651*^9, 
   3.509701777889637*^9}, {3.509702221484727*^9, 3.5097022268215857`*^9}, {
   3.5097026483071747`*^9, 3.509702691417777*^9}, {3.51732591390783*^9, 
   3.517325930006199*^9}}],

Cell[CellGroupData[{

Cell["Problem One", "Subsection",
 CellChangeTimes->{{3.4864000303983393`*^9, 3.48640003917207*^9}, 
   3.517325946695991*^9}],

Cell[TextData[{
 "The point of this problem is to make sure you understand how to convert \
between computational units and physical units (meters and seconds).\na) \
Suppose you wish to study the propagation of a FM radio wave with \[Lambda]=3 \
meters. If you want to follow its propagation in air for 1 second, what \
should you pick for a grid spacing, how big a grid must you use, and what is \
your time step?\nb) You want to study red light ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Lambda]", "=", 
    RowBox[{"650", "nm"}]}], TraditionalForm]]],
 " propagating over 1mm. What should you pick for a grid spacing, how big a \
grid do you need and what is your time step?"
}], "Text",
 CellChangeTimes->{{3.486400426308551*^9, 3.486400572968463*^9}, {
   3.486400690222732*^9, 3.486400816513227*^9}, {3.486402384821596*^9, 
   3.486402400590056*^9}, 3.4864024636568336`*^9, {3.486402567421583*^9, 
   3.486402695853487*^9}, {3.486402801381798*^9, 3.486402802233862*^9}, {
   3.486403250751978*^9, 3.4864032574310904`*^9}, 3.486486830018847*^9, {
   3.517325949876911*^9, 3.517325950604815*^9}, {3.517327480426711*^9, 
   3.5173275345966167`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Problem Two", "Subsection",
 CellChangeTimes->{{3.4864000303983393`*^9, 3.48640003917207*^9}, {
   3.486458459193524*^9, 3.486458462940002*^9}, 3.517327568061483*^9}],

Cell["\<\
A wave propagation in free space should propagate without dispersion. However \
Yee\[CloseCurlyQuote]s method introduced some dispersion due to numerical \
error. The amount depends on the grid space. Study this by looking at grid \
spacings ranging from 5 grid points per wavelength to 100 per wavelength. Do \
at least five different grid spacings and check the amount of dispersion you \
get. Smaller grid spacings increase computation time (if we follow the wave \
for the same amount of time) so make a plot of computation time as a function \
of grid spacing.\
\>", "Text",
 CellChangeTimes->{{3.486458507054523*^9, 3.486458864715151*^9}, {
   3.4864868474753847`*^9, 3.486486850707341*^9}, 3.517327583765889*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["More complicated Structures", "Subsection",
 CellChangeTimes->{{3.486486546103401*^9, 3.486486561533085*^9}}],

Cell[TextData[{
 "In practice of course we are usually interested in more complicated \
structures than a simple step. The function \"structure\" defined below \
generates a comb with alternating regions with permittivity constants ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Epsilon]", "1"], "and", " ", 
    SubscriptBox["\[Epsilon]", "2"]}], TraditionalForm]]],
 ". The spacing between the regions is determined by ",
 Cell[BoxData[
  FormBox["L", TraditionalForm]]],
 " and there are ",
 Cell[BoxData[
  FormBox[
   RowBox[{"n", "+", "1"}], TraditionalForm]]],
 " \"teeth\".  If an \[Epsilon] is not specified in a region, it is assumed \
to be one."
}], "Text",
 CellChangeTimes->{{3.489484939755905*^9, 3.4894852036273603`*^9}, {
  3.4894853157022*^9, 3.489485322155631*^9}, {3.4894857272640543`*^9, 
  3.489485754672545*^9}, {3.489506581023573*^9, 3.4895066456175537`*^9}, {
  3.517328766549728*^9, 3.5173288041575003`*^9}}],

Cell[BoxData[{
 RowBox[{"Clear", "[", "L", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"structure", "[", 
   RowBox[{
   "x_", ",", "L_", ",", "\[Epsilon]1_", ",", "\[Epsilon]2_", ",", "n_"}], 
   "]"}], ":=", 
  RowBox[{"Piecewise", "[", 
   RowBox[{
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"1", ",", 
           RowBox[{"x", "<", "0"}]}], "}"}], "}"}], ",", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"\[Epsilon]1", ",", 
                RowBox[{
                 RowBox[{"2", "i", " ", "L"}], "\[LessEqual]", " ", "x", "<", 
                 " ", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"2", "i"}], "+", "1"}], ")"}], " ", "L"}]}]}], 
               "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\[Epsilon]2", ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"2", "i"}], "+", "1"}], ")"}], "L"}], 
                 "\[LessEqual]", " ", "x", "\[LessEqual]", " ", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"2", "i"}], "+", "2"}], ")"}], "L"}]}]}], "}"}]}],
              "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "0", ",", "n", ",", "1"}], "}"}]}], "]"}], ",",
           "1"}], "]"}]}], "}"}], ",", "1"}], "]"}], ",", "1"}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.387354772889751*^9, 3.387354864095842*^9}, {
   3.387354901733676*^9, 3.387354914901249*^9}, {3.387354977415926*^9, 
   3.38735499247573*^9}, {3.3873550336823807`*^9, 3.38735504973934*^9}, {
   3.387355400003626*^9, 3.3873554529460897`*^9}, {3.387355484765975*^9, 
   3.387355513498711*^9}, {3.387355673526187*^9, 3.387355728904698*^9}, {
   3.387355764836027*^9, 3.387355788736335*^9}, {3.3873558594470673`*^9, 
   3.387355888929501*^9}, {3.387355918989621*^9, 3.387356045228836*^9}, {
   3.3873560920247803`*^9, 3.3873561688142967`*^9}, {3.387356244810236*^9, 
   3.387356270127548*^9}, 3.387356300698773*^9, {3.387357353269991*^9, 
   3.387357397138401*^9}, {3.3873574297342787`*^9, 3.387357433219125*^9}, {
   3.38736085086412*^9, 3.3873608711525173`*^9}, 3.472297461715056*^9, {
   3.485512572425054*^9, 3.485512577636059*^9}, 3.486488848570356*^9, 
   3.4892550809438066`*^9, {3.489485208485087*^9, 3.489485224147846*^9}, {
   3.4895065695752077`*^9, 3.489506569854649*^9}}],

Cell[TextData[{
 "For example with ",
 Cell[BoxData[
  FormBox[
   RowBox[{"L", "=", "0.5"}], TraditionalForm]]],
 ", ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["\[Epsilon]", "1"], "=", "2"}], " ", ",", " ", 
    RowBox[{
     SubscriptBox["\[Epsilon]", "2"], "=", 
     RowBox[{
      RowBox[{"1", " ", "and", " ", "n"}], "=", "6"}]}]}], 
   TraditionalForm]]],
 " we get"
}], "Text",
 CellChangeTimes->{{3.489485330811552*^9, 3.4894854053282547`*^9}}],

Cell[BoxData[
 RowBox[{"structure", "[", 
  RowBox[{"x", ",", ".5", ",", "2", ",", "1", ",", "6"}], "]"}]], "Input",
 CellChangeTimes->{{3.3873556376809883`*^9, 3.387355650270821*^9}, {
   3.3873557356790247`*^9, 3.387355741861837*^9}, {3.387355809700459*^9, 
   3.387355833735733*^9}, {3.387355872051676*^9, 3.387355877616325*^9}, {
   3.4864888495975227`*^9, 3.486488859869288*^9}, 3.4892550519851303`*^9, 
   3.489255099379993*^9}],

Cell["which is plotted below.", "Text",
 CellChangeTimes->{{3.4894854150569143`*^9, 3.489485420265163*^9}, 
   3.489485760807423*^9}],

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"structure", "[", 
    RowBox[{"x", ",", ".5", ",", "2", ",", "1", ",", "6"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"-", "1"}], ",", "7"}], "}"}], ",", 
   RowBox[{"Exclusions", "\[Rule]", "None"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.387355455222518*^9, 3.38735546895119*^9}, {
   3.387355525498871*^9, 3.387355607444685*^9}, {3.387356067579927*^9, 
   3.387356070031891*^9}, {3.3873561796777363`*^9, 3.387356179969817*^9}, 
   3.387356314630254*^9, {3.387356380765793*^9, 3.3873563883625517`*^9}, {
   3.486488850825746*^9, 3.486488855824246*^9}, {3.4894852892532988`*^9, 
   3.489485301790374*^9}}],

Cell["\<\
We can use the function \"structure\" to generate a list which will contain \
the value of the permittivity at each grid point.\
\>", "Text",
 CellChangeTimes->{{3.489485664514969*^9, 3.48948570990786*^9}, {
  3.489485956032083*^9, 3.4894859634046297`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Epsilon]Data", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"structure", "[", 
      RowBox[{"x", ",", ".5", ",", "2", ",", "1", ",", "6"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"-", "4"}], ",", "4", ",", ".0125"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.387357508490218*^9, 3.3873575875134697`*^9}, {
   3.47229741898181*^9, 3.472297423676034*^9}, {3.472297509297349*^9, 
   3.47229751197521*^9}, 3.486488874232108*^9}],

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{"\[Epsilon]Data", ",", 
   RowBox[{"Joined", "\[Rule]", "True"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.387357592372443*^9, 3.387357599608923*^9}, {
   3.387360505446097*^9, 3.387360511874948*^9}, 3.471974868697801*^9}],

Cell[TextData[{
 "The code for solving Maxwell's equation is exactly the same as before. The \
only thing that changes is the list called \"\[Epsilon]Data\". The module \
\"multipleReflection\" solves Maxwell's equations for a comb with 61 teeth. \
The spatial domain (",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"-", "15"}], "\[LessEqual]", "x", "\[LessEqual]", "13"}], 
   TraditionalForm]]],
 ") has been chosen to be large enough to avoid the wave propagating off the \
edges. The boundary conditions are periodic so if the wave propagated off the \
edge, it would show up at the other edge and lead to an erroneous result."
}], "Text",
 CellChangeTimes->{{3.489486161905499*^9, 3.489486207196906*^9}, {
   3.489505943054226*^9, 3.48950598134305*^9}, {3.489508032191099*^9, 
   3.4895080468372087`*^9}, {3.489508102672419*^9, 3.4895081028642282`*^9}, {
   3.4895081664525843`*^9, 3.4895082510819798`*^9}, {3.4895082822053223`*^9, 
   3.489508374025848*^9}, {3.489856724880336*^9, 3.4898567276304817`*^9}, 
   3.490543390010373*^9, {3.5026449991985617`*^9, 3.5026450610566483`*^9}, 
   3.514819449559164*^9, {3.517328867003285*^9, 3.5173288703539867`*^9}}],

Cell[TextData[{
 "\n\n\n\nstep=0.0125;\nmultipleReflection[\[Epsilon]1",
 StyleBox["_,\[Epsilon]2_]:=Module[{},\n",
  FontColor->GrayLevel[0]],
 "\[Epsilon]Data = Table[structure[x, .1, \[Epsilon]1, \[Epsilon]2, 60], {x, \
-15, 13, step}];\nClear[EField,HField];\nEField=EData;\nHField=HData;",
 StyleBox["\n  ListAnimate[\n\tTable[Do[\n\t\
EField=EField+1/(2\[Epsilon]Data)(RotateRight[HField] - HField);\n\t\
HField=HField+(1/2)(EField-RotateLeft[EField]),\n\t\t{j,1,10}];\n\t\t\n\t\t\
ListPlot[{EField,HField,\[Epsilon]Data},Joined->True,\n\t\tPlotRange->{-2,2},\
\n\t\tPlotLabel->\"Blue Curve is the E field \\n Red is the H field field \\n \
Green is \[Epsilon](x)\",\n\t\tPlotStyle->{Blue,Red,Green}],\n\t\t\t\t\
{i,1,120}]]]",
  FontColor->GrayLevel[0]],
 StyleBox["\n\t",
  FontColor->RGBColor[0, 0, 1]]
}], "Input",
 CellChangeTimes->{{3.3870383664105883`*^9, 3.387038600703471*^9}, 
   3.387038793572834*^9, 3.3870401776179028`*^9, {3.387040325223721*^9, 
   3.3870403274451637`*^9}, {3.387040470970851*^9, 3.38704047356719*^9}, {
   3.387317009656238*^9, 3.387317153165873*^9}, {3.387317353210581*^9, 
   3.387317355550374*^9}, {3.387317432818081*^9, 3.3873175571284*^9}, {
   3.38731785318198*^9, 3.387317867080714*^9}, {3.3873181773632507`*^9, 
   3.387318198904708*^9}, {3.3873185193706303`*^9, 3.38731853285472*^9}, {
   3.387318664865107*^9, 3.387318748830668*^9}, {3.3873188200265102`*^9, 
   3.387318861857461*^9}, {3.38731902223389*^9, 3.3873190736652193`*^9}, {
   3.387350167519836*^9, 3.387350250931615*^9}, {3.387357638470364*^9, 
   3.38735766398639*^9}, {3.387360539301283*^9, 3.3873605432805767`*^9}, {
   3.387360657192958*^9, 3.3873606901033697`*^9}, 3.387360809281927*^9, {
   3.3873609259565573`*^9, 3.387360929121866*^9}, 3.387361383645728*^9, 
   3.38736141528155*^9, {3.387361923761999*^9, 3.3873619245038023`*^9}, 
   3.387361987944162*^9, 3.3873621859890833`*^9, {3.38736296105798*^9, 
   3.387362961339387*^9}, 3.387363028062805*^9, {3.387363067342873*^9, 
   3.387363067571171*^9}, {3.387363173606492*^9, 3.387363174460925*^9}, {
   3.387363584988872*^9, 3.38736358823452*^9}, 3.387363752879833*^9, {
   3.387364678070462*^9, 3.387364699691012*^9}, {3.387364828952655*^9, 
   3.387364870965963*^9}, {3.38736496871204*^9, 3.387364972006174*^9}, {
   3.387365102096339*^9, 3.387365104350336*^9}, {3.387365185872085*^9, 
   3.387365192923564*^9}, {3.387365322286625*^9, 3.387365325748385*^9}, {
   3.387365526573454*^9, 3.3873655361069613`*^9}, {3.387365586557563*^9, 
   3.3873655889232883`*^9}, 3.387365996722158*^9, {3.471974873440872*^9, 
   3.471974874991167*^9}, 3.4722970635281878`*^9, {3.4722982819638987`*^9, 
   3.4722982838340273`*^9}, {3.472298318142864*^9, 3.472298328443564*^9}, {
   3.489505985847578*^9, 3.489506001104044*^9}, {3.4895061109553003`*^9, 
   3.489506111327162*^9}, {3.4895078249066153`*^9, 3.489507826950419*^9}, 
   3.4904613388253*^9, {3.490545113143898*^9, 3.490545113710308*^9}},
 TextJustification->1,
 AspectRatioFixed->True,
 CellTags->{
  "partial differential equations -solution by finite differences", 
   "diffusion equation"}],

Cell["\<\
The initial electric field is the same as before but is now sampled on a \
larger grid. In addition, there is now an initial magnetic field with the \
same initial waveform as the electric field.\
\>", "Text",
 CellChangeTimes->{{3.489508121249444*^9, 3.489508158716236*^9}, {
   3.489918271944647*^9, 3.489918393516696*^9}, 3.489918426839259*^9, {
   3.517328889153213*^9, 3.517328919058598*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Ei", "[", "z_", "]"}], "=", 
     RowBox[{
      RowBox[{"Sin", "[", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"2", "\[Pi]"}], ")"}], "z"}], "]"}], " ", 
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"-", "2"}], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"z", "+", "2"}], ")"}], "2"]}], "]"}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"Hi", "[", "z_", "]"}], "=", " ", 
     RowBox[{
      RowBox[{"Sin", "[", 
       RowBox[{"2", 
        RowBox[{"(", 
         RowBox[{"2", "\[Pi]"}], ")"}], "z"}], "]"}], "  ", 
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"-", "2"}], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"z", "+", "2"}], ")"}], "2"]}], "]"}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"EData", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Ei", "[", "z", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"z", ",", 
         RowBox[{"-", "15"}], ",", "13", ",", "step"}], "}"}]}], "]"}]}], 
    ";"}], "\n", 
   RowBox[{
    RowBox[{"HData", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Hi", "[", "z", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"z", ",", 
         RowBox[{"-", "15"}], ",", "13", ",", "step"}], "}"}]}], "]"}]}], 
    ";"}], "\n", 
   RowBox[{"ListPlot", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"EData", ",", "HData"}], "}"}], ",", 
     RowBox[{"Joined", "\[Rule]", "True"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.387037559596674*^9, 3.387037631754663*^9}, 
   3.3870406539404716`*^9, {3.387317926581126*^9, 3.3873179389545603`*^9}, {
   3.387317974885375*^9, 3.387317995786388*^9}, 3.3873500080736637`*^9, {
   3.387361003085369*^9, 3.38736101894575*^9}, {3.387361687090238*^9, 
   3.3873617009863243`*^9}, {3.387361759527226*^9, 3.387361853418692*^9}, {
   3.387361933990777*^9, 3.387361934454104*^9}, {3.387362137535721*^9, 
   3.387362141117114*^9}, {3.387362966786186*^9, 3.387362970249588*^9}, {
   3.387363166422303*^9, 3.387363170331708*^9}, {3.387363593393435*^9, 
   3.387363597744678*^9}, {3.387363759163122*^9, 3.387363761763723*^9}, {
   3.387363892178854*^9, 3.387363892615903*^9}, {3.38736398266677*^9, 
   3.3873640543281927`*^9}, {3.387364182168202*^9, 3.3873641839405737`*^9}, {
   3.387364570381761*^9, 3.387364643968691*^9}, {3.387365401786812*^9, 
   3.3873654100732183`*^9}, {3.387365684963766*^9, 3.387365688887372*^9}, {
   3.387365840781645*^9, 3.3873658448683777`*^9}, {3.3873659061220512`*^9, 
   3.387365911463147*^9}, {3.38736598071373*^9, 3.387365984047489*^9}, {
   3.387366080320277*^9, 3.3873660827578497`*^9}, {3.387366154829619*^9, 
   3.3873661563070717`*^9}, 3.471974882096938*^9, {3.486488930392847*^9, 
   3.486488944510088*^9}, {3.48950612546552*^9, 3.489506125815793*^9}, {
   3.489506261056786*^9, 3.4895062614161882`*^9}, {3.489507833926518*^9, 
   3.4895078400141687`*^9}, {3.489917874998757*^9, 3.489918048173952*^9}, {
   3.489918079465489*^9, 3.48991808299973*^9}, {3.489918310046591*^9, 
   3.489918312990765*^9}, {3.489918399451667*^9, 3.489918417661038*^9}}],

Cell[TextData[{
 "The result is shown in the next plot with ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Epsilon]", "1"], "=", 
    RowBox[{
     RowBox[{"2", " ", "and", " ", 
      SubscriptBox["\[Epsilon]", "2"]}], "=", "1"}]}], TraditionalForm]]],
 "."
}], "Text",
 CellChangeTimes->{{3.489508397028829*^9, 3.4895084272184134`*^9}, {
  3.489512578485435*^9, 3.489512594748314*^9}}],

Cell[BoxData[
 RowBox[{"multipleReflection", "[", 
  RowBox[{"2", ",", "1"}], "]"}]], "Input",
 CellChangeTimes->{{3.472297126724334*^9, 3.472297146337428*^9}, {
  3.472297607819826*^9, 3.4722976094494867`*^9}, {3.489505727895815*^9, 
  3.489505729487364*^9}, {3.489506139134927*^9, 3.489506139551485*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Problem Three", "Subsection",
 CellChangeTimes->{{3.4864000303983393`*^9, 3.48640003917207*^9}, {
   3.486458459193524*^9, 3.486458462940002*^9}, {3.489856771776671*^9, 
   3.4898567725986347`*^9}, 3.517328940827219*^9}],

Cell[TextData[{
 "So far we have only dealt with linearly polarized waves. This problem asks \
you to extend the treatment of circularly polarized waves. Propagation is \
still restricted to the ",
 Cell[BoxData[
  FormBox["z", TraditionalForm]]],
 " direction but we now allow an ",
 Cell[BoxData[
  FormBox[
   RowBox[{"x", " "}], TraditionalForm]]],
 "component of the magnetic field and ",
 Cell[BoxData[
  FormBox["y", TraditionalForm]]],
 " component of the electric field. This gives us two new equations: "
}], "Text",
 CellChangeTimes->{
  3.489856798112501*^9, {3.489857253150003*^9, 3.4898573447399187`*^9}, {
   3.489913877360018*^9, 3.489914051938861*^9}, 3.4899140906729383`*^9, 
   3.489914181669736*^9, {3.502642491747547*^9, 3.502642492406921*^9}, {
   3.502642730996944*^9, 3.502642730997013*^9}, {3.517328944411049*^9, 
   3.517328950836466*^9}}],

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{"\t\t\t\t\t", GridBox[{
     {
      RowBox[{"\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         FractionBox[
          RowBox[{"\[PartialD]", 
           SubscriptBox["H", "x"]}], 
          RowBox[{"\[PartialD]", " ", "t"}]], "=", 
         RowBox[{
          FractionBox["1", "\[Mu]"], "  ", 
          FractionBox[
           RowBox[{"\[PartialD]", 
            SubscriptBox["E", "y"]}], 
           RowBox[{"\[PartialD]", " ", "z"}]]}]}], "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{
         FractionBox[
          RowBox[{"\[PartialD]", 
           SubscriptBox["E", "y"]}], 
          RowBox[{"\[PartialD]", "t"}]], "=", 
         RowBox[{
          FractionBox["1", "\[Epsilon]"], " ", 
          FractionBox[
           RowBox[{"\[PartialD]", 
            SubscriptBox["\[CapitalEta]", "x"]}], 
           RowBox[{"\[PartialD]", "z"}]]}]}]}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{"Center"}}}]}], 
  TraditionalForm]], "Input",
 CellChangeTimes->{{3.4832006198353033`*^9, 3.48320062216774*^9}, {
  3.4832007943534727`*^9, 3.483200794797555*^9}, {3.483201701594552*^9, 
  3.483201705730548*^9}, {3.485512382347275*^9, 3.485512606410881*^9}},
 TextAlignment->Left,
 TextJustification->0.]], "Text",
 CellChangeTimes->{
  3.485878949239925*^9, {3.486114747893718*^9, 3.486114751173077*^9}, {
   3.486290079283839*^9, 3.486290079283923*^9}, {3.489914109494787*^9, 
   3.489914166954617*^9}}],

Cell["so that the full set of equations is", "Text",
 CellChangeTimes->{{3.48991418609966*^9, 3.4899141974042273`*^9}}],

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{"\t\t\t\t\t", GridBox[{
     {
      RowBox[{
       RowBox[{
        FractionBox[
         RowBox[{GridBox[{
            {"\[IndentingNewLine]"}
           },
           GridBoxAlignment->{"Columns" -> {{"Center"}}}], 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"\[PartialD]", 
           SubscriptBox["H", "y"]}]}], 
         RowBox[{"\[PartialD]", " ", "t"}]], "=", 
        RowBox[{
         FractionBox[
          RowBox[{"-", "1"}], "\[Mu]"], "  ", 
         FractionBox[
          RowBox[{"\[PartialD]", 
           SubscriptBox["E", "x"]}], 
          RowBox[{"\[PartialD]", " ", "z"}]]}]}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        FractionBox[
         RowBox[{"\[PartialD]", 
          SubscriptBox["E", "x"]}], 
         RowBox[{"\[PartialD]", "t"}]], "=", 
        RowBox[{
         FractionBox[
          RowBox[{"-", "1"}], "\[Epsilon]"], " ", 
         FractionBox[
          RowBox[{"\[PartialD]", 
           SubscriptBox["\[CapitalEta]", "y"]}], 
          RowBox[{"\[PartialD]", "z"}]]}]}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        FractionBox[
         RowBox[{"\[PartialD]", 
          SubscriptBox["H", "x"]}], 
         RowBox[{"\[PartialD]", " ", "t"}]], "=", 
        RowBox[{
         FractionBox["1", "\[Mu]"], "  ", 
         FractionBox[
          RowBox[{"\[PartialD]", 
           SubscriptBox["E", "y"]}], 
          RowBox[{"\[PartialD]", " ", "z"}]]}]}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        FractionBox[
         RowBox[{"\[PartialD]", 
          SubscriptBox["E", "y"]}], 
         RowBox[{"\[PartialD]", "t"}]], "=", 
        RowBox[{
         FractionBox["1", "\[Epsilon]"], " ", 
         FractionBox[
          RowBox[{"\[PartialD]", 
           SubscriptBox["\[CapitalEta]", "x"]}], 
          RowBox[{"\[PartialD]", "z"}]]}]}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Del]", 
         RowBox[{"\[CenterDot]", 
          StyleBox["E",
           FontWeight->"Bold"]}]}], "=", "0"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Del]", 
         RowBox[{"\[CenterDot]", "B"}]}], "=", "0"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{"Center"}}}]}], 
  TraditionalForm]], "Input",
 CellChangeTimes->{{3.4832006198353033`*^9, 3.48320062216774*^9}, {
  3.4832007943534727`*^9, 3.483200794797555*^9}, {3.483201701594552*^9, 
  3.483201705730548*^9}, {3.485512382347275*^9, 3.485512606410881*^9}},
 TextAlignment->Left,
 TextJustification->0.]], "Text",
 CellChangeTimes->{
  3.485878949239925*^9, {3.486114747893718*^9, 3.486114751173077*^9}, {
   3.486290079283839*^9, 3.486290079283923*^9}, {3.4899142019111223`*^9, 
   3.489914332428417*^9}}],

Cell[TextData[{
 "We  now have to specify initial conditions for four field components, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["H", "y"], ",", 
    SubscriptBox["H", "x"], ",", 
    RowBox[{
     SubscriptBox["E", "y"], "and", " ", 
     SubscriptBox["E", "x"]}]}], TraditionalForm]]],
 ".  Take\n"
}], "Text",
 CellChangeTimes->{{3.489918675480999*^9, 3.4899186860875587`*^9}, 
   3.4899332027419157`*^9, {3.489936150063257*^9, 3.489936217802375*^9}, 
   3.489936301418502*^9, {3.489941065814707*^9, 3.4899410730691977`*^9}, {
   3.4900005326352377`*^9, 3.4900005538660307`*^9}}],

Cell[TextData[{
 Cell[BoxData[
  FormBox[GridBox[{
     {
      RowBox[{GridBox[{
         {
          RowBox[{
           RowBox[{
            SubscriptBox["E", "x"], "(", "z0", ")"}], "=", 
           RowBox[{
            RowBox[{"sin", "(", 
             RowBox[{
              RowBox[{"4", "\[Pi]", " ", "z"}], "+", 
              SubscriptBox["\[Phi]", "y"]}], ")"}], 
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{
              RowBox[{"-", "2"}], 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z", "+", "2"}], ")"}], "2"]}]]}]}]}
        },
        GridBoxAlignment->{"Columns" -> {{"Center"}}}], "\[IndentingNewLine]",
        GridBox[{
         {
          RowBox[{
           RowBox[{
            SubscriptBox["E", "y"], "(", 
            RowBox[{"z", ",", "0"}], ")"}], "=", 
           RowBox[{
            RowBox[{"sin", "(", 
             RowBox[{
              RowBox[{"4", "\[Pi]", " ", "z"}], "+", 
              SubscriptBox["\[Phi]", "x"]}], ")"}], 
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{
              RowBox[{"-", "2"}], 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z", "+", "2"}], ")"}], "2"]}]]}]}]}
        },
        GridBoxAlignment->{"Columns" -> {{"Center"}}}], "\[IndentingNewLine]",
        GridBox[{
         {
          RowBox[{
           RowBox[{
            SubscriptBox["H", "x"], "(", 
            RowBox[{"z", ",", "0"}], ")"}], "=", 
           RowBox[{
            RowBox[{"sin", "(", 
             RowBox[{
              RowBox[{"4", "\[Pi]", " ", "z"}], "+", 
              SubscriptBox["\[Phi]", "y"]}], ")"}], 
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{
              RowBox[{"-", "2"}], 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z", "+", "2"}], ")"}], "2"]}]]}]}]}
        },
        GridBoxAlignment->{"Columns" -> {{"Center"}}}], "\[IndentingNewLine]",
        "and", "\[IndentingNewLine]", GridBox[{
         {
          RowBox[{
           RowBox[{
            SubscriptBox["H", "y"], "(", 
            RowBox[{"z", ",", "0"}], ")"}], "=", 
           RowBox[{
            RowBox[{"sin", "(", 
             RowBox[{
              RowBox[{"4", "\[Pi]", " ", "z"}], "+", 
              SubscriptBox["\[Phi]", "x"]}], ")"}], 
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{
              RowBox[{"-", "2"}], 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z", "+", "2"}], ")"}], "2"]}]]}]}]}
        },
        GridBoxAlignment->{"Columns" -> {{"Center"}}}]}]}
    },
    GridBoxItemSize->{"Columns" -> {{
         Scaled[0.96]}}}], TraditionalForm]]],
 "\nTake ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Phi]", "x"], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Pi]", "/", "2"}], " ", "and", " ", 
      SubscriptBox["\[Phi]", "y"]}], "=", "0"}]}], TraditionalForm]]],
 ". This gives a phase difference of ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Pi]", "/", "2"}], TraditionalForm]]],
 " and circular polarization."
}], "Text",
 CellChangeTimes->{{3.489941143251186*^9, 3.489941236832458*^9}, {
  3.489941293357828*^9, 3.489941377955192*^9}, {3.490000792262765*^9, 
  3.4900008760149403`*^9}, {3.4900011335502577`*^9, 3.490001133842366*^9}}],

Cell["Now implement the FDTD method on the following structure:", "Text",
 CellChangeTimes->{{3.490000557922195*^9, 3.4900005587779903`*^9}, {
  3.4900006001249037`*^9, 3.490000633255046*^9}, {3.4900008974752893`*^9, 
  3.490000898048409*^9}, {3.490001035948325*^9, 3.490001055364251*^9}}],

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"structure", "[", 
    RowBox[{
    "x", ",", " ", ".4", ",", " ", "1", ",", " ", "2", ",", " ", "2"}], "]"}],
    ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"-", "2"}], ",", "3"}], "}"}], ",", 
   RowBox[{"Exclusions", "\[Rule]", "None"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.490000683845004*^9, 3.49000073874656*^9}}],

Cell["\<\
An implementation of the FDTD for circularly polarized wave propagation in \
free space is given by Landau, P\[AAcute]ez and Bordeianu [9].\
\>", "Text",
 CellChangeTimes->{{3.490000921729766*^9, 3.4900010081755857`*^9}, {
   3.49000103853808*^9, 3.490001041642295*^9}, 3.514739608030933*^9, 
   3.514741049215489*^9, {3.517328973462863*^9, 3.517328979652831*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Two-Dimensional Propagation", "Section",
 CellChangeTimes->{{3.486400138497245*^9, 3.486400147655971*^9}, {
  3.5174171797126427`*^9, 3.517417179973646*^9}}],

Cell[TextData[{
 "We now turn our attention to the more complicated but more interesting \
two-dimensional case. We will assume that the fields do not depend on ",
 Cell[BoxData[
  FormBox["z", TraditionalForm]]],
 ". As noted earlier we can then break Maxwell\[CloseCurlyQuote]s equations \
into two cases. "
}], "Text",
 CellChangeTimes->{{3.502705504141292*^9, 3.502705517604459*^9}, {
   3.502705869794284*^9, 3.502705970966682*^9}, {3.502706382118475*^9, 
   3.5027063840065393`*^9}, 3.514819457849866*^9, {3.51741718653976*^9, 
   3.517417193023617*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{"\t\t\t\t\t", 
   RowBox[{GridBox[{
      {
       RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         StyleBox[
          RowBox[{
           RowBox[{
            SubscriptBox["E", "x"], "=", 
            RowBox[{
             SubscriptBox["E", "y"], "=", "0"}]}], ",", 
           RowBox[{
            SubscriptBox["H", "z"], "=", "0"}]}],
          FontWeight->"Plain"], "\[IndentingNewLine]", 
         RowBox[{
          FractionBox[
           RowBox[{"\[PartialD]", 
            SubscriptBox["H", "x"]}], 
           RowBox[{"\[PartialD]", "t"}]], "=", 
          RowBox[{
           RowBox[{"-", 
            FractionBox["1", "\[Mu]"]}], 
           FractionBox[
            RowBox[{"\[PartialD]", 
             SubscriptBox["E", "z"]}], 
            RowBox[{"\[PartialD]", "y"}]]}]}], "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{
          FractionBox[
           RowBox[{"\[PartialD]", 
            SubscriptBox["H", "y"]}], 
           RowBox[{"\[PartialD]", "t"}]], "=", 
          RowBox[{
           FractionBox["1", "\[Mu]"], 
           FractionBox[
            RowBox[{"\[PartialD]", 
             SubscriptBox["E", "z"]}], 
            RowBox[{"\[PartialD]", "x"}]]}]}], "\[IndentingNewLine]", 
         RowBox[{
          FractionBox[
           RowBox[{"\[PartialD]", 
            SubscriptBox["E", "z"]}], 
           RowBox[{"\[PartialD]", "t"}]], "=", 
          RowBox[{
           FractionBox["1", "\[Epsilon]"], 
           RowBox[{"(", " ", 
            RowBox[{
             FractionBox[
              RowBox[{"\[PartialD]", 
               SubscriptBox["\[CapitalEta]", "y"]}], 
              RowBox[{"\[PartialD]", "x"}]], "-", 
             FractionBox[
              RowBox[{"\[PartialD]", 
               SubscriptBox["H", "x"]}], 
              RowBox[{"\[PartialD]", "y"}]]}], ")"}]}]}], 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"\[Del]", 
           RowBox[{"\[CenterDot]", "E"}]}], "=", "0"}], "\[IndentingNewLine]",
          "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"\[Del]", 
           RowBox[{"\[CenterDot]", "B"}]}], "=", "0"}]}]}]}
     },
     GridBoxAlignment->{"Columns" -> {{"Center"}}}], "       ", "TM", " ", 
    "Mode"}]}], TraditionalForm]], "Input",
 CellChangeTimes->{{3.4832006198353033`*^9, 3.48320062216774*^9}, {
   3.4832007943534727`*^9, 3.483200794797555*^9}, {3.483201701594552*^9, 
   3.483201705730548*^9}, {3.485512382347275*^9, 3.485512606410881*^9}, {
   3.485878664732164*^9, 3.485878685093293*^9}, {3.4858787251267977`*^9, 
   3.485878757240057*^9}, 3.48587900675313*^9, {3.485879484958219*^9, 
   3.485879585327115*^9}, {3.4861128281645937`*^9, 3.4861128565971193`*^9}, {
   3.486112887999008*^9, 3.4861130948229723`*^9}, {3.486113131931333*^9, 
   3.486113167233302*^9}, {3.486113457242914*^9, 3.486113503238923*^9}, 
   3.486113535616929*^9, {3.486114717885149*^9, 3.486114733332986*^9}, {
   3.486114936334333*^9, 3.486114947077001*^9}, {3.486115077385652*^9, 
   3.48611508173521*^9}, {3.4861151177043858`*^9, 3.486115186351157*^9}, {
   3.486115408750252*^9, 3.4861154684145737`*^9}, {3.4861155098103523`*^9, 
   3.4861155328706913`*^9}, {3.502705804010644*^9, 3.502705805341032*^9}, {
   3.509898327564083*^9, 3.50989832787278*^9}},
 TextAlignment->Left,
 TextJustification->0.],

Cell["and for the TE mode we have", "Text",
 CellChangeTimes->{{3.486115558364965*^9, 3.486115568616765*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{"\t\t\t\t\t", 
   RowBox[{GridBox[{
      {
       RowBox[{"\[IndentingNewLine]", 
        RowBox[{
         StyleBox[
          RowBox[{
           RowBox[{
            SubscriptBox["H", "x"], "=", 
            RowBox[{
             SubscriptBox["H", "y"], "=", "0"}]}], ",", 
           RowBox[{
            SubscriptBox["E", "z"], "=", "0"}]}],
          FontWeight->"Plain"], "\[IndentingNewLine]", 
         RowBox[{
          FractionBox[
           RowBox[{"\[PartialD]", 
            SubscriptBox["H", "z"]}], 
           RowBox[{"\[PartialD]", " ", "t"}]], "=", 
          RowBox[{
           RowBox[{"-", 
            FractionBox["1", "\[Mu]"]}], " ", 
           RowBox[{"(", " ", 
            RowBox[{
             FractionBox[
              RowBox[{"\[PartialD]", 
               SubscriptBox["E", "y"]}], 
              RowBox[{"\[PartialD]", " ", "x"}]], "-", 
             FractionBox[
              RowBox[{"\[PartialD]", 
               SubscriptBox["E", "x"]}], 
              RowBox[{"\[PartialD]", "y"}]]}], ")"}]}]}], 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          FractionBox[
           RowBox[{"\[PartialD]", 
            SubscriptBox["E", "x"]}], 
           RowBox[{"\[PartialD]", "t"}]], "=", 
          RowBox[{
           FractionBox["1", "\[Epsilon]"], 
           FractionBox[
            RowBox[{"\[PartialD]", 
             SubscriptBox["H", "z"]}], 
            RowBox[{"\[PartialD]", "y"}]]}]}], "\[IndentingNewLine]", 
         RowBox[{
          FractionBox[
           RowBox[{"\[PartialD]", 
            SubscriptBox["E", "y"]}], 
           RowBox[{"\[PartialD]", "t"}]], "=", 
          RowBox[{
           RowBox[{"-", 
            FractionBox[
             RowBox[{" ", "1"}], "\[Epsilon]"]}], 
           FractionBox[
            RowBox[{"\[PartialD]", 
             SubscriptBox["H", "z"]}], 
            RowBox[{"\[PartialD]", "x"}]]}]}], "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"\[Del]", 
           RowBox[{"\[CenterDot]", "E"}]}], "=", "0"}], "\[IndentingNewLine]",
          "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"\[Del]", 
           RowBox[{"\[CenterDot]", "B"}]}], "=", "0"}]}]}]}
     },
     GridBoxAlignment->{"Columns" -> {{"Center"}}}], "TE", " ", "Mode"}]}], 
  TraditionalForm]], "Input",
 CellChangeTimes->{{3.4832006198353033`*^9, 3.48320062216774*^9}, {
   3.4832007943534727`*^9, 3.483200794797555*^9}, {3.483201701594552*^9, 
   3.483201705730548*^9}, {3.485512382347275*^9, 3.485512606410881*^9}, {
   3.485878664732164*^9, 3.485878685093293*^9}, {3.4858787251267977`*^9, 
   3.485878757240057*^9}, 3.48587900675313*^9, {3.485879484958219*^9, 
   3.485879585327115*^9}, {3.4861128281645937`*^9, 3.4861128565971193`*^9}, {
   3.486112887999008*^9, 3.4861130948229723`*^9}, {3.486113131931333*^9, 
   3.486113167233302*^9}, {3.486113457242914*^9, 3.486113503238923*^9}, 
   3.486113535616929*^9, {3.486114717885149*^9, 3.486114733332986*^9}, {
   3.486114936334333*^9, 3.486114947077001*^9}, {3.486115077385652*^9, 
   3.48611508173521*^9}, {3.4861151177043858`*^9, 3.486115186351157*^9}, {
   3.4861155730587473`*^9, 3.486115651880002*^9}, {3.486115711273682*^9, 
   3.486115712512904*^9}},
 TextAlignment->Left,
 TextJustification->0.],

Cell["We will consider the TM mode. ", "Text",
 CellChangeTimes->{{3.502706080691539*^9, 3.502706093114574*^9}, {
  3.514045524501265*^9, 3.514045525132909*^9}}],

Cell[TextData[{
 "We will need initial conditions for ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["E", "z"], ",", 
    SubscriptBox["H", "y"], ",", " ", 
    RowBox[{"and", " ", 
     SubscriptBox["H", "z"]}]}], TraditionalForm]]],
 " as well as boundary conditions for the grid and any objects in the grid. \
Since the fields do not depend on ",
 Cell[BoxData[
  FormBox["z", TraditionalForm]]],
 ", our grid is in the ",
 Cell[BoxData[
  FormBox[
   RowBox[{"x", " ", "y", " "}], TraditionalForm]]],
 "plane. We will start with just an ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["E", "z"], TraditionalForm]]],
 " field. The ",
 Cell[BoxData[
  FormBox["H", TraditionalForm]]],
 " field is initially zero. For the initial electric field, I will use a \
sinusoidal wave modulated by a Gaussian.  The constant ",
 Cell[BoxData[
  FormBox[
   RowBox[{"k", "=", 
    RowBox[{"2", 
     RowBox[{"\[Pi]", "/", "\[Lambda]"}]}]}], TraditionalForm]]],
 " is a wave number with units of inverse length. I will take ",
 Cell[BoxData[
  FormBox["k", TraditionalForm]]],
 " to be one."
}], "Text",
 CellChangeTimes->{{3.505751807979904*^9, 3.5057518528608828`*^9}, {
  3.505751929655547*^9, 3.505752032907395*^9}, {3.505752303606872*^9, 
  3.505752313270555*^9}, {3.505752557208623*^9, 3.505752618547592*^9}, {
  3.506769172497422*^9, 3.50676919040994*^9}, {3.506769263445073*^9, 
  3.5067693136546926`*^9}, {3.509874256267712*^9, 3.509874331918531*^9}, {
  3.514819460461266*^9, 3.514819468965375*^9}, {3.5174172053165827`*^9, 
  3.51741724792489*^9}}],

Cell[BoxData[{
 RowBox[{"Clear", "[", "k", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Eiz", "[", 
    RowBox[{"x_", ",", "y_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"Sin", "[", 
     RowBox[{"k", " ", "x"}], "]"}], " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"k", " ", "y"}], "]"}], " ", 
    RowBox[{"Exp", "[", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["k", "2"]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["y", "2"]}], ")"}], "/", "5"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"k", "=", "1"}], ";"}]}], "Input",
 CellChangeTimes->{{3.505752209381522*^9, 3.505752266078691*^9}, {
  3.505752363266448*^9, 3.505752408931916*^9}, {3.5057524453338823`*^9, 
  3.505752458694315*^9}, {3.505752546201503*^9, 3.5057525467051897`*^9}, {
  3.505752986979767*^9, 3.505753007203608*^9}, {3.5098742069339523`*^9, 
  3.509874229980658*^9}, {3.509876303534498*^9, 3.509876321026894*^9}, {
  3.5110010411127872`*^9, 3.511001041919508*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.509874249725387*^9, 3.509874251308463*^9}, 
   3.511001038896369*^9}],

Cell[TextData[{
 "We will work on a square grid with ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"-", "10"}], "\[LessEqual]", " ", "x", "\[LessEqual]", 
    RowBox[{
     RowBox[{"10", " ", "and"}], " ", "-", "10"}], "\[LessEqual]", "y", 
    "\[LessEqual]", "10"}], TraditionalForm]]],
 ". If the units for the square are in meters, then we have a space ",
 Cell[BoxData[
  FormBox[
   RowBox[{"20", "by", " ", "20", " "}], TraditionalForm]]],
 " meters and if we use a step size of ",
 Cell[BoxData[
  FormBox["0.2", TraditionalForm]]],
 ", we will have a 101 by 101 grid with each step being 20 cm. Since ",
 Cell[BoxData[
  FormBox[
   RowBox[{"k", "=", "1"}], TraditionalForm]]],
 " we have ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Lambda]", "=", 
    RowBox[{"2", "\[Pi]"}]}], TraditionalForm]]],
 ". Since our physical units are meters this is a wave with a wavelength of \
",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Lambda]", "\[TildeTilde]", 
    RowBox[{"6.3", " ", "meters"}]}], TraditionalForm]]],
 " which means we have a radio wave. In six meters we will have ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"6.3", "/", "0.2"}], "\[TildeTilde]", "31"}], TraditionalForm]]],
 " grid points so our grid spacing is ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Lambda]", "/", "30"}], TraditionalForm]]],
 ". If our physical units are cm, then our wave has a wavelength of 6.3 cm \
and we have microwave radiation. Each time step is  ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[CapitalDelta]t", "=", 
    RowBox[{
     RowBox[{"\[CapitalDelta]z", "/", 
      RowBox[{"(", 
       RowBox[{"2", "c"}], ")"}]}], "=", 
     RowBox[{"3.3", " ", 
      SuperscriptBox["10", 
       RowBox[{"-", "10"}]]}]}]}], TraditionalForm]]],
 " seconds."
}], "Text",
 CellChangeTimes->{{3.50676931864678*^9, 3.5067693666648493`*^9}, {
   3.509873785938603*^9, 3.509874061476674*^9}, {3.50987434194361*^9, 
   3.5098744870216637`*^9}, {3.509875389523129*^9, 3.509875478827673*^9}, {
   3.509875512156752*^9, 3.5098755303016148`*^9}, {3.5098758453472357`*^9, 
   3.509875951574256*^9}, {3.509876030411581*^9, 3.509876052700437*^9}, {
   3.509876085228413*^9, 3.509876111333021*^9}, {3.5098761594899263`*^9, 
   3.509876192039651*^9}, {3.5098764199498377`*^9, 3.509876420161178*^9}, 
   3.5148194792035427`*^9, {3.517417260766263*^9, 3.517417304254202*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"end", "=", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Plot3D", "[", 
  RowBox[{
   RowBox[{"Eiz", "[", 
    RowBox[{"x", ",", "y"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"-", "end"}], ",", "end"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"y", ",", 
     RowBox[{"-", "end"}], ",", "end"}], "}"}], ",", 
   RowBox[{"AxesLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<x\>\"", ",", "\"\<y\>\""}], "}"}]}], ",", 
   RowBox[{
   "PlotLabel", "\[Rule]", 
    "\"\< Initial  \!\(\*SubscriptBox[\(E\), \(z\)]\)\>\""}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.5057521230416937`*^9, 3.505752201935205*^9}, {
   3.5057524208370037`*^9, 3.505752427332753*^9}, {3.50575249213585*^9, 
   3.5057525074963007`*^9}, {3.505752991588616*^9, 3.5057530104367657`*^9}, {
   3.506769148619233*^9, 3.506769161539134*^9}, {3.506769434217145*^9, 
   3.506769440366541*^9}, 3.50676948875165*^9, 3.506769543491067*^9, {
   3.507980015930944*^9, 3.507980018088922*^9}, 3.509703128056546*^9}],

Cell["\<\
For the first calculation we will take the initial magnetic field to be zero.\
\
\>", "Text",
 CellChangeTimes->{{3.509876226620611*^9, 3.5098762775867653`*^9}, {
   3.509876415800618*^9, 3.5098764159841747`*^9}, 3.511001068131461*^9, {
   3.514819482115467*^9, 3.5148194838473577`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"step", "=", ".2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EzData", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Eiz", "[", 
      RowBox[{"x", ",", "y"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"y", ",", 
       RowBox[{"-", "end"}], ",", "end", ",", "step"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"-", "end"}], ",", "end", ",", "step"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"HxData", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"y", ",", 
       RowBox[{"-", "end"}], ",", "end", ",", "step"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"-", "end"}], ",", "end", ",", "step"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"HyData", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"y", ",", 
       RowBox[{"-", "end"}], ",", "end", ",", "step"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"-", "end"}], ",", "end", ",", "step"}], "}"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.505752998892465*^9, 3.505753001234014*^9}, {
  3.505753054221788*^9, 3.505753072924966*^9}, {3.505753144001461*^9, 
  3.5057531694832497`*^9}, {3.505754426803995*^9, 3.505754429891822*^9}, {
  3.506767077141121*^9, 3.506767101829452*^9}, {3.511001058955989*^9, 
  3.511001060980633*^9}}],

Cell[BoxData[
 RowBox[{"ListPlot3D", "[", 
  RowBox[{"EzData", ",", 
   RowBox[{"AxesLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<x\>\"", ",", "\"\<y\>\""}], "}"}]}], ",", 
   RowBox[{
   "PlotLabel", "\[Rule]", 
    "\"\< Initial  \!\(\*SubscriptBox[\(E\), \(z\)]\)\>\""}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.505753076636759*^9, 3.5057531159339*^9}, 
   3.508780788567606*^9}],

Cell[TextData[{
 "It is expensive to  list plot a function that has a high degree of \
localization. Over most of the region the function is zero but we still have \
to plot those points. On a ",
 Cell[BoxData[
  FormBox[
   RowBox[{"100", "\[Cross]", "100"}], TraditionalForm]]],
 " mesh we need 10,000 points, much more than a  three-dimensional plot of a \
function would take. This costs both time and memory as the two calculations \
below show."
}], "Text",
 CellChangeTimes->{{3.5110923551050034`*^9, 3.511092404471139*^9}, {
   3.5110932365540333`*^9, 3.511093433551547*^9}, 3.514819485885194*^9, {
   3.517417342100973*^9, 3.517417347570565*^9}}],

Cell[BoxData[
 RowBox[{"memoryRatio", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"ByteCount", "[", 
     RowBox[{"ListPlot3D", "[", 
      RowBox[{"EzData", ",", 
       RowBox[{"AxesLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"\"\<x\>\"", ",", "\"\<y\>\""}], "}"}]}], ",", 
       RowBox[{
       "PlotLabel", "\[Rule]", 
        "\"\< Initial  \!\(\*SubscriptBox[\(E\), \(z\)]\)\>\""}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], "]"}], "/", 
    RowBox[{"ByteCount", "[", 
     RowBox[{"Plot3D", "[", 
      RowBox[{
       RowBox[{"Eiz", "[", 
        RowBox[{"x", ",", "y"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", 
         RowBox[{"-", "end"}], ",", "end"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"y", ",", 
         RowBox[{"-", "end"}], ",", "end"}], "}"}], ",", 
       RowBox[{"AxesLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"\"\<x\>\"", ",", "\"\<y\>\""}], "}"}]}], ",", 
       RowBox[{
       "PlotLabel", "\[Rule]", 
        "\"\< Initial  \!\(\*SubscriptBox[\(E\), \(z\)]\)\>\""}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], "]"}]}], "//", 
   "N"}]}]], "Input",
 CellChangeTimes->{{3.51109344477872*^9, 3.51109351814282*^9}}],

Cell[BoxData[
 RowBox[{"t1", "=", 
  RowBox[{"First", "[", 
   RowBox[{
    RowBox[{"ListPlot3D", "[", 
     RowBox[{"EzData", ",", 
      RowBox[{"AxesLabel", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"\"\<x\>\"", ",", "\"\<y\>\""}], "}"}]}], ",", 
      RowBox[{
      "PlotLabel", "\[Rule]", 
       "\"\< Initial  \!\(\*SubscriptBox[\(E\), \(z\)]\)\>\""}], ",", 
      RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], "//", "Timing"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.5110935323844967`*^9, 3.511093595145597*^9}, {
  3.511093628547233*^9, 3.5110936782822723`*^9}, {3.511093709604515*^9, 
  3.511093717613103*^9}}],

Cell[BoxData[
 RowBox[{"t2", "=", 
  RowBox[{"First", "[", 
   RowBox[{
    RowBox[{"Plot3D", "[", 
     RowBox[{
      RowBox[{"Eiz", "[", 
       RowBox[{"x", ",", "y"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", 
        RowBox[{"-", "end"}], ",", "end"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"y", ",", 
        RowBox[{"-", "end"}], ",", "end"}], "}"}], ",", 
      RowBox[{"AxesLabel", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"\"\<x\>\"", ",", "\"\<y\>\""}], "}"}]}], ",", 
      RowBox[{
      "PlotLabel", "\[Rule]", 
       "\"\< Initial  \!\(\*SubscriptBox[\(E\), \(z\)]\)\>\""}], ",", 
      RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], "//", "Timing"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.511093664625001*^9, 3.511093671514751*^9}, {
  3.5110937221181107`*^9, 3.5110937295660963`*^9}}],

Cell[BoxData[
 RowBox[{"timeRatio", "=", 
  RowBox[{"t1", "/", "t2"}]}]], "Input",
 CellChangeTimes->{{3.511093733812725*^9, 3.511093750822755*^9}}],

Cell[TextData[{
 "The list plot takes almost nine times as much memory and eight times more \
CPU time as using ",
 ButtonBox["Plot3D",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://reference.wolfram.com/mathematica/ref/Plot3D.html"], None},
  ButtonNote->"http://reference.wolfram.com/mathematica/ref/Plot3D.html"],
 ". So we should make an interpolating function. We can do this with the \
function ",
 ButtonBox["Interpolation",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://reference.wolfram.com/mathematica/ref/Interpolation.html"], 
    None},
  ButtonNote->
   "http://reference.wolfram.com/mathematica/ref/Interpolation.html"],
 ". In order to make an interpolating function we need the data in the form \
{{{x1,y1},f(x1,y1},{{x1,y2},f(x1,y2)},...}. To get the data into this form we \
first generate the grid. We only need to do this once for any given grid."
}], "Text",
 CellChangeTimes->{{3.511093770558483*^9, 3.5110938364711523`*^9}, {
  3.511109521119894*^9, 3.511109533478182*^9}, {3.511109623491892*^9, 
  3.511109809368718*^9}, {3.511109911855361*^9, 3.5111099328058567`*^9}, {
  3.511110312197987*^9, 3.5111103377737103`*^9}, {3.5174174644659653`*^9, 
  3.5174174937635107`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"grid", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", "y"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"y", ",", 
       RowBox[{"-", "end"}], ",", "end", ",", "step"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"-", "end"}], ",", "end", ",", "step"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.511109940097975*^9, 3.511109950384945*^9}}],

Cell[TextData[{
 "Next we use ",
 ButtonBox["Riffle",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://reference.wolfram.com/mathematica/ref/Riffle.html"], None},
  ButtonNote->"http://reference.wolfram.com/mathematica/ref/Riffle.html"],
 " to \[OpenCurlyDoubleQuote]riffle\[CloseCurlyDoubleQuote] the grid points \
and function values. This is easy to understand if we look at a couple of \
small symbolic lists. The first gives the grid coordinates"
}], "Text",
 CellChangeTimes->{{3.511110349878131*^9, 3.511110394927661*^9}, {
   3.511110785427034*^9, 3.511110842713004*^9}, 3.517417522115752*^9}],

Cell[BoxData[
 RowBox[{"coordinates", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"x", "[", "i", "]"}], ",", 
      RowBox[{"y", "[", "j", "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "3"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.5111104447965403`*^9, 3.511110532607791*^9}}],

Cell["\<\
while the second contains the function values.\
\>", "Text",
 CellChangeTimes->{{3.5111108478174343`*^9, 3.511110857450141*^9}}],

Cell[BoxData[
 RowBox[{"functionValues", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"g", "[", 
     RowBox[{
      RowBox[{"x", "[", "i", "]"}], ",", 
      RowBox[{"y", "[", "j", "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "3"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.511110537108756*^9, 3.511110586395935*^9}}],

Cell[TextData[{
 "We can pair them using ",
 ButtonBox["Riffle",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://reference.wolfram.com/mathematica/ref/Riffle.html"], None},
  ButtonNote->"http://reference.wolfram.com/mathematica/ref/Riffle.html"],
 "."
}], "Text",
 CellChangeTimes->{{3.511110869922263*^9, 3.511110877778591*^9}, 
   3.511110914076104*^9, {3.517417557104842*^9, 3.517417557106477*^9}}],

Cell[BoxData[
 RowBox[{"Riffle", "[", 
  RowBox[{"coordinates", ",", "functionValues"}], "]"}]], "Input",
 CellChangeTimes->{{3.511110398690259*^9, 3.511110437667471*^9}, {
  3.51111059427462*^9, 3.5111106083771563`*^9}}],

Cell["\<\
This pairs them, but to get them into the form required we need to transpose \
the matrix,\
\>", "Text",
 CellChangeTimes->{{3.511110923516398*^9, 3.511110983390895*^9}, 
   3.514819488662664*^9, {3.5174175691264057`*^9, 3.5174175746730347`*^9}}],

Cell[BoxData[
 RowBox[{"Transpose", "[", 
  RowBox[{"Riffle", "[", 
   RowBox[{"coordinates", ",", "functionValues"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.511110621847699*^9, 3.51111063048347*^9}}],

Cell["\<\
flatten it to the first level, and partition it into pairs.\
\>", "Text",
 CellChangeTimes->{{3.511110989043068*^9, 3.511111032499131*^9}, {
  3.5174175826932707`*^9, 3.5174175879145327`*^9}}],

Cell[BoxData[
 RowBox[{"Partition", "[", 
  RowBox[{
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Transpose", "[", 
      RowBox[{"Riffle", "[", 
       RowBox[{"coordinates", ",", "functionValues"}], "]"}], "]"}], ",", 
     "1"}], "]"}], ",", "2"}], "]"}]], "Input",
 CellChangeTimes->{{3.51111064826902*^9, 3.511110661315825*^9}}],

Cell["Putting this together gives", "Text",
 CellChangeTimes->{{3.51111104496146*^9, 3.511111054585623*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Ez", "=", 
   RowBox[{"Interpolation", "[", 
    RowBox[{"Partition", "[", 
     RowBox[{
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"Transpose", "[", 
         RowBox[{"Riffle", "[", 
          RowBox[{"grid", ",", "EzData"}], "]"}], "]"}], ",", "1"}], "]"}], 
      ",", "2"}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.511110055005125*^9, 3.511110082357058*^9}, {
  3.511110168577984*^9, 3.5111102158354473`*^9}}],

Cell["and it\[CloseCurlyQuote]s fast.", "Text",
 CellChangeTimes->{{3.511111066802141*^9, 3.511111076394846*^9}}],

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{"Interpolation", "[", 
   RowBox[{"Partition", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"Transpose", "[", 
        RowBox[{"Riffle", "[", 
         RowBox[{"grid", ",", "EzData"}], "]"}], "]"}], ",", "1"}], "]"}], 
     ",", "2"}], "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.511111086798058*^9, 3.511111091365388*^9}}],

Cell["Plotting it is also fast.", "Text",
 CellChangeTimes->{{3.511111145925511*^9, 3.511111150637231*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Plot3D", "[", 
   RowBox[{
    RowBox[{"Ez", "[", 
     RowBox[{"x", ",", "y"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", 
      RowBox[{"-", "end"}], ",", "end"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"y", ",", 
      RowBox[{"-", "end"}], ",", "end"}], "}"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], "//", 
  "Timing"}]], "Input",
 CellChangeTimes->{{3.511110086207671*^9, 3.5111101088702097`*^9}, {
  3.511110277797791*^9, 3.511110288845871*^9}, {3.5111111115667343`*^9, 
  3.511111139414359*^9}}],

Cell[TextData[{
 "This is because ",
 ButtonBox["Plot3D",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://reference.wolfram.com/mathematica/ref/Plot3D.html"], None},
  ButtonNote->"http://reference.wolfram.com/mathematica/ref/Plot3D.html"],
 " using an adaptive sampling scheme. You can see how this works by using the \
option Mesh->All. Notice that the mesh is coarse where the function changes \
slowly, and fine in regions were the function is rapidly changing."
}], "Text",
 CellChangeTimes->{{3.511111160143114*^9, 3.511111325206459*^9}, {
  3.5111115052536087`*^9, 3.5111115429568653`*^9}, {3.51741763216827*^9, 
  3.5174176366275187`*^9}, {3.51741767657885*^9, 3.51741767658055*^9}}],

Cell[BoxData[
 RowBox[{"Plot3D", "[", 
  RowBox[{
   RowBox[{"Ez", "[", 
    RowBox[{"x", ",", "y"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"-", "end"}], ",", "end"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"y", ",", 
     RowBox[{"-", "end"}], ",", "end"}], "}"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
   RowBox[{"Mesh", "\[Rule]", "All"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.5111112812384777`*^9, 3.511111283412837*^9}}],

Cell["\<\
With this technical matter under control we can return to the implementation \
of Yee\[CloseCurlyQuote]s method. Although we will soon change this we want \
to start with propagation in free space so we will take \[Epsilon] and \[Mu] \
to be one in our computational units. \
\>", "Text",
 CellChangeTimes->{{3.5098763634465027`*^9, 3.509876477922455*^9}, {
   3.5111115565756283`*^9, 3.51111159451921*^9}, {3.514819492342169*^9, 
   3.514819494513198*^9}, 3.517417700366159*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Epsilon]Data", " ", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Mu]", "=", "1"}], ";"}]}], "Input",
 CellChangeTimes->{{3.5057535521689177`*^9, 3.505753575519619*^9}, {
  3.505754190863312*^9, 3.505754195335453*^9}}],

Cell[TextData[{
 "We need to calculate partial derivatives in both ",
 Cell[BoxData[
  FormBox["x", TraditionalForm]]],
 " and ",
 Cell[BoxData[
  FormBox["y", TraditionalForm]]],
 " for both the ",
 Cell[BoxData[
  FormBox["E", TraditionalForm]]],
 " and ",
 Cell[BoxData[
  FormBox["H", TraditionalForm]]],
 " fields.We can do this with list rotation. To see this, consider a small \
test list."
}], "Text",
 CellChangeTimes->{{3.509876518381373*^9, 3.509876638633003*^9}, {
   3.509876671597994*^9, 3.509876680955378*^9}, {3.5098778020909243`*^9, 
   3.509877826424584*^9}, 3.5098969555877028`*^9, {3.517417710541808*^9, 
   3.517417716035359*^9}}],

Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{
  "a", ",", "b", ",", "c", ",", "d", ",", "e", ",", "f", ",", "g", ",", "h", 
   ",", "i"}], "]"}], "\n", 
 RowBox[{
  RowBox[{"testlist", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "c"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"d", ",", "e", ",", "f"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"g", ",", "h", ",", "i"}], "}"}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.5027088577546997`*^9, 3.502708857757111*^9}}],

Cell[BoxData["testlist"], "Input",
 CellChangeTimes->{{3.502708863273368*^9, 3.502708864837476*^9}}],

Cell["\<\
RotateRight[matrix,{0,1}] rotates the rows to the right. \
RotateLeft[matrix,{0,1}] rotates the rows to the left \
\>", "Text",
 CellChangeTimes->{{3.5098969843365173`*^9, 3.5098970276663733`*^9}, {
  3.5098970635174103`*^9, 3.509897109005488*^9}}],

Cell[BoxData[
 RowBox[{"RotateRight", "[", 
  RowBox[{"testlist", ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.502708909329294*^9, 3.502708930560267*^9}, {
  3.502708960769965*^9, 3.502708963041971*^9}, {3.5055798140797863`*^9, 
  3.505579837489964*^9}}],

Cell["so ", "Text",
 CellChangeTimes->{{3.5098971276143303`*^9, 3.509897128502165*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"RotateRight", "[", 
   RowBox[{"testlist", ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "1"}], "}"}]}], "]"}], "-", "testlist"}]], "Input",
 CellChangeTimes->{{3.509897152353991*^9, 3.50989715668075*^9}}],

Cell[TextData[{
 "gives us a derivative on ",
 Cell[BoxData[
  FormBox["x", TraditionalForm]]],
 " for the ",
 Cell[BoxData[
  FormBox["H", TraditionalForm]]],
 " field. The boundary points wrap around so we will have to impose boundary \
conditions unless we want periodic boundary conditions. Likewise \
RotateRight[matrix,{1,0}] will rotate the columns to the right so that "
}], "Text",
 CellChangeTimes->{{3.509897171135694*^9, 3.509897282052422*^9}, {
   3.509897881638628*^9, 3.509897935982078*^9}, 3.509900436513329*^9, 
   3.511111329174962*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"RotateRight", "[", 
   RowBox[{"testlist", ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "0"}], "}"}]}], "]"}], "-", "testlist"}]], "Input",
 CellChangeTimes->{{3.509877850355204*^9, 3.509877852601907*^9}, {
  3.509897939975519*^9, 3.5098979440873833`*^9}}],

Cell[TextData[{
 "gives the ",
 Cell[BoxData[
  FormBox["y", TraditionalForm]]],
 " derivative of the ",
 Cell[BoxData[
  FormBox["H", TraditionalForm]]],
 " field. For the ",
 Cell[BoxData[
  FormBox["E", TraditionalForm]]],
 " fields we want to use RotateLeft. The derivatives we need are thus"
}], "Text",
 CellChangeTimes->{{3.509897948622447*^9, 3.5098980259616413`*^9}, 
   3.517417755895718*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"dEx", "[", "data_List", "]"}], ":=", 
   RowBox[{
    RowBox[{"RotateLeft", "[", 
     RowBox[{"data", ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}]}], "]"}], "-", "data"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dHx", "[", "data_List", "]"}], ":=", 
   RowBox[{
    RowBox[{"RotateRight", "[", 
     RowBox[{"data", ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}]}], "]"}], "-", "data"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dEy", "[", "data_List", "]"}], ":=", 
   RowBox[{
    RowBox[{"RotateLeft", "[", 
     RowBox[{"data", ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "0"}], "}"}]}], "]"}], "-", "data"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dHy", "[", "data_List", "]"}], ":=", 
   RowBox[{
    RowBox[{"RotateRight", "[", 
     RowBox[{"data", ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "0"}], "}"}]}], "]"}], "-", "data"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.5057498011706038`*^9, 3.505749849361631*^9}, {
   3.5057510710246058`*^9, 3.50575111889257*^9}, 3.505751218913465*^9}],

Cell[TextData[{
 "If we assume that the boundaries of our grid are perfect conductors then we \
need ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["E", "z"], "=", "0"}], TraditionalForm]]],
 " at the boundaries. The values for the ",
 Cell[BoxData[
  FormBox["H", TraditionalForm]]],
 " are calculated from the surrounding ",
 Cell[BoxData[
  FormBox["E", TraditionalForm]]],
 " fields so we do not need to do anything to the ",
 Cell[BoxData[
  FormBox["H", TraditionalForm]]],
 " field at the boundaries. We will use ",
 ButtonBox["ReplacePart",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://reference.wolfram.com/mathematica/ref/ReplacePart.html"], 
    None},
  ButtonNote->"http://reference.wolfram.com/mathematica/ref/ReplacePart.html"],
 " to set ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["E", "z"], "=", "0"}], TraditionalForm]]],
 " at the boundaries. To see how to do this we will once again use a small \
test list."
}], "Text",
 CellChangeTimes->{{3.50886167232791*^9, 3.508861712744051*^9}, {
   3.5088618019156523`*^9, 3.5088618401808558`*^9}, {3.508862007853012*^9, 
   3.5088621122862053`*^9}, {3.508862286385057*^9, 3.5088623046476707`*^9}, {
   3.5088644832495127`*^9, 3.5088644832517967`*^9}, 3.509898182859023*^9, {
   3.509898369928384*^9, 3.509898381616304*^9}, {3.5098984278020973`*^9, 
   3.5098985224855137`*^9}, {3.5098997606314774`*^9, 
   3.5098998020237103`*^9}, {3.50989990629377*^9, 3.509899906691617*^9}, {
   3.511111340352393*^9, 3.5111113465123253`*^9}, {3.517417773073447*^9, 
   3.5174177818107758`*^9}}],

Cell[BoxData[
 RowBox[{"test", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"F", "[", 
     RowBox[{"i", ",", "j"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "10"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "1", ",", "10"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.509899910186445*^9, 3.509899933756722*^9}}],

Cell["\<\
The top and bottom rows are easy since they are just the first and last part \
of the list so we can do the job with\
\>", "Text",
 CellChangeTimes->{{3.509899952878975*^9, 3.5099000006392384`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"ydim", ",", "xdim"}], "}"}], "=", 
   RowBox[{"Dimensions", "[", "test", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zeros", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "xdim"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ReplacePart", "[", 
  RowBox[{"test", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"1", "\[Rule]", "zeros"}], ",", 
     RowBox[{"ydim", "\[Rule]", "zeros"}]}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.5099000048179283`*^9, 3.509900108605142*^9}, {
  3.509900220115946*^9, 3.509900245298794*^9}}],

Cell[TextData[{
 "We can pick out the rules for the left-hand column using ",
 ButtonBox["Map",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://reference.wolfram.com/mathematica/ref/Map.html"], None},
  ButtonNote->"http://reference.wolfram.com/mathematica/ref/Map.html"],
 " to map ",
 ButtonBox["Rule",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://reference.wolfram.com/mathematica/ref/Rule.html"], None},
  ButtonNote->"http://reference.wolfram.com/mathematica/ref/Rule.html"],
 " across a list of the positions of the elements in the left-hand column."
}], "Text",
 CellChangeTimes->{{3.509900376603541*^9, 3.509900521035736*^9}, {
  3.509900635821747*^9, 3.509900665163621*^9}, {3.5111113548398323`*^9, 
  3.511111357232057*^9}}],

Cell[BoxData[
 RowBox[{"Map", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Rule", "[", 
     RowBox[{"#", ",", "0"}], "]"}], "&"}], ",", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "ydim"}], "}"}]}], "]"}]}], "]"}]], "Input"],

Cell["We can get both the right-hand and left-hand columns with", "Text",
 CellChangeTimes->{{3.5099006826344852`*^9, 3.509900704794758*^9}, 
   3.511111358735656*^9}],

Cell[BoxData[
 RowBox[{"Flatten", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Rule", "[", 
        RowBox[{"#", ",", "0"}], "]"}], "&"}], ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"i", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "ydim"}], "}"}]}], "]"}]}], "]"}], ",", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Rule", "[", 
        RowBox[{"#", ",", "0"}], "]"}], "&"}], ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"i", ",", "xdim"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "ydim"}], "}"}]}], "]"}]}], "]"}]}], 
   "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.509900283334193*^9, 3.509900288269253*^9}, {
  3.5099003308633633`*^9, 3.509900333735021*^9}}],

Cell["\<\
and combine these with the row conditions in a list called bcRules.\
\>", "Text",
 CellChangeTimes->{{3.50990071936345*^9, 3.509900751316594*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"bcRules", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"1", "->", "zeros"}], ",", 
        RowBox[{"ydim", "\[Rule]", "zeros"}]}], "}"}], ",", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Rule", "[", 
          RowBox[{"#", ",", "0"}], "]"}], "&"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"i", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "ydim"}], "}"}]}], "]"}]}], "]"}], ",", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Rule", "[", 
          RowBox[{"#", ",", "0"}], "]"}], "&"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"i", ",", "xdim"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "ydim"}], "}"}]}], "]"}]}], "]"}]}], 
     "}"}], "]"}]}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{3.509900759705291*^9}],

Cell["Then ", "Text",
 CellChangeTimes->{{3.509900774767126*^9, 3.509900777029578*^9}}],

Cell[BoxData[
 RowBox[{"ReplacePart", "[", 
  RowBox[{"test", ",", "bcRules"}], "]"}]], "Input",
 CellChangeTimes->{{3.509900782030587*^9, 3.509900798103827*^9}}],

Cell["does the job.", "Text",
 CellChangeTimes->{{3.509900803150608*^9, 3.5099008065268393`*^9}}],

Cell["\<\
So, for the case at hand we want:\
\>", "Text",
 CellChangeTimes->{{3.5099008639173727`*^9, 3.509900886658066*^9}, 
   3.509900924500881*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"ydim", ",", "xdim"}], "}"}], "=", 
   RowBox[{"Dimensions", "[", "EzData", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zeros", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "xdim"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bcRules", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"1", "->", "zeros"}], ",", 
        RowBox[{"ydim", "\[Rule]", "zeros"}]}], "}"}], ",", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Rule", "[", 
          RowBox[{"#", ",", "0"}], "]"}], "&"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"i", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "ydim"}], "}"}]}], "]"}]}], "]"}], ",", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Rule", "[", 
          RowBox[{"#", ",", "0"}], "]"}], "&"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"i", ",", "xdim"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "ydim"}], "}"}]}], "]"}]}], "]"}]}], 
     "}"}], "]"}]}], ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.50886554022398*^9, 3.508865557034132*^9}, {
   3.508866403610352*^9, 3.508866425575334*^9}, 3.5088664712247963`*^9, 
   3.509208561109467*^9, {3.509900128056034*^9, 3.509900145640869*^9}}],

Cell["\<\
We can now initialize the fields.\
\>", "Text",
 CellChangeTimes->{{3.509900928395897*^9, 3.509900960349267*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"EzField", ",", "HxField", ",", "HyField"}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"EzField", "=", "EzData"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"HxField", "=", "HxData"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"HyField", "=", "HyData"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"grid", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", "y"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"y", ",", 
       RowBox[{"-", "end"}], ",", "end", ",", "step"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"-", "end"}], ",", "end", ",", "step"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Epsilon]Data", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Mu]", "=", "1"}], ";"}]}], "Input",
 CellChangeTimes->{{3.505753523580099*^9, 3.5057535451936693`*^9}, {
   3.5057535842763643`*^9, 3.505753608385667*^9}, {3.505753978349527*^9, 
   3.505754019020842*^9}, {3.505754058886512*^9, 3.505754168425652*^9}, {
   3.505754210202883*^9, 3.5057542528977633`*^9}, {3.505754371143311*^9, 
   3.505754372942779*^9}, 3.50575624318289*^9, {3.509901198897147*^9, 
   3.509901211160039*^9}, {3.511111669019904*^9, 3.5111116694923983`*^9}}],

Cell[TextData[{
 "The rest of the code is straight forward. Notice that we have applied the \
boundary conditions to the ",
 Cell[BoxData[
  FormBox["E", TraditionalForm]]],
 " field before we calculate the ",
 Cell[BoxData[
  FormBox["H", TraditionalForm]]],
 " field. Otherwise we will use the wrong values of ",
 Cell[BoxData[
  FormBox["E", TraditionalForm]]],
 " at the boundaries in calculating the adjacent values of ",
 Cell[BoxData[
  FormBox["H", TraditionalForm]]],
 ". The code propagates the ",
 Cell[BoxData[
  FormBox["E", TraditionalForm]]],
 " and ",
 Cell[BoxData[
  FormBox["H", TraditionalForm]]],
 " fields for 360 time steps or about ",
 Cell[BoxData[
  FormBox[
   RowBox[{"1.2", " ", 
    SuperscriptBox["10", 
     RowBox[{"-", "7"}]], " ", "seconds"}], TraditionalForm]]],
 ". Every 30 iterations we plot the fields. We see the initial ",
 Cell[BoxData[
  FormBox["E", TraditionalForm]]],
 " field propagating out spherically. The time varying ",
 Cell[BoxData[
  FormBox["E", TraditionalForm]]],
 " field creates a magnetic field, and after the fields hit the conducting \
walls we see the interference patterns due to the reflection. We also see \
that the magnitudes of the ",
 Cell[BoxData[
  FormBox["E", TraditionalForm]]],
 " and ",
 Cell[BoxData[
  FormBox["H", TraditionalForm]]],
 " fields are the same which they should be since in our units ",
 Cell[BoxData[
  FormBox[
   RowBox[{"c", "=", "1"}], TraditionalForm]]],
 "."
}], "Text",
 CellChangeTimes->{{3.509119623288081*^9, 3.509119627427456*^9}, {
   3.5099009859748077`*^9, 3.509901100579587*^9}, {3.5099013734788303`*^9, 
   3.5099014406800222`*^9}, {3.509958859392054*^9, 3.50995886671739*^9}, {
   3.509958913984676*^9, 3.509959110447068*^9}, {3.5099591479829893`*^9, 
   3.509959154776956*^9}, {3.509960345143652*^9, 3.509960398572289*^9}, {
   3.511111698357666*^9, 3.51111180202423*^9}, 3.5148194999161177`*^9, 
   3.51741782413706*^9}],

Cell[BoxData[
 RowBox[{"\n", 
  StyleBox["  ",
   FontColor->GrayLevel[0]], 
  RowBox[{
   StyleBox["ListAnimate",
    FontColor->GrayLevel[0]], 
   StyleBox["[",
    FontColor->GrayLevel[0]], 
   StyleBox["\n",
    FontColor->GrayLevel[0]], 
   StyleBox["\t",
    FontColor->GrayLevel[0]], 
   RowBox[{
    StyleBox["Table",
     FontColor->GrayLevel[0]], 
    StyleBox["[",
     FontColor->GrayLevel[0]], 
    RowBox[{
     RowBox[{
      StyleBox[
       RowBox[{"Do", "[", "\n", "\t", 
        RowBox[{
         RowBox[{
          RowBox[{"EzField", "=", 
           RowBox[{"EzField", "-", 
            RowBox[{
             RowBox[{"1", "/", 
              RowBox[{"(", 
               RowBox[{"2", "\[Epsilon]Data"}], ")"}]}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"dHx", "[", "HyField", "]"}], "-", 
               RowBox[{"dHy", "[", "HxField", "]"}]}], ")"}]}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"EzField", "=", 
           RowBox[{"ReplacePart", "[", 
            RowBox[{"EzField", ",", "bcRules"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"HxField", "=", 
           RowBox[{"HxField", "-", 
            RowBox[{
             RowBox[{"1", "/", 
              RowBox[{"(", 
               RowBox[{"2", "\[Epsilon]Data"}], ")"}]}], 
             RowBox[{"dEy", "[", "EzField", "]"}]}]}]}], ";", " ", "\n", "\t", 
          RowBox[{"HyField", "=", 
           RowBox[{"HyField", "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"1", "/", "2"}], "\[Mu]"}], ")"}], 
             RowBox[{"dEx", "[", "EzField", "]"}]}]}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "30"}], "}"}]}], "]"}],
       FontColor->GrayLevel[0]], 
      StyleBox[";",
       FontColor->GrayLevel[0]], 
      StyleBox["\[IndentingNewLine]",
       FontColor->GrayLevel[0]], 
      RowBox[{"Ez", "=", 
       RowBox[{"Interpolation", "[", 
        RowBox[{"Partition", "[", 
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"Transpose", "[", 
             RowBox[{"Riffle", "[", 
              RowBox[{"grid", ",", "EzField"}], "]"}], "]"}], ",", "1"}], 
           "]"}], ",", "2"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Hx", "=", 
       RowBox[{"Interpolation", "[", 
        RowBox[{"Partition", "[", 
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"Transpose", "[", 
             RowBox[{"Riffle", "[", 
              RowBox[{"grid", ",", "HxField"}], "]"}], "]"}], ",", "1"}], 
           "]"}], ",", "2"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Hy", "=", 
       RowBox[{"Interpolation", "[", 
        RowBox[{"Partition", "[", 
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"Transpose", "[", 
             RowBox[{"Riffle", "[", 
              RowBox[{"grid", ",", "HyField"}], "]"}], "]"}], ",", "1"}], 
           "]"}], ",", "2"}], "]"}], "]"}]}], ";", 
      StyleBox["\t",
       FontColor->GrayLevel[0]], 
      StyleBox["\n",
       FontColor->GrayLevel[0]], 
      StyleBox["\t\t",
       FontColor->GrayLevel[0]], 
      RowBox[{
       StyleBox["GraphicsGrid",
        FontColor->GrayLevel[0]], 
       StyleBox["[",
        FontColor->GrayLevel[0]], 
       RowBox[{
        RowBox[{
         StyleBox["{",
          FontColor->GrayLevel[0]], 
         RowBox[{
          StyleBox["{",
           FontColor->GrayLevel[0]], 
          RowBox[{
           StyleBox[
            RowBox[{"Plot3D", "[", 
             RowBox[{
              RowBox[{"Ez", "[", 
               RowBox[{"x", ",", "y"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", 
                RowBox[{"-", "end"}], ",", "end"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"y", ",", 
                RowBox[{"-", "end"}], ",", "end"}], "}"}], ",", "\n", "\t\t", 
              
              RowBox[{"PlotRange", "->", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "1"}], ",", "1"}], "}"}]}], ",", 
              RowBox[{"AxesLabel", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"\"\<x\>\"", ",", "\"\<y\>\""}], "}"}]}], ",", 
              RowBox[{
              "PlotLabel", "\[Rule]", 
               "\"\<\!\(\*SubscriptBox[\(E\), \(z\)]\)\>\""}]}], "]"}],
            FontColor->GrayLevel[0]], 
           StyleBox[",",
            FontColor->GrayLevel[0]], 
           RowBox[{
            StyleBox["Plot3D",
             FontColor->GrayLevel[0]], 
            StyleBox["[",
             FontColor->GrayLevel[0]], 
            RowBox[{
             StyleBox[
              RowBox[{"Hx", "[", 
               RowBox[{"x", ",", "y"}], "]"}],
              FontColor->GrayLevel[0]], ",", 
             RowBox[{"{", 
              RowBox[{"x", ",", 
               RowBox[{"-", "end"}], ",", "end"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"y", ",", 
               RowBox[{"-", "end"}], ",", "end"}], "}"}], ",", 
             StyleBox["\n",
              FontColor->GrayLevel[0]], 
             StyleBox["\t\t",
              FontColor->GrayLevel[0]], 
             StyleBox[
              RowBox[{"PlotRange", "->", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "1"}], ",", "1"}], "}"}]}],
              FontColor->GrayLevel[0]], 
             StyleBox[",",
              FontColor->GrayLevel[0]], 
             StyleBox[
              RowBox[{"AxesLabel", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"\"\<x\>\"", ",", "\"\<y\>\""}], "}"}]}],
              FontColor->GrayLevel[0]], 
             StyleBox[",",
              FontColor->GrayLevel[0]], 
             RowBox[{
             "PlotLabel", "\[Rule]", 
              "\"\<\!\(\*SubscriptBox[\(H\), \(x\)]\)\>\""}]}], 
            StyleBox["]",
             FontColor->GrayLevel[0]]}], 
           StyleBox[",",
            FontColor->GrayLevel[0]], 
           RowBox[{
            StyleBox["Plot3D",
             FontColor->GrayLevel[0]], 
            StyleBox["[",
             FontColor->GrayLevel[0]], 
            RowBox[{
             StyleBox[
              RowBox[{"Hy", "[", 
               RowBox[{"x", ",", "y"}], "]"}],
              FontColor->GrayLevel[0]], 
             StyleBox[",",
              FontColor->GrayLevel[0]], 
             RowBox[{"{", 
              RowBox[{"x", ",", 
               RowBox[{"-", "end"}], ",", "end"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"y", ",", 
               RowBox[{"-", "end"}], ",", "end"}], "}"}], ",", 
             StyleBox["\n",
              FontColor->GrayLevel[0]], 
             StyleBox["\t\t",
              FontColor->GrayLevel[0]], 
             StyleBox[
              RowBox[{"PlotRange", "->", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "1"}], ",", "1"}], "}"}]}],
              FontColor->GrayLevel[0]], 
             StyleBox[",",
              FontColor->GrayLevel[0]], 
             StyleBox[
              RowBox[{"AxesLabel", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"\"\<x\>\"", ",", "\"\<y\>\""}], "}"}]}],
              FontColor->GrayLevel[0]], 
             StyleBox[",",
              FontColor->GrayLevel[0]], 
             RowBox[{
             "PlotLabel", "\[Rule]", 
              "\"\<\!\(\*SubscriptBox[\(H\), \(y\)]\)\>\""}]}], 
            StyleBox["]",
             FontColor->GrayLevel[0]]}]}], 
          StyleBox["}",
           FontColor->GrayLevel[0]]}], 
         StyleBox["}",
          FontColor->GrayLevel[0]]}], 
        StyleBox[",",
         FontColor->GrayLevel[0]], 
        RowBox[{
         StyleBox["ImageSize",
          FontColor->GrayLevel[0]], 
         StyleBox["\[Rule]",
          FontColor->GrayLevel[0]], 
         RowBox[{"14", " ", "72"}]}]}], 
       StyleBox["]",
        FontColor->GrayLevel[0]]}]}], 
     StyleBox[",",
      FontColor->GrayLevel[0]], 
     StyleBox["\n",
      FontColor->GrayLevel[0]], 
     StyleBox["\t\t\t\t",
      FontColor->GrayLevel[0]], 
     StyleBox[
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "12"}], "}"}],
      FontColor->GrayLevel[0]]}], 
    StyleBox["]",
     FontColor->GrayLevel[0]]}], 
   StyleBox["]",
    FontColor->GrayLevel[0]]}]}]], "Input",
 CellChangeTimes->{{3.505753523580099*^9, 3.5057535451936693`*^9}, {
   3.5057535842763643`*^9, 3.505753608385667*^9}, {3.505753978349527*^9, 
   3.505754019020842*^9}, {3.505754058886512*^9, 3.505754168425652*^9}, 
   3.505754210202883*^9, {3.505754300446177*^9, 3.505754310326633*^9}, {
   3.5057543446956873`*^9, 3.505754348543817*^9}, {3.505754459329159*^9, 
   3.505754468289999*^9}, {3.505754510574546*^9, 3.505754588799971*^9}, {
   3.5057554533379383`*^9, 3.505755460841097*^9}, {3.5057555954513597`*^9, 
   3.5057556907108917`*^9}, {3.505756048726425*^9, 3.505756062164536*^9}, {
   3.5057560967522907`*^9, 3.505756164777659*^9}, {3.5067670121988153`*^9, 
   3.506767019077784*^9}, {3.50676712802658*^9, 3.5067671324101257`*^9}, {
   3.5067689468654823`*^9, 3.506768998246044*^9}, {3.508780880732251*^9, 
   3.508780882895463*^9}, {3.508781054363818*^9, 3.508781063342471*^9}, {
   3.508781265862714*^9, 3.50878127637449*^9}, 3.508781742858724*^9, 
   3.50878177427666*^9, {3.508865503701082*^9, 3.50886551302852*^9}, {
   3.5088655714144983`*^9, 3.508865574232623*^9}, {3.508866368502858*^9, 
   3.508866385969014*^9}, {3.508866505179741*^9, 3.5088665105482607`*^9}, 
   3.508867862900256*^9, {3.509119577812677*^9, 3.509119677118533*^9}, {
   3.509119709280386*^9, 3.509119745161584*^9}, {3.5091197810586767`*^9, 
   3.509119797818968*^9}, {3.5091866913289537`*^9, 3.509186710982306*^9}, {
   3.50918699666588*^9, 3.5091870794046297`*^9}, 3.509187556200564*^9, 
   3.509901386421377*^9, {3.509901550334175*^9, 3.509901574885149*^9}, {
   3.509903930763525*^9, 3.50990394004135*^9}, {3.509904568333515*^9, 
   3.509904581533366*^9}, {3.509904695576486*^9, 3.509904701967868*^9}, 
   3.509904832512319*^9, {3.511111970807561*^9, 3.511112026490683*^9}, {
   3.5111120806226187`*^9, 3.511112157459868*^9}, {3.511112194149576*^9, 
   3.511112214678259*^9}}],

Cell[TextData[{
 "The results look right, but are they? One way we can check them is to make \
sure that energy is conserved. The energy density of an electromagnetic field \
is ",
 Cell[BoxData[
  FormBox[
   RowBox[{"u", "=", 
    RowBox[{
     FractionBox["1", "2"], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        StyleBox["E",
         FontWeight->"Bold"], "\[CenterDot]", 
        StyleBox["D",
         FontWeight->"Bold"]}], "+", 
       RowBox[{
        StyleBox["B",
         FontWeight->"Bold"], "\[CenterDot]", 
        StyleBox["H",
         FontWeight->"Bold"]}]}], ")"}]}]}], TraditionalForm]]],
 " which for our case reduces to ",
 Cell[BoxData[
  FormBox[
   RowBox[{"u", "=", 
    RowBox[{
     FractionBox["1", "2"], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SubscriptBox["\[Epsilon]", "0"], 
        RowBox[{
         StyleBox["E",
          FontWeight->"Bold"], "\[CenterDot]", 
         StyleBox["E",
          FontWeight->"Bold"]}]}], "+", 
       RowBox[{
        SubscriptBox["\[Mu]", "0"], 
        StyleBox[
         RowBox[{"H", "\[CenterDot]", "H"}],
         FontWeight->"Bold"]}]}], ")"}]}]}], TraditionalForm]]],
 ". It is easy enough to compute the energy as a function of time. We just \
compute the dot products and then sum the result over the grid. We can use ",
 ButtonBox["Apply",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://reference.wolfram.com/mathematica/ref/Apply.html"], None},
  ButtonNote->"http://reference.wolfram.com/mathematica/ref/Apply.html"],
 " to change the head the list to ",
 ButtonBox["Plus",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://reference.wolfram.com/mathematica/ref/Plus.html"], None},
  ButtonNote->"http://reference.wolfram.com/mathematica/ref/Plus.html"],
 " which will do the sum for us. To see how this works consider a \
one-dimensional list."
}], "Text",
 CellChangeTimes->{{3.5099591892432404`*^9, 3.509959202818625*^9}, {
  3.5099592368118668`*^9, 3.50995925666057*^9}, {3.509959324353627*^9, 
  3.509959348339959*^9}, {3.5099601223652*^9, 3.509960203747389*^9}, {
  3.5099604208993073`*^9, 3.50996046743048*^9}, {3.5099605058229437`*^9, 
  3.509960571394272*^9}, {3.509960684230154*^9, 3.509960793816955*^9}, {
  3.509960846217589*^9, 3.5099608948050947`*^9}, {3.517419658500766*^9, 
  3.517419667346887*^9}}],

Cell[BoxData[
 RowBox[{"test", "=", 
  RowBox[{"Table", "[", 
   RowBox[{"i", ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "10"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.509960897834632*^9, 3.50996090707589*^9}}],

Cell[TextData[{
 "This list has the ",
 ButtonBox["Head",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://reference.wolfram.com/mathematica/ref/Head.html"], None},
  ButtonNote->"http://reference.wolfram.com/mathematica/ref/Head.html"],
 " of ",
 ButtonBox["List",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://reference.wolfram.com/mathematica/ref/List.html"], None},
  ButtonNote->"http://reference.wolfram.com/mathematica/ref/List.html"],
 " but we can change the head to ",
 ButtonBox["Plus",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://reference.wolfram.com/mathematica/ref/Plus.html"], None},
  ButtonNote->"http://reference.wolfram.com/mathematica/ref/Plus.html"],
 " which will sum the numbers."
}], "Text",
 CellChangeTimes->{{3.50996091346309*^9, 3.509960983785952*^9}, {
  3.5099610606746893`*^9, 3.509961060675931*^9}, {3.517419703454857*^9, 
  3.5174197178657923`*^9}}],

Cell[BoxData[
 RowBox[{"Apply", "[", 
  RowBox[{"Plus", ",", "test"}], "]"}]], "Input",
 CellChangeTimes->{{3.509961123594164*^9, 3.509961127935164*^9}}],

Cell["\<\
If we have a two-dimensional list such as\
\>", "Text",
 CellChangeTimes->{{3.509961140152143*^9, 3.509961163751602*^9}, {
  3.5099612060350237`*^9, 3.509961211857576*^9}, {3.509961325830607*^9, 
  3.509961332982239*^9}, {3.517419820992426*^9, 3.5174198212938757`*^9}}],

Cell[BoxData[
 RowBox[{"test", "=", 
  RowBox[{"Table", "[", 
   RowBox[{"i", ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "10"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "1", ",", "10"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.5099612169069242`*^9, 3.509961233580493*^9}}],

Cell[TextData[{
 "then using ",
 ButtonBox["Apply",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://reference.wolfram.com/mathematica/ref/Apply.html"], None},
  ButtonNote->"http://reference.wolfram.com/mathematica/ref/Apply.html"],
 " as we did before will sum each row"
}], "Text",
 CellChangeTimes->{{3.509961414109212*^9, 3.509961432666252*^9}, {
  3.517419815113963*^9, 3.517419815115695*^9}}],

Cell[BoxData[
 RowBox[{"Apply", "[", 
  RowBox[{"Plus", ",", "test"}], "]"}]], "Input"],

Cell[TextData[{
 "but we can sum the whole list by using ",
 ButtonBox["Apply",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://reference.wolfram.com/mathematica/ref/Apply.html"], None},
  ButtonNote->"http://reference.wolfram.com/mathematica/ref/Apply.html"],
 " at both the zero level (which is the head) of our expression and the first \
level."
}], "Text",
 CellChangeTimes->{{3.509961442610732*^9, 3.509961501989202*^9}, {
  3.517419746937236*^9, 3.517419746938971*^9}}],

Cell[BoxData[
 RowBox[{"Apply", "[", 
  RowBox[{"Plus", ",", "test", ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.509961255134151*^9, 3.509961288173732*^9}}],

Cell[TextData[{
 "We initialize the variable energy to an empty list, compute the energy \
every ten steps and append the result to energy. This gives us a 36 element \
list with the energies at ",
 Cell[BoxData[
  FormBox[
   RowBox[{"3.3", " ", 
    SuperscriptBox["10", 
     RowBox[{"-", "9"}]], "second", " "}], TraditionalForm]]],
 "intervals. The ",
 ButtonBox["Evaluate",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://reference.wolfram.com/mathematica/ref/Evaluate.html"], None},
  ButtonNote->"http://reference.wolfram.com/mathematica/ref/Evaluate.html"],
 " wrapped around the sum of the field components causes the sum of the \
square to be evaluated before the head of the list is changed. Leaving the ",
 ButtonBox["Evaluate",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://reference.wolfram.com/mathematica/ref/Evaluate.html"], None},
  ButtonNote->"http://reference.wolfram.com/mathematica/ref/Evaluate.html"],
 " out will produce a different result."
}], "Text",
 CellChangeTimes->{{3.509961555871297*^9, 3.509961594712655*^9}, {
   3.509961625162541*^9, 3.5099617396944227`*^9}, {3.509962230857464*^9, 
   3.509962356982978*^9}, 3.511111364624881*^9, {3.517419779387229*^9, 
   3.517419790647653*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"energy", "=", 
   RowBox[{"{", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.509727377772006*^9, 3.509727383769186*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Epsilon]Data", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Mu]", "=", "1"}], ";"}]}], "Input",
 CellChangeTimes->{{3.5097282756783123`*^9, 3.509728285005185*^9}, {
  3.509961763754529*^9, 3.5099617734487247`*^9}}],

Cell[BoxData[
 RowBox[{"\n", 
  RowBox[{
   RowBox[{
    RowBox[{"Clear", "[", 
     RowBox[{"EzField", ",", "HxField", ",", "HyField"}], "]"}], ";"}], "\n", 
   
   RowBox[{
    RowBox[{"EzField", "=", "EzData"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"HxField", "=", "HxData"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"HyField", "=", "HyData"}], ";"}], "\[IndentingNewLine]", 
   StyleBox["\t",
    FontColor->GrayLevel[0]], 
   RowBox[{
    StyleBox["Do",
     FontColor->GrayLevel[0]], 
    StyleBox["[",
     FontColor->GrayLevel[0]], 
    RowBox[{
     RowBox[{
      StyleBox["Do",
       FontColor->GrayLevel[0]], 
      StyleBox["[",
       FontColor->GrayLevel[0]], 
      StyleBox["\n",
       FontColor->GrayLevel[0]], 
      StyleBox["\t",
       FontColor->GrayLevel[0]], 
      RowBox[{
       RowBox[{
        StyleBox[
         RowBox[{"EzField", "=", 
          RowBox[{"EzField", "-", 
           RowBox[{
            RowBox[{"1", "/", 
             RowBox[{"(", 
              RowBox[{"2", "\[Epsilon]Data"}], ")"}]}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"dHx", "[", "HyField", "]"}], "-", 
              RowBox[{"dHy", "[", "HxField", "]"}]}], ")"}]}]}]}],
         FontColor->GrayLevel[0]], 
        StyleBox[";",
         FontColor->GrayLevel[0]], 
        StyleBox["\[IndentingNewLine]",
         FontColor->GrayLevel[0]], 
        StyleBox[
         RowBox[{"EzField", "=", 
          RowBox[{"ReplacePart", "[", 
           RowBox[{"EzField", ",", "bcRules"}], "]"}]}],
         FontColor->GrayLevel[0]], 
        StyleBox[";",
         FontColor->GrayLevel[0]], 
        StyleBox["\[IndentingNewLine]",
         FontColor->GrayLevel[0]], 
        StyleBox[
         RowBox[{"HxField", "=", 
          RowBox[{"HxField", "-", 
           RowBox[{
            RowBox[{"1", "/", 
             RowBox[{"(", 
              RowBox[{"2", "\[Epsilon]Data"}], ")"}]}], 
            RowBox[{"dEy", "[", "EzField", "]"}]}]}]}],
         FontColor->GrayLevel[0]], 
        StyleBox[";",
         FontColor->GrayLevel[0]], 
        StyleBox[" ",
         FontColor->GrayLevel[0]], 
        StyleBox["\n",
         FontColor->GrayLevel[0]], 
        StyleBox["\t",
         FontColor->GrayLevel[0]], 
        StyleBox[
         RowBox[{"HyField", "=", 
          RowBox[{"HyField", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"1", "/", "2"}], "\[Mu]"}], ")"}], 
            RowBox[{"dEx", "[", "EzField", "]"}]}]}]}],
         FontColor->GrayLevel[0]], 
        StyleBox[";",
         FontColor->GrayLevel[0]], 
        StyleBox["\[IndentingNewLine]",
         FontColor->GrayLevel[0]], 
        RowBox[{
         StyleBox["AppendTo",
          FontColor->GrayLevel[0]], 
         StyleBox["[",
          FontColor->GrayLevel[0]], 
         RowBox[{
          StyleBox["energy",
           FontColor->GrayLevel[0]], 
          StyleBox[",",
           FontColor->GrayLevel[0]], 
          RowBox[{"Apply", "[", 
           RowBox[{"Plus", ",", 
            RowBox[{"Evaluate", "[", 
             RowBox[{
              SuperscriptBox["EzField", "2"], 
              StyleBox["+",
               FontColor->GrayLevel[0]], 
              SuperscriptBox["HxField", "2"], 
              StyleBox["+",
               FontColor->GrayLevel[0]], 
              SuperscriptBox["HyField", "2"]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}]}], "]"}]}], "]"}]}], 
       StyleBox[",",
        FontColor->GrayLevel[0]], 
       StyleBox[
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "10"}], "}"}],
        FontColor->GrayLevel[0]]}], 
      StyleBox["]",
       FontColor->GrayLevel[0]]}], 
     StyleBox[",",
      FontColor->GrayLevel[0]], 
     StyleBox["\n",
      FontColor->GrayLevel[0]], 
     StyleBox["\t\t\t\t",
      FontColor->GrayLevel[0]], 
     StyleBox[
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "36"}], "}"}],
      FontColor->GrayLevel[0]]}], 
    StyleBox["]",
     FontColor->GrayLevel[0]]}]}]}]], "Input",
 CellChangeTimes->{{3.505753523580099*^9, 3.5057535451936693`*^9}, {
   3.5057535842763643`*^9, 3.505753608385667*^9}, {3.505753978349527*^9, 
   3.505754019020842*^9}, {3.505754058886512*^9, 3.505754168425652*^9}, 
   3.505754210202883*^9, {3.505754300446177*^9, 3.505754310326633*^9}, {
   3.5057543446956873`*^9, 3.505754348543817*^9}, {3.505754459329159*^9, 
   3.505754468289999*^9}, {3.505754510574546*^9, 3.505754588799971*^9}, {
   3.5057554533379383`*^9, 3.505755460841097*^9}, {3.5057555954513597`*^9, 
   3.5057556907108917`*^9}, {3.505756048726425*^9, 3.505756062164536*^9}, {
   3.5057560967522907`*^9, 3.505756164777659*^9}, {3.5067670121988153`*^9, 
   3.506767019077784*^9}, {3.50676712802658*^9, 3.5067671324101257`*^9}, {
   3.5067689468654823`*^9, 3.506768998246044*^9}, {3.508780880732251*^9, 
   3.508780882895463*^9}, {3.508781054363818*^9, 3.508781063342471*^9}, {
   3.508781265862714*^9, 3.50878127637449*^9}, 3.508781742858724*^9, 
   3.50878177427666*^9, {3.508865503701082*^9, 3.50886551302852*^9}, {
   3.5088655714144983`*^9, 3.508865574232623*^9}, {3.508866368502858*^9, 
   3.508866385969014*^9}, {3.508866505179741*^9, 3.5088665105482607`*^9}, 
   3.508867862900256*^9, {3.509119577812677*^9, 3.509119677118533*^9}, {
   3.509119709280386*^9, 3.509119745161584*^9}, {3.5091197810586767`*^9, 
   3.509119797818968*^9}, {3.5091866913289537`*^9, 3.509186710982306*^9}, {
   3.50918699666588*^9, 3.5091870794046297`*^9}, 3.509187556200564*^9, {
   3.509723879423277*^9, 3.509723941791388*^9}, {3.5097241644396677`*^9, 
   3.509724190327477*^9}, {3.509724970520851*^9, 3.509724970822894*^9}, {
   3.509725269924142*^9, 3.509725275875288*^9}, {3.5097260222978277`*^9, 
   3.5097260308843317`*^9}, {3.50972724876187*^9, 3.509727369918684*^9}, {
   3.509727796207693*^9, 3.509727826337422*^9}, {3.509728294884921*^9, 
   3.509728301402458*^9}, {3.509728376100568*^9, 3.509728389573044*^9}, {
   3.509961518366252*^9, 3.509961544092141*^9}, {3.5099616177431*^9, 
   3.509961619678748*^9}, {3.509962213543639*^9, 3.5099622194627657`*^9}, {
   3.509962458682139*^9, 3.5099624589519157`*^9}, 3.509962648241568*^9, {
   3.509962696473547*^9, 3.509962699297171*^9}}],

Cell["\<\
Plotting the list shows that we do pretty well, although we do have a few \
percent variation.\
\>", "Text",
 CellChangeTimes->{{3.509962764351067*^9, 3.509962829496929*^9}, 
   3.517419844930745*^9}],

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{
   RowBox[{"energy", "/", 
    RowBox[{"energy", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], ",", 
   RowBox[{
   "PlotLabel", "\[Rule]", "\"\<E/\!\(\*SubscriptBox[\(E\), \(0\)]\)\>\""}], 
   ",", 
   RowBox[{"AxesLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
     "\"\<t\>\"", ",", "\"\<E/\!\(\*SubscriptBox[\(E\), \(0\)]\)\>\""}], 
     "}"}]}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.5099618727504063`*^9, 3.509961973113523*^9}, {
  3.509962779273447*^9, 3.509962785841325*^9}}],

Cell[TextData[{
 "We can do better if we use a large grid. If we set the step size to 0.1 we \
will have a ",
 Cell[BoxData[
  FormBox[
   RowBox[{"201", "\[Cross]", "201"}], TraditionalForm]]],
 " grid. The necessary code is bundled below."
}], "Text",
 CellChangeTimes->{{3.5099631161271667`*^9, 3.5099631173330727`*^9}, {
   3.509963571336067*^9, 3.509963683086526*^9}, 3.5174198694014387`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"step", "=", "0.1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EzData", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Eiz", "[", 
      RowBox[{"x", ",", "y"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"y", ",", 
       RowBox[{"-", "end"}], ",", "end", ",", "step"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"-", "end"}], ",", "end", ",", "step"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"HxData", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"y", ",", 
       RowBox[{"-", "end"}], ",", "end", ",", "step"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"-", "end"}], ",", "end", ",", "step"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"HyData", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"y", ",", 
       RowBox[{"-", "end"}], ",", "end", ",", "step"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"-", "end"}], ",", "end", ",", "step"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"ydim", ",", "xdim"}], "}"}], "=", 
   RowBox[{"Dimensions", "[", "EzData", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zeros", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "xdim"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bcRules", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"1", "->", "zeros"}], ",", 
        RowBox[{"ydim", "\[Rule]", "zeros"}]}], "}"}], ",", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Rule", "[", 
          RowBox[{"#", ",", "0"}], "]"}], "&"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"i", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "ydim"}], "}"}]}], "]"}]}], "]"}], ",", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Rule", "[", 
          RowBox[{"#", ",", "0"}], "]"}], "&"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"i", ",", "xdim"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "ydim"}], "}"}]}], "]"}]}], "]"}]}], 
     "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"EzField", ",", "HxField", ",", "HyField"}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"EzField", "=", "EzData"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"HxField", "=", "HxData"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"HyField", "=", "HyData"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Epsilon]Data", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Mu]", "=", "1"}], ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.505752998892465*^9, 3.505753001234014*^9}, {
  3.505753054221788*^9, 3.505753072924966*^9}, {3.505753144001461*^9, 
  3.5057531694832497`*^9}, {3.505754426803995*^9, 3.505754429891822*^9}, {
  3.506767077141121*^9, 3.506767101829452*^9}, {3.50996314591398*^9, 
  3.50996318894068*^9}}],

Cell[BoxData[
 RowBox[{"\n", 
  RowBox[{
   RowBox[{
    RowBox[{"Clear", "[", 
     RowBox[{"EzField", ",", "HxField", ",", "HyField"}], "]"}], ";"}], "\n", 
   
   RowBox[{
    RowBox[{"energy", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"EzField", "=", "EzData"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"HxField", "=", "HxData"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"HyField", "=", "HyData"}], ";"}], "\[IndentingNewLine]", 
   StyleBox["\t",
    FontColor->GrayLevel[0]], 
   RowBox[{
    StyleBox["Do",
     FontColor->GrayLevel[0]], 
    StyleBox["[",
     FontColor->GrayLevel[0]], 
    RowBox[{
     RowBox[{
      StyleBox["Do",
       FontColor->GrayLevel[0]], 
      StyleBox["[",
       FontColor->GrayLevel[0]], 
      StyleBox["\n",
       FontColor->GrayLevel[0]], 
      StyleBox["\t",
       FontColor->GrayLevel[0]], 
      RowBox[{
       RowBox[{
        StyleBox[
         RowBox[{"EzField", "=", 
          RowBox[{"EzField", "-", 
           RowBox[{
            RowBox[{"1", "/", 
             RowBox[{"(", 
              RowBox[{"2", "\[Epsilon]Data"}], ")"}]}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"dHx", "[", "HyField", "]"}], "-", 
              RowBox[{"dHy", "[", "HxField", "]"}]}], ")"}]}]}]}],
         FontColor->GrayLevel[0]], 
        StyleBox[";",
         FontColor->GrayLevel[0]], 
        StyleBox["\[IndentingNewLine]",
         FontColor->GrayLevel[0]], 
        StyleBox[
         RowBox[{"EzField", "=", 
          RowBox[{"ReplacePart", "[", 
           RowBox[{"EzField", ",", "bcRules"}], "]"}]}],
         FontColor->GrayLevel[0]], 
        StyleBox[";",
         FontColor->GrayLevel[0]], 
        StyleBox["\[IndentingNewLine]",
         FontColor->GrayLevel[0]], 
        StyleBox[
         RowBox[{"HxField", "=", 
          RowBox[{"HxField", "-", 
           RowBox[{
            RowBox[{"1", "/", 
             RowBox[{"(", 
              RowBox[{"2", "\[Epsilon]Data"}], ")"}]}], 
            RowBox[{"dEy", "[", "EzField", "]"}]}]}]}],
         FontColor->GrayLevel[0]], 
        StyleBox[";",
         FontColor->GrayLevel[0]], 
        StyleBox[" ",
         FontColor->GrayLevel[0]], 
        StyleBox["\n",
         FontColor->GrayLevel[0]], 
        StyleBox["\t",
         FontColor->GrayLevel[0]], 
        StyleBox[
         RowBox[{"HyField", "=", 
          RowBox[{"HyField", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"1", "/", "2"}], "\[Mu]"}], ")"}], 
            RowBox[{"dEx", "[", "EzField", "]"}]}]}]}],
         FontColor->GrayLevel[0]], 
        StyleBox[";",
         FontColor->GrayLevel[0]], 
        StyleBox["\[IndentingNewLine]",
         FontColor->GrayLevel[0]], 
        RowBox[{
         StyleBox["AppendTo",
          FontColor->GrayLevel[0]], 
         StyleBox["[",
          FontColor->GrayLevel[0]], 
         RowBox[{
          StyleBox["energy",
           FontColor->GrayLevel[0]], 
          StyleBox[",",
           FontColor->GrayLevel[0]], 
          RowBox[{"Apply", "[", 
           RowBox[{"Plus", ",", 
            RowBox[{"Evaluate", "[", 
             RowBox[{
              SuperscriptBox["EzField", "2"], 
              StyleBox["+",
               FontColor->GrayLevel[0]], 
              SuperscriptBox["HxField", "2"], 
              StyleBox["+",
               FontColor->GrayLevel[0]], 
              SuperscriptBox["HyField", "2"]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}]}], "]"}]}], "]"}]}], 
       StyleBox[",",
        FontColor->GrayLevel[0]], 
       StyleBox[
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "10"}], "}"}],
        FontColor->GrayLevel[0]]}], 
      StyleBox["]",
       FontColor->GrayLevel[0]]}], 
     StyleBox[",",
      FontColor->GrayLevel[0]], 
     StyleBox["\n",
      FontColor->GrayLevel[0]], 
     StyleBox["\t\t\t\t",
      FontColor->GrayLevel[0]], 
     StyleBox[
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "36"}], "}"}],
      FontColor->GrayLevel[0]]}], 
    StyleBox["]",
     FontColor->GrayLevel[0]]}]}]}]], "Input",
 CellChangeTimes->{{3.505753523580099*^9, 3.5057535451936693`*^9}, {
   3.5057535842763643`*^9, 3.505753608385667*^9}, {3.505753978349527*^9, 
   3.505754019020842*^9}, {3.505754058886512*^9, 3.505754168425652*^9}, 
   3.505754210202883*^9, {3.505754300446177*^9, 3.505754310326633*^9}, {
   3.5057543446956873`*^9, 3.505754348543817*^9}, {3.505754459329159*^9, 
   3.505754468289999*^9}, {3.505754510574546*^9, 3.505754588799971*^9}, {
   3.5057554533379383`*^9, 3.505755460841097*^9}, {3.5057555954513597`*^9, 
   3.5057556907108917`*^9}, {3.505756048726425*^9, 3.505756062164536*^9}, {
   3.5057560967522907`*^9, 3.505756164777659*^9}, {3.5067670121988153`*^9, 
   3.506767019077784*^9}, {3.50676712802658*^9, 3.5067671324101257`*^9}, {
   3.5067689468654823`*^9, 3.506768998246044*^9}, {3.508780880732251*^9, 
   3.508780882895463*^9}, {3.508781054363818*^9, 3.508781063342471*^9}, {
   3.508781265862714*^9, 3.50878127637449*^9}, 3.508781742858724*^9, 
   3.50878177427666*^9, {3.508865503701082*^9, 3.50886551302852*^9}, {
   3.5088655714144983`*^9, 3.508865574232623*^9}, {3.508866368502858*^9, 
   3.508866385969014*^9}, {3.508866505179741*^9, 3.5088665105482607`*^9}, 
   3.508867862900256*^9, {3.509119577812677*^9, 3.509119677118533*^9}, {
   3.509119709280386*^9, 3.509119745161584*^9}, {3.5091197810586767`*^9, 
   3.509119797818968*^9}, {3.5091866913289537`*^9, 3.509186710982306*^9}, {
   3.50918699666588*^9, 3.5091870794046297`*^9}, 3.509187556200564*^9, {
   3.509723879423277*^9, 3.509723941791388*^9}, {3.5097241644396677`*^9, 
   3.509724190327477*^9}, {3.509724970520851*^9, 3.509724970822894*^9}, {
   3.509725269924142*^9, 3.509725275875288*^9}, {3.5097260222978277`*^9, 
   3.5097260308843317`*^9}, {3.50972724876187*^9, 3.509727369918684*^9}, {
   3.509727796207693*^9, 3.509727826337422*^9}, {3.509728294884921*^9, 
   3.509728301402458*^9}, {3.509728376100568*^9, 3.509728389573044*^9}, {
   3.509961518366252*^9, 3.509961544092141*^9}, {3.5099616177431*^9, 
   3.509961619678748*^9}, {3.509962213543639*^9, 3.5099622194627657`*^9}, {
   3.509962458682139*^9, 3.5099624589519157`*^9}, 3.509962648241568*^9, {
   3.509962696473547*^9, 3.509962699297171*^9}, {3.509963234493444*^9, 
   3.5099632449820633`*^9}}],

Cell["\<\
You can see that we do better. However, tt takes four times as long to \
compute.\
\>", "Text",
 CellChangeTimes->{{3.509963688498768*^9, 3.5099637099396753`*^9}, {
  3.51741988354361*^9, 3.517419899983059*^9}}],

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{
   RowBox[{"energy", "/", 
    RowBox[{"energy", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], ",", 
   RowBox[{
   "PlotLabel", "\[Rule]", 
    "\"\<E/\!\(\*SubscriptBox[\(E\), \(0\)]\), grid size of \
201\[Cross]201\>\""}], ",", 
   RowBox[{"AxesLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
     "\"\<t\>\"", ",", "\"\<E/\!\(\*SubscriptBox[\(E\), \(0\)]\)\>\""}], 
     "}"}]}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.5099618727504063`*^9, 3.509961973113523*^9}, {
  3.509962779273447*^9, 3.509962785841325*^9}, {3.509963524534809*^9, 
  3.509963553216084*^9}}],

Cell["\<\
Of course propagation in a vacuum is not very interesting. Suppose we scatter \
off a dielectric material. The first step is to build our dielectric. We want \
our dielectric to scale properly if the grid size is changed so we will \
define a variable called scale which will be one if the step size is 0.1. \
\>", "Text",
 CellChangeTimes->{{3.509963813016869*^9, 3.509963908739644*^9}, 
   3.509980404633358*^9, {3.509980493709078*^9, 3.509980589615408*^9}}],

Cell[BoxData[{
 RowBox[{"Clear", "[", "step", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"scale", "=", 
   RowBox[{"step", "/", "0.1"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"step", "=", "0.2"}], ";"}]}], "Input",
 CellChangeTimes->{{3.5097033848531427`*^9, 3.509703405192213*^9}, {
  3.5099804539248323`*^9, 3.509980482324025*^9}}],

Cell[TextData[{
 "The list \[Epsilon]Data assigns a value for \[Epsilon] at each point on our \
grid. The ",
 ButtonBox["If",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://reference.wolfram.com/mathematica/ref/If.html"], None},
  ButtonNote->"http://reference.wolfram.com/mathematica/ref/If.html"],
 " statement below creates two rectangles with ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Epsilon]", "=", "25"}], TraditionalForm]]],
 ". These rectangles are shown in white in the figure below. They are 10 grid \
points thick by 25 grid points long so they are slightly smaller than the \
wavelength of the wave in the free space example. Since the index of \
refraction ",
 Cell[BoxData[
  FormBox[
   RowBox[{"n", "=", 
    SqrtBox[
     RowBox[{"\[Mu]", " ", "\[Epsilon]"}]]}], TraditionalForm]]],
 ", this corresponds to a material with an index of refraction of ",
 Cell[BoxData[
  FormBox[
   RowBox[{"n", "=", "5"}], TraditionalForm]]],
 "."
}], "Text",
 CellChangeTimes->{{3.50998064394282*^9, 3.5099806958032093`*^9}, {
  3.509980768073063*^9, 3.50998088541866*^9}, {3.509980928004681*^9, 
  3.509981041385449*^9}, {3.50998120381137*^9, 3.509981316396822*^9}, {
  3.517419941078156*^9, 3.5174199891412983`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Epsilon]Data", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"100", "/", "scale"}], "<", "y", "<", 
         RowBox[{"120", "/", "scale"}]}], "&&", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"30", "/", "scale"}], "<", "x", "<", 
           RowBox[{"80", "/", "scale"}]}], "||", 
          RowBox[{
           RowBox[{"120", "/", "scale"}], "<", "x", "<", 
           RowBox[{"170", "/", "scale"}]}]}], ")"}]}], ",", "25", ",", "1"}], 
      "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"y", ",", "0", ",", 
       RowBox[{"200", "/", "scale"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "0", ",", 
       RowBox[{"200", "/", "scale"}], ",", "1"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.509208148827074*^9, 3.509208334418618*^9}, 
   3.50920854140302*^9, {3.5097034106670713`*^9, 3.509703437038974*^9}, {
   3.509703473148785*^9, 3.509703480386951*^9}, 3.509980609643449*^9, 
   3.509980857948872*^9}],

Cell[BoxData[
 RowBox[{"ListDensityPlot", "[", "\[Epsilon]Data", "]"}]], "Input",
 CellChangeTimes->{{3.50886738770982*^9, 3.508867396904076*^9}, {
  3.508867467882638*^9, 3.5088674747453537`*^9}, {3.5091191171694736`*^9, 
  3.509119120352024*^9}, {3.509208285968575*^9, 3.5092082934236403`*^9}}],

Cell["", "Text",
 CellChangeTimes->{{3.509982680898354*^9, 3.509982695049481*^9}}],

Cell[TextData[{
 "For this example we want a wave that travels in the positive x direction. \
We can insure this by specifying an initial ",
 Cell[BoxData[
  FormBox["H", TraditionalForm]]],
 " field. This determines ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"\[PartialD]", 
      SubscriptBox["E", "z"]}], "/", 
     RowBox[{"\[PartialD]", "t"}]}], 
    SubscriptBox["\[VerticalSeparator]", 
     RowBox[{"t", "=", "0"}]]}], TraditionalForm]]],
 " since ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"\[PartialD]", 
      StyleBox["D",
       FontWeight->"Bold"]}], "/", 
     RowBox[{"\[PartialD]", "t"}]}], "="}], TraditionalForm]]],
 " \[Del]\[Cross]",
 StyleBox["H",
  FontWeight->"Bold"],
 ".  We will use Gaussians for both the initial ",
 Cell[BoxData[
  FormBox["E", TraditionalForm]]],
 " and ",
 Cell[BoxData[
  FormBox["H", TraditionalForm]]],
 " fields."
}], "Text",
 CellChangeTimes->{{3.509981504196361*^9, 3.509981792474648*^9}, {
   3.50998188876344*^9, 3.509981915107032*^9}, 3.509982037371498*^9, {
   3.509982136789295*^9, 3.509982266185238*^9}, 3.511111374145504*^9, {
   3.511111469396236*^9, 3.511111471627243*^9}, {3.5174200212781467`*^9, 
   3.5174200212782793`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{Cell[""], 
   RowBox[{"Clear", "[", 
    RowBox[{
    "Eiz", ",", "Hix", ",", "EzField", ",", "HxField", ",", "HyField"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Eiz", "[", 
    RowBox[{"x_", ",", "y_"}], "]"}], "=", " ", 
   RowBox[{"Exp", "[", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", "x", ")"}], 
         RowBox[{"2", " "}]], "+", 
        SuperscriptBox[
         RowBox[{"(", "y", ")"}], "2"]}], ")"}]}], "/", "5"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Hix", "[", 
     RowBox[{"x_", ",", "y_"}], "]"}], "=", " ", 
    RowBox[{"Exp", "[", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", "x", ")"}], 
          RowBox[{"2", " "}]], "+", 
         SuperscriptBox[
          RowBox[{"(", "y", ")"}], "2"]}], ")"}]}], "/", "5"}], "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"EzData", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Eiz", "[", 
      RowBox[{"x", ",", "y"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"y", ",", 
       RowBox[{"-", "end"}], ",", "end", ",", "step"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"-", "end"}], ",", "end", ",", "step"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"HxData", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Hix", "[", 
      RowBox[{"x", ",", "y"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"y", ",", 
       RowBox[{"-", "end"}], ",", "end", ",", "step"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"-", "end"}], ",", "end", ",", "step"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"HyData", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"y", ",", 
       RowBox[{"-", "end"}], ",", "end", ",", "step"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"-", "end"}], ",", "end", ",", "step"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EzField", "=", "EzData"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"HxField", "=", "HxData"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"HyField", "=", "HyData"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"grid", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", "y"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"y", ",", 
       RowBox[{"-", "end"}], ",", "end", ",", "step"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"-", "end"}], ",", "end", ",", "step"}], "}"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.505753523580099*^9, 3.5057535451936693`*^9}, {
   3.5057535842763643`*^9, 3.505753608385667*^9}, {3.505753978349527*^9, 
   3.505754019020842*^9}, {3.505754058886512*^9, 3.505754168425652*^9}, {
   3.505754210202883*^9, 3.5057542528977633`*^9}, {3.505754371143311*^9, 
   3.505754372942779*^9}, 3.50575624318289*^9, {3.509981442838191*^9, 
   3.509981469566308*^9}, {3.5099822438563023`*^9, 3.509982245700882*^9}, {
   3.5099822845032043`*^9, 3.509982333922612*^9}, {3.5111124020251837`*^9, 
   3.511112402481289*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"zeros", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "EzData", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"ydim", ",", "xdim"}], "}"}], "=", 
   RowBox[{"Dimensions", "[", "EzData", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bcRules", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"1", "->", "zeros"}], ",", 
        RowBox[{"ydim", "\[Rule]", "zeros"}]}], "}"}], ",", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Rule", "[", 
          RowBox[{"#", ",", "0"}], "]"}], "&"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"i", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "ydim"}], "}"}]}], "]"}]}], "]"}], ",", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Rule", "[", 
          RowBox[{"#", ",", "0"}], "]"}], "&"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"i", ",", "xdim"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "ydim"}], "}"}]}], "]"}]}], "]"}]}], 
     "}"}], "]"}]}], ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.50886554022398*^9, 3.508865557034132*^9}, {
   3.508866403610352*^9, 3.508866425575334*^9}, 3.5088664712247963`*^9, 
   3.509208561109467*^9}],

Cell[TextData[{
 "The code below is essentially the same as before except that only the ",
 Cell[BoxData[
  FormBox[
   RowBox[{"E", " "}], TraditionalForm]]],
 "field has been plotted and we are plotting the intensity (square of the \
field) not the field. We will want to show the grating on the same plot so we \
will plot the grating first and then use ",
 ButtonBox["Show",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://reference.wolfram.com/mathematica/ref/Show.html"], None},
  ButtonNote->"http://reference.wolfram.com/mathematica/ref/Show.html"],
 " to combine the plot of the intensity and the plot of the grating. While we \
are at it, we should compute the energy as a check."
}], "Text",
 CellChangeTimes->{{3.509982359137656*^9, 3.5099824293752937`*^9}, {
   3.509982502347575*^9, 3.5099825269800053`*^9}, {3.509982702169952*^9, 
   3.5099827818535633`*^9}, {3.509982863738016*^9, 3.509982889721492*^9}, 
   3.511111396969819*^9, {3.517420047093617*^9, 3.517420119707604*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"grating", "=", 
   RowBox[{"Interpolation", "[", 
    RowBox[{"Partition", "[", 
     RowBox[{
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"Transpose", "[", 
         RowBox[{"Riffle", "[", 
          RowBox[{"grid", ",", 
           RowBox[{"\[Epsilon]Data", "-", "1"}]}], "]"}], "]"}], ",", "1"}], 
       "]"}], ",", "2"}], "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"gratingPlot", "=", 
   RowBox[{"Plot3D", "[", 
    RowBox[{
     RowBox[{"grating", "[", 
      RowBox[{"x", ",", "y"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"-", "end"}], ",", "end"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"y", ",", 
       RowBox[{"-", "end"}], ",", "end"}], "}"}], ",", 
     RowBox[{"PlotStyle", "->", 
      RowBox[{"Opacity", "[", ".3", "]"}]}], ",", 
     RowBox[{"Mesh", "\[Rule]", "None"}], ",", 
     RowBox[{"Axes", "\[Rule]", "None"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.51111252382213*^9, 3.511112549398037*^9}, 
   3.5111127482544518`*^9}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.509119623288081*^9, 3.509119627427456*^9}}],

Cell[BoxData[
 RowBox[{"\n", 
  StyleBox["  ",
   FontColor->GrayLevel[0]], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"energy", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Mu]", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Clear", "[", 
     RowBox[{"EzField", ",", "HxField", ",", "HyField"}], "]"}], ";"}], "\n", 
   
   RowBox[{
    RowBox[{"EzField", "=", "EzData"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"HxField", "=", "HxData"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"HyField", "=", "HyData"}], ";"}], "\[IndentingNewLine]", "  ", 
   RowBox[{"ListAnimate", "[", "\n", "\t", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Do", "[", "\n", "\t", 
        RowBox[{
         RowBox[{
          RowBox[{"EzField", "=", 
           RowBox[{"EzField", "-", 
            RowBox[{
             RowBox[{"1", "/", 
              RowBox[{"(", 
               RowBox[{"2", "\[Epsilon]Data"}], ")"}]}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"dHx", "[", "HyField", "]"}], "-", 
               RowBox[{"dHy", "[", "HxField", "]"}]}], ")"}]}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"EzField", "=", 
           RowBox[{"ReplacePart", "[", 
            RowBox[{"EzField", ",", "bcRules"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"HxField", "=", 
           RowBox[{"HxField", "-", 
            RowBox[{
             RowBox[{"1", "/", 
              RowBox[{"(", 
               RowBox[{"2", "\[Epsilon]Data"}], ")"}]}], 
             RowBox[{"dEy", "[", "EzField", "]"}]}]}]}], ";", " ", "\n", "\t", 
          RowBox[{"HyField", "=", 
           RowBox[{"HyField", "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"1", "/", "2"}], "\[Mu]"}], ")"}], 
             RowBox[{"dEx", "[", "EzField", "]"}]}]}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "5"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Ez", "=", 
        RowBox[{"Interpolation", "[", 
         RowBox[{"Partition", "[", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{
             RowBox[{"Transpose", "[", 
              RowBox[{"Riffle", "[", 
               RowBox[{"grid", ",", "EzField"}], "]"}], "]"}], ",", "1"}], 
            "]"}], ",", "2"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        StyleBox["AppendTo",
         FontColor->GrayLevel[0]], 
        StyleBox["[",
         FontColor->GrayLevel[0]], 
        RowBox[{
         StyleBox["energy",
          FontColor->GrayLevel[0]], 
         StyleBox[",",
          FontColor->GrayLevel[0]], 
         RowBox[{"Apply", "[", 
          RowBox[{"Plus", ",", 
           RowBox[{"Evaluate", "[", " ", 
            RowBox[{
             RowBox[{"\[Epsilon]Data", " ", 
              SuperscriptBox["EzField", "2"]}], 
             StyleBox["+",
              FontColor->GrayLevel[0]], 
             RowBox[{
              StyleBox["\[Mu]",
               FontColor->GrayLevel[0]], 
              StyleBox[" ",
               FontColor->GrayLevel[0]], 
              RowBox[{
               StyleBox["(",
                FontColor->GrayLevel[0]], 
               RowBox[{
                SuperscriptBox["HxField", "2"], 
                StyleBox["+",
                 FontColor->GrayLevel[0]], 
                SuperscriptBox["HyField", "2"]}], ")"}]}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}]}], "]"}]}], "]"}], ";", "\t", "\n",
        "\t", 
       RowBox[{"Show", "[", 
        RowBox[{
         RowBox[{"Plot3D", "[", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"Ez", "[", 
             RowBox[{"x", ",", "y"}], "]"}], "2"], 
           StyleBox[",",
            FontColor->GrayLevel[0]], 
           StyleBox[
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{"-", "end"}], ",", "end"}], "}"}],
            FontColor->GrayLevel[0]], 
           StyleBox[",",
            FontColor->GrayLevel[0]], 
           StyleBox[
            RowBox[{"{", 
             RowBox[{"y", ",", 
              RowBox[{"-", "end"}], ",", "end"}], "}"}],
            FontColor->GrayLevel[0]], 
           StyleBox[",",
            FontColor->GrayLevel[0]], 
           StyleBox["\n",
            FontColor->GrayLevel[0]], 
           StyleBox["\t\t",
            FontColor->GrayLevel[0]], 
           StyleBox[
            RowBox[{"PlotRange", "->", 
             RowBox[{"{", 
              RowBox[{"0", ",", "1"}], "}"}]}],
            FontColor->GrayLevel[0]], 
           StyleBox[",",
            FontColor->GrayLevel[0]], 
           StyleBox[
            RowBox[{"AxesLabel", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"\"\<x\>\"", ",", "\"\<y\>\""}], "}"}]}],
            FontColor->GrayLevel[0]], 
           StyleBox[",",
            FontColor->GrayLevel[0]], 
           StyleBox[
            RowBox[{
            "PlotLabel", "\[Rule]", 
             "\"\<\!\(\*SubscriptBox[\(E\), \(z\)]\)\>\""}],
            FontColor->GrayLevel[0]]}], 
          StyleBox["]",
           FontColor->GrayLevel[0]]}], 
         StyleBox[",",
          FontColor->GrayLevel[0]], 
         StyleBox["gratingPlot",
          FontColor->GrayLevel[0]]}], 
        StyleBox["]",
         FontColor->GrayLevel[0]]}]}], 
      StyleBox[",",
       FontColor->GrayLevel[0]], 
      StyleBox["\n",
       FontColor->GrayLevel[0]], 
      StyleBox["\t\t\t\t",
       FontColor->GrayLevel[0]], 
      StyleBox[
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "24"}], "}"}],
       FontColor->GrayLevel[0]]}], 
     StyleBox["]",
      FontColor->GrayLevel[0]]}], 
    StyleBox["]",
     FontColor->GrayLevel[0]]}]}]}]], "Input",
 CellChangeTimes->{{3.505753523580099*^9, 3.5057535451936693`*^9}, {
   3.5057535842763643`*^9, 3.505753608385667*^9}, {3.505753978349527*^9, 
   3.505754019020842*^9}, {3.505754058886512*^9, 3.505754168425652*^9}, 
   3.505754210202883*^9, {3.505754300446177*^9, 3.505754310326633*^9}, {
   3.5057543446956873`*^9, 3.505754348543817*^9}, {3.505754459329159*^9, 
   3.505754468289999*^9}, {3.505754510574546*^9, 3.505754588799971*^9}, {
   3.5057554533379383`*^9, 3.505755460841097*^9}, {3.5057555954513597`*^9, 
   3.5057556907108917`*^9}, {3.505756048726425*^9, 3.505756062164536*^9}, {
   3.5057560967522907`*^9, 3.505756164777659*^9}, {3.5067670121988153`*^9, 
   3.506767019077784*^9}, {3.50676712802658*^9, 3.5067671324101257`*^9}, {
   3.5067689468654823`*^9, 3.506768998246044*^9}, {3.508780880732251*^9, 
   3.508780882895463*^9}, {3.508781054363818*^9, 3.508781063342471*^9}, {
   3.508781265862714*^9, 3.50878127637449*^9}, 3.508781742858724*^9, 
   3.50878177427666*^9, {3.508865503701082*^9, 3.50886551302852*^9}, {
   3.5088655714144983`*^9, 3.508865574232623*^9}, {3.508866368502858*^9, 
   3.508866385969014*^9}, {3.508866505179741*^9, 3.5088665105482607`*^9}, 
   3.508867862900256*^9, {3.509119577812677*^9, 3.509119677118533*^9}, {
   3.509119709280386*^9, 3.509119745161584*^9}, {3.5091197810586767`*^9, 
   3.509119797818968*^9}, {3.5091866913289537`*^9, 3.509186710982306*^9}, {
   3.50918699666588*^9, 3.5091870794046297`*^9}, 3.509187556200564*^9, 
   3.509982507619714*^9, {3.5099829345625267`*^9, 3.509982939809218*^9}, {
   3.509982979636065*^9, 3.50998301614046*^9}, {3.511112435480913*^9, 
   3.5111124968992968`*^9}, {3.51111263580221*^9, 3.511112636400531*^9}}],

Cell[TextData[{
 "The results look reasonable, notice how slowly the wave penetrates the \
region where the index of refraction is high. Part of the wave is reflected \
from the ",
 Cell[BoxData[
  FormBox[
   RowBox[{"n", "=", "5"}], TraditionalForm]]],
 " region, and the part that passes through the dielectric slits diffracts as \
we would expect. Plotting the energy shows that we do pretty well."
}], "Text",
 CellChangeTimes->{{3.5099833027294292`*^9, 3.509983313633813*^9}, {
   3.5099834095268087`*^9, 3.509983490306587*^9}, {3.509983558181078*^9, 
   3.509983694016925*^9}, 3.5174201463804693`*^9}],

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{
   RowBox[{"energy", "/", 
    RowBox[{"energy", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], ",", 
   RowBox[{
   "PlotLabel", "\[Rule]", 
    "\"\<E/\!\(\*SubscriptBox[\(E\), \(0\)]\), grid size of \
101\[Cross]101\>\""}], ",", 
   RowBox[{"AxesLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
     "\"\<t\>\"", ",", "\"\<E/\!\(\*SubscriptBox[\(E\), \(0\)]\)\>\""}], 
     "}"}]}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.509983199376863*^9, 3.5099832016476917`*^9}}],

Cell["\<\
As a last example let\[CloseCurlyQuote]s look at a wave scattering off a \
square. We make the square in the same way that we made the dielectric \
barriers.\
\>", "Text",
 CellChangeTimes->{{3.509987136128606*^9, 3.509987155968247*^9}, {
  3.5112550520395117`*^9, 3.511255088062274*^9}}],

Cell[BoxData[{
 RowBox[{"Clear", "[", "step", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"scale", "=", 
   RowBox[{"step", "/", "0.1"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"step", "=", "0.2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"end", "=", "10.0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"grid", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", "y"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"y", ",", 
       RowBox[{"-", "end"}], ",", "end", ",", "step"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"-", "end"}], ",", "end", ",", "step"}], "}"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{
  3.509987873366802*^9, 3.51033260094201*^9, 3.5111129389011707`*^9, {
   3.5111130074006767`*^9, 3.5111130080012093`*^9}, 3.511113208953162*^9, {
   3.511274515895767*^9, 3.511274522512581*^9}, {3.51127461918777*^9, 
   3.5112746208752623`*^9}, 3.511275629707499*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Epsilon]Data", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"120", "/", "scale"}], "<", "y", "<", 
         RowBox[{"160", "/", "scale"}]}], "&&", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"80", "/", "scale"}], "<", "x", "<", 
          RowBox[{"120", "/", "scale"}]}], ")"}]}], ",", "5", ",", "1"}], 
      "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"y", ",", "0", ",", 
       RowBox[{"200", "/", "scale"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "0", ",", 
       RowBox[{"200", "/", "scale"}], ",", "1"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{
  3.5099872274797792`*^9, {3.509987310840828*^9, 3.509987368371091*^9}, 
   3.511275694207301*^9}],

Cell[BoxData[
 RowBox[{"ListContourPlot", "[", 
  RowBox[{"\[Epsilon]Data", ",", 
   RowBox[{"FrameLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<x\>\"", ",", "\"\<y\>\""}], "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.5099871758274508`*^9, 3.509987194026476*^9}, {
  3.5099872751740522`*^9, 3.5099872990149612`*^9}}],

Cell["\<\
The rest of the code is the same as before.\
\>", "Text",
 CellChangeTimes->{{3.511255092454543*^9, 3.511255103998839*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"grating", "=", 
   RowBox[{"Interpolation", "[", 
    RowBox[{"Partition", "[", 
     RowBox[{
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"Transpose", "[", 
         RowBox[{"Riffle", "[", 
          RowBox[{"grid", ",", 
           RowBox[{"\[Epsilon]Data", "-", "1"}]}], "]"}], "]"}], ",", "1"}], 
       "]"}], ",", "2"}], "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"gratingPlot", "=", 
   RowBox[{"Plot3D", "[", 
    RowBox[{
     RowBox[{"grating", "[", 
      RowBox[{"x", ",", "y"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"-", "end"}], ",", "end"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"y", ",", 
       RowBox[{"-", "end"}], ",", "end"}], "}"}], ",", 
     RowBox[{"PlotStyle", "->", 
      RowBox[{"Opacity", "[", ".3", "]"}]}], ",", 
     RowBox[{"Mesh", "\[Rule]", "None"}], ",", 
     RowBox[{"Axes", "\[Rule]", "None"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{
  3.5097248204298*^9, {3.509982562535264*^9, 3.509982583833061*^9}, {
   3.509982646097871*^9, 3.5099826599617443`*^9}, 3.509982787048353*^9, {
   3.5099874809263887`*^9, 3.5099874845826283`*^9}, 3.511112773290361*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"dEx", "[", "data_List", "]"}], ":=", 
   RowBox[{
    RowBox[{"RotateLeft", "[", 
     RowBox[{"data", ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}]}], "]"}], "-", "data"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dHx", "[", "data_List", "]"}], ":=", 
   RowBox[{
    RowBox[{"RotateRight", "[", 
     RowBox[{"data", ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}]}], "]"}], "-", "data"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dEy", "[", "data_List", "]"}], ":=", 
   RowBox[{
    RowBox[{"RotateLeft", "[", 
     RowBox[{"data", ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "0"}], "}"}]}], "]"}], "-", "data"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dHy", "[", "data_List", "]"}], ":=", 
   RowBox[{
    RowBox[{"RotateRight", "[", 
     RowBox[{"data", ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "0"}], "}"}]}], "]"}], "-", "data"}]}], 
  ";"}]}], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{
   "Eiz", ",", "Hix", ",", "EzField", ",", "HxField", ",", "HyField"}], "]"}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Eiz", "[", 
    RowBox[{"x_", ",", "y_"}], "]"}], "=", " ", 
   RowBox[{"Exp", "[", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", "x", ")"}], 
         RowBox[{"2", " "}]], "+", 
        SuperscriptBox[
         RowBox[{"(", "y", ")"}], "2"]}], ")"}]}], "/", "5"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Hix", "[", 
    RowBox[{"x_", ",", "y_"}], "]"}], "=", " ", 
   RowBox[{"Exp", "[", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", "x", ")"}], 
         RowBox[{"2", " "}]], "+", 
        SuperscriptBox[
         RowBox[{"(", "y", ")"}], "2"]}], ")"}]}], "/", "5"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"end", "=", "10"}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EzData", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Eiz", "[", 
      RowBox[{"x", ",", "y"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"y", ",", 
       RowBox[{"-", "end"}], ",", "end", ",", "step"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"-", "end"}], ",", "end", ",", "step"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"HxData", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Hix", "[", 
      RowBox[{"x", ",", "y"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"y", ",", 
       RowBox[{"-", "end"}], ",", "end", ",", "step"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"-", "end"}], ",", "end", ",", "step"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"HyData", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"y", ",", 
       RowBox[{"-", "end"}], ",", "end", ",", "step"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"-", "end"}], ",", "end", ",", "step"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EzField", "=", "EzData"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"HxField", "=", "HxData"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"HyField", "=", "HyData"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"zeros", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "EzData", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"ydim", ",", "xdim"}], "}"}], "=", 
   RowBox[{"Dimensions", "[", "EzData", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bcRules", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"1", "->", "zeros"}], ",", 
        RowBox[{"ydim", "\[Rule]", "zeros"}]}], "}"}], ",", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Rule", "[", 
          RowBox[{"#", ",", "0"}], "]"}], "&"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"i", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "ydim"}], "}"}]}], "]"}]}], "]"}], ",", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Rule", "[", 
          RowBox[{"#", ",", "0"}], "]"}], "&"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"i", ",", "xdim"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "ydim"}], "}"}]}], "]"}]}], "]"}]}], 
     "}"}], "]"}]}], ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.505753523580099*^9, 3.5057535451936693`*^9}, {
   3.5057535842763643`*^9, 3.505753608385667*^9}, {3.505753978349527*^9, 
   3.505754019020842*^9}, {3.505754058886512*^9, 3.505754168425652*^9}, {
   3.505754210202883*^9, 3.5057542528977633`*^9}, {3.505754371143311*^9, 
   3.505754372942779*^9}, 3.50575624318289*^9, {3.509981442838191*^9, 
   3.509981469566308*^9}, {3.5099822438563023`*^9, 3.509982245700882*^9}, {
   3.5099822845032043`*^9, 3.509982333922612*^9}, 3.509987536838608*^9, {
   3.509988277701282*^9, 3.509988280043342*^9}, 3.5099883216324263`*^9}],

Cell[BoxData[
 RowBox[{"\n", 
  StyleBox["  ",
   FontColor->GrayLevel[0]], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"E0", "=", 
     RowBox[{"Apply", "[", 
      RowBox[{"Plus", ",", 
       RowBox[{"Evaluate", "[", " ", 
        RowBox[{
         RowBox[{"\[Epsilon]Data", " ", 
          SuperscriptBox["EzField", "2"]}], 
         StyleBox["+",
          FontColor->GrayLevel[0]], 
         RowBox[{
          StyleBox["\[Mu]",
           FontColor->GrayLevel[0]], 
          StyleBox[" ",
           FontColor->GrayLevel[0]], 
          RowBox[{
           StyleBox["(",
            FontColor->GrayLevel[0]], 
           RowBox[{
            SuperscriptBox["HxField", "2"], 
            StyleBox["+",
             FontColor->GrayLevel[0]], 
            SuperscriptBox["HyField", "2"]}], ")"}]}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"energy", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Mu]", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Clear", "[", 
     RowBox[{"EzField", ",", "HxField", ",", "HyField"}], "]"}], ";"}], "\n", 
   
   RowBox[{
    RowBox[{"EzField", "=", "EzData"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"HxField", "=", "HxData"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"HyField", "=", "HyData"}], ";"}], "\[IndentingNewLine]", "  ", 
   RowBox[{"ListAnimate", "[", "\n", "\t", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Do", "[", "\n", "\t", 
        RowBox[{
         RowBox[{
          RowBox[{"EzField", "=", 
           RowBox[{"EzField", "-", 
            RowBox[{
             RowBox[{"1", "/", 
              RowBox[{"(", 
               RowBox[{"2", "\[Epsilon]Data"}], ")"}]}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"dHx", "[", "HyField", "]"}], "-", 
               RowBox[{"dHy", "[", "HxField", "]"}]}], ")"}]}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"EzField", "=", 
           RowBox[{"ReplacePart", "[", 
            RowBox[{"EzField", ",", "bcRules"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"HxField", "=", 
           RowBox[{"HxField", "-", 
            RowBox[{
             RowBox[{"1", "/", 
              RowBox[{"(", 
               RowBox[{"2", "\[Epsilon]Data"}], ")"}]}], 
             RowBox[{"dEy", "[", "EzField", "]"}]}]}]}], ";", " ", "\n", "\t", 
          RowBox[{"HyField", "=", 
           RowBox[{"HyField", "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"1", "/", "2"}], "\[Mu]"}], ")"}], 
             RowBox[{"dEx", "[", "EzField", "]"}]}]}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "5"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Ez", "=", 
        RowBox[{"Interpolation", "[", 
         RowBox[{"Partition", "[", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{
             RowBox[{"Transpose", "[", 
              RowBox[{"Riffle", "[", 
               RowBox[{"grid", ",", "EzField"}], "]"}], "]"}], ",", "1"}], 
            "]"}], ",", "2"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"energies", "=", 
        RowBox[{"Interpolation", "[", 
         RowBox[{"Partition", "[", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{
             RowBox[{"Transpose", "[", 
              RowBox[{"Riffle", "[", 
               RowBox[{"grid", ",", 
                RowBox[{"Evaluate", "[", 
                 RowBox[{
                  RowBox[{"\[Epsilon]Data", " ", 
                   SuperscriptBox["EzField", "2"]}], 
                  StyleBox["+",
                   FontColor->GrayLevel[0]], 
                  RowBox[{
                   StyleBox["\[Mu]",
                    FontColor->GrayLevel[0]], 
                   StyleBox[" ",
                    FontColor->GrayLevel[0]], 
                   RowBox[{
                    StyleBox["(",
                    FontColor->GrayLevel[0]], 
                    RowBox[{
                    SuperscriptBox["HxField", "2"], 
                    StyleBox["+",
                    FontColor->GrayLevel[0]], 
                    SuperscriptBox["HyField", "2"]}], ")"}]}]}], "]"}]}], 
               "]"}], "]"}], ",", "1"}], "]"}], ",", "2"}], "]"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{
        StyleBox["AppendTo",
         FontColor->GrayLevel[0]], 
        StyleBox["[",
         FontColor->GrayLevel[0]], 
        RowBox[{
         StyleBox["energy",
          FontColor->GrayLevel[0]], 
         StyleBox[",",
          FontColor->GrayLevel[0]], 
         RowBox[{"Apply", "[", 
          RowBox[{"Plus", ",", 
           RowBox[{"Evaluate", "[", " ", 
            RowBox[{
             RowBox[{"\[Epsilon]Data", " ", 
              SuperscriptBox["EzField", "2"]}], 
             StyleBox["+",
              FontColor->GrayLevel[0]], 
             RowBox[{
              StyleBox["\[Mu]",
               FontColor->GrayLevel[0]], 
              StyleBox[" ",
               FontColor->GrayLevel[0]], 
              RowBox[{
               StyleBox["(",
                FontColor->GrayLevel[0]], 
               RowBox[{
                SuperscriptBox["HxField", "2"], 
                StyleBox["+",
                 FontColor->GrayLevel[0]], 
                SuperscriptBox["HyField", "2"]}], ")"}]}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}]}], "]"}]}], "]"}], ";", "\t", "\n",
        "\t", 
       RowBox[{"Show", "[", 
        RowBox[{
         RowBox[{"Plot3D", "[", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"Ez", "[", 
             RowBox[{"x", ",", "y"}], "]"}], "2"], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", 
             RowBox[{"-", "end"}], ",", "end"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"y", ",", 
             RowBox[{"-", "end"}], ",", "end"}], "}"}], 
           StyleBox[",",
            FontColor->GrayLevel[0]], 
           StyleBox["\n",
            FontColor->GrayLevel[0]], 
           StyleBox["\t\t",
            FontColor->GrayLevel[0]], 
           StyleBox[
            RowBox[{"PlotRange", "->", 
             RowBox[{"{", 
              RowBox[{"0", ",", "1"}], "}"}]}],
            FontColor->GrayLevel[0]], 
           StyleBox[",",
            FontColor->GrayLevel[0]], 
           StyleBox[
            RowBox[{"AxesLabel", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"\"\<x\>\"", ",", "\"\<y\>\""}], "}"}]}],
            FontColor->GrayLevel[0]], 
           StyleBox[",",
            FontColor->GrayLevel[0]], 
           RowBox[{
            StyleBox["PlotLabel",
             FontColor->GrayLevel[0]], 
            StyleBox["\[Rule]",
             FontColor->GrayLevel[0]], 
            RowBox[{
             StyleBox["StringJoin",
              FontColor->GrayLevel[0]], 
             StyleBox["[",
              FontColor->GrayLevel[0]], 
             RowBox[{
              StyleBox["\"\<Intensity \\n\>\"",
               FontColor->GrayLevel[0]], 
              StyleBox[",",
               FontColor->GrayLevel[0]], 
              "\"\<E/\!\(\*SubscriptBox[\(E\), \(0\)]\)=\>\"", ",", 
              RowBox[{"ToString", "[", 
               RowBox[{
                RowBox[{"Last", "[", "energy", "]"}], "/", "E0"}], "]"}]}], 
             "]"}]}]}], "]"}], 
         StyleBox[",",
          FontColor->GrayLevel[0]], 
         StyleBox["gratingPlot",
          FontColor->GrayLevel[0]]}], 
        StyleBox["]",
         FontColor->GrayLevel[0]]}]}], 
      StyleBox[",",
       FontColor->GrayLevel[0]], 
      StyleBox["\n",
       FontColor->GrayLevel[0]], 
      StyleBox["\t\t\t\t",
       FontColor->GrayLevel[0]], 
      StyleBox[
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "24"}], "}"}],
       FontColor->GrayLevel[0]]}], 
     StyleBox["]",
      FontColor->GrayLevel[0]]}], 
    StyleBox["]",
     FontColor->GrayLevel[0]]}]}]}]], "Input",
 CellChangeTimes->{{3.505753523580099*^9, 3.5057535451936693`*^9}, {
   3.5057535842763643`*^9, 3.505753608385667*^9}, {3.505753978349527*^9, 
   3.505754019020842*^9}, {3.505754058886512*^9, 3.505754168425652*^9}, 
   3.505754210202883*^9, {3.505754300446177*^9, 3.505754310326633*^9}, {
   3.5057543446956873`*^9, 3.505754348543817*^9}, {3.505754459329159*^9, 
   3.505754468289999*^9}, {3.505754510574546*^9, 3.505754588799971*^9}, {
   3.5057554533379383`*^9, 3.505755460841097*^9}, {3.5057555954513597`*^9, 
   3.5057556907108917`*^9}, {3.505756048726425*^9, 3.505756062164536*^9}, {
   3.5057560967522907`*^9, 3.505756164777659*^9}, {3.5067670121988153`*^9, 
   3.506767019077784*^9}, {3.50676712802658*^9, 3.5067671324101257`*^9}, {
   3.5067689468654823`*^9, 3.506768998246044*^9}, {3.508780880732251*^9, 
   3.508780882895463*^9}, {3.508781054363818*^9, 3.508781063342471*^9}, {
   3.508781265862714*^9, 3.50878127637449*^9}, 3.508781742858724*^9, 
   3.50878177427666*^9, {3.508865503701082*^9, 3.50886551302852*^9}, {
   3.5088655714144983`*^9, 3.508865574232623*^9}, {3.508866368502858*^9, 
   3.508866385969014*^9}, {3.508866505179741*^9, 3.5088665105482607`*^9}, 
   3.508867862900256*^9, {3.509119577812677*^9, 3.509119677118533*^9}, {
   3.509119709280386*^9, 3.509119745161584*^9}, {3.5091197810586767`*^9, 
   3.509119797818968*^9}, {3.5091866913289537`*^9, 3.509186710982306*^9}, {
   3.50918699666588*^9, 3.5091870794046297`*^9}, 3.509187556200564*^9, 
   3.509982507619714*^9, {3.5099829345625267`*^9, 3.509982939809218*^9}, {
   3.509982979636065*^9, 3.50998301614046*^9}, {3.511112820327751*^9, 
   3.5111128879785843`*^9}, {3.5111131971601963`*^9, 3.511113197485742*^9}, {
   3.5112746578529863`*^9, 3.511274658123048*^9}, 3.5112756534266644`*^9, {
   3.511275844524488*^9, 3.511275926724821*^9}, {3.5112759642469997`*^9, 
   3.511276026673781*^9}, {3.511276072948683*^9, 3.5112761425866547`*^9}, {
   3.5112761736246357`*^9, 3.5112761755442047`*^9}, {3.511276250790886*^9, 
   3.511276292334709*^9}, {3.51127637927929*^9, 3.511276448315611*^9}, {
   3.5116218603860903`*^9, 3.5116219110603313`*^9}}],

Cell["\<\
Checking the energy however shows that we don\[CloseCurlyQuote]t do very well.\
\>", "Text",
 CellChangeTimes->{{3.5112551225356627`*^9, 3.511255138712166*^9}}],

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{
   RowBox[{"energy", "/", 
    RowBox[{"energy", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], ",", 
   RowBox[{
   "PlotLabel", "\[Rule]", 
    "\"\<E/\!\(\*SubscriptBox[\(E\), \(0\)]\), grid size of \
101\[Cross]101\>\""}], ",", 
   RowBox[{"AxesLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
     "\"\<t\>\"", ",", "\"\<E/\!\(\*SubscriptBox[\(E\), \(0\)]\)\>\""}], 
     "}"}]}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.509987905968197*^9, 3.509987908183975*^9}, {
  3.510333624750566*^9, 3.510333627708932*^9}}],

Cell[TextData[{
 "Your first thought may be that we did not use a fine enough grid. This is \
always a possibility. Especially since we have a region where the dielectric \
constant is high (in our case 5). In this region ",
 Cell[BoxData[
  FormBox[
   RowBox[{"n", "=", 
    RowBox[{
     RowBox[{
      SqrtBox["5"], " ", "and", " ", 
      SubscriptBox["\[Lambda]", "n"]}], "=", 
     RowBox[{"\[Lambda]", "/", "n"}]}]}], TraditionalForm]]],
 " . Since the effective wavelength is smaller, we might not have enough grid \
points to satisfy our rule of thumb that we should have between 10 and 40 \
grid points per wavelength. However in this case we do have enough grid \
points, and if you re-run the code on a ",
 Cell[BoxData[
  FormBox[
   RowBox[{"201", "\[Cross]", "201"}], TraditionalForm]]],
 "grid you will see that the energy does not change much and is still not \
well conserved. In order to understand what the problem is let us plot the \
energy density as a function of time. We can make an interpolation function \
for the energy density just as we did for the electric field. I have adjusted \
the ",
 ButtonBox["Viewpoint",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://reference.wolfram.com/mathematica/ref/ViewPoint.html"], None},
  
  ButtonNote->"http://reference.wolfram.com/mathematica/ref/ViewPoint.html"],
 " to make it easier to see the energy density penetrating the dielectric."
}], "Text",
 CellChangeTimes->{{3.512228926658383*^9, 3.5122289787389812`*^9}, {
   3.512230160378633*^9, 3.512230593698963*^9}, {3.5122308560159397`*^9, 
   3.5122309037668858`*^9}, {3.512232007500082*^9, 3.512232126711361*^9}, 
   3.512232282822241*^9, {3.514819510479012*^9, 3.514819514595923*^9}, {
   3.517420198197174*^9, 3.517420275603689*^9}, {3.517420352413311*^9, 
   3.51742035241818*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"E0", "=", 
   RowBox[{"Apply", "[", 
    RowBox[{"Plus", ",", 
     RowBox[{"Evaluate", "[", " ", 
      RowBox[{
       RowBox[{"\[Epsilon]Data", " ", 
        SuperscriptBox["EzField", "2"]}], 
       StyleBox["+",
        FontColor->GrayLevel[0]], 
       RowBox[{
        StyleBox["\[Mu]",
         FontColor->GrayLevel[0]], 
        StyleBox[" ",
         FontColor->GrayLevel[0]], 
        RowBox[{
         StyleBox["(",
          FontColor->GrayLevel[0]], 
         RowBox[{
          SuperscriptBox["HxField", "2"], 
          StyleBox["+",
           FontColor->GrayLevel[0]], 
          SuperscriptBox["HyField", "2"]}], ")"}]}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"energy", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Mu]", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"EzField", ",", "HxField", ",", "HyField"}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"EzField", "=", "EzData"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"HxField", "=", "HxData"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"HyField", "=", "HyData"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"  ", 
  RowBox[{"ListAnimate", "[", "\n", "\t", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Do", "[", "\n", "\t", 
       RowBox[{
        RowBox[{
         RowBox[{"EzField", "=", 
          RowBox[{"EzField", "-", 
           RowBox[{
            RowBox[{"1", "/", 
             RowBox[{"(", 
              RowBox[{"2", "\[Epsilon]Data"}], ")"}]}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"dHx", "[", "HyField", "]"}], "-", 
              RowBox[{"dHy", "[", "HxField", "]"}]}], ")"}]}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"EzField", "=", 
          RowBox[{"ReplacePart", "[", 
           RowBox[{"EzField", ",", "bcRules"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"HxField", "=", 
          RowBox[{"HxField", "-", 
           RowBox[{
            RowBox[{"1", "/", 
             RowBox[{"(", 
              RowBox[{"2", "\[Epsilon]Data"}], ")"}]}], 
            RowBox[{"dEy", "[", "EzField", "]"}]}]}]}], ";", " ", "\n", "\t", 
         
         RowBox[{"HyField", "=", 
          RowBox[{"HyField", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"1", "/", "2"}], "\[Mu]"}], ")"}], 
            RowBox[{"dEx", "[", "EzField", "]"}]}]}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "5"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Ez", "=", 
       RowBox[{"Interpolation", "[", 
        RowBox[{"Partition", "[", 
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"Transpose", "[", 
             RowBox[{"Riffle", "[", 
              RowBox[{"grid", ",", "EzField"}], "]"}], "]"}], ",", "1"}], 
           "]"}], ",", "2"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"energies", "=", 
       RowBox[{"Interpolation", "[", 
        RowBox[{"Partition", "[", 
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"Transpose", "[", 
             RowBox[{"Riffle", "[", 
              RowBox[{"grid", ",", 
               RowBox[{"Evaluate", "[", 
                RowBox[{
                 RowBox[{"\[Epsilon]Data", " ", 
                  SuperscriptBox["EzField", "2"]}], 
                 StyleBox["+",
                  FontColor->GrayLevel[0]], 
                 RowBox[{
                  StyleBox["\[Mu]",
                   FontColor->GrayLevel[0]], 
                  StyleBox[" ",
                   FontColor->GrayLevel[0]], 
                  RowBox[{
                   StyleBox["(",
                    FontColor->GrayLevel[0]], 
                   RowBox[{
                    SuperscriptBox["HxField", "2"], 
                    StyleBox["+",
                    FontColor->GrayLevel[0]], 
                    SuperscriptBox["HyField", "2"]}], ")"}]}]}], "]"}]}], 
              "]"}], "]"}], ",", "1"}], "]"}], ",", "2"}], "]"}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{
       StyleBox["AppendTo",
        FontColor->GrayLevel[0]], 
       StyleBox["[",
        FontColor->GrayLevel[0]], 
       RowBox[{
        StyleBox["energy",
         FontColor->GrayLevel[0]], 
        StyleBox[",",
         FontColor->GrayLevel[0]], 
        RowBox[{"Apply", "[", 
         RowBox[{"Plus", ",", 
          RowBox[{"Evaluate", "[", " ", 
           RowBox[{
            RowBox[{"\[Epsilon]Data", " ", 
             SuperscriptBox["EzField", "2"]}], 
            StyleBox["+",
             FontColor->GrayLevel[0]], 
            RowBox[{
             StyleBox["\[Mu]",
              FontColor->GrayLevel[0]], 
             StyleBox[" ",
              FontColor->GrayLevel[0]], 
             RowBox[{
              StyleBox["(",
               FontColor->GrayLevel[0]], 
              RowBox[{
               SuperscriptBox["HxField", "2"], 
               StyleBox["+",
                FontColor->GrayLevel[0]], 
               SuperscriptBox["HyField", "2"]}], ")"}]}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}]}], "]"}]}], "]"}], ";", "\t", "\n", 
      "\t", 
      RowBox[{"Show", "[", 
       RowBox[{
        RowBox[{"Plot3D", "[", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"energies", "[", 
            RowBox[{"x", ",", "y"}], "]"}], "2"], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", 
            RowBox[{"-", "end"}], ",", "end"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"y", ",", 
            RowBox[{"-", "end"}], ",", "end"}], "}"}], 
          StyleBox[",",
           FontColor->GrayLevel[0]], 
          StyleBox["\n",
           FontColor->GrayLevel[0]], 
          StyleBox["\t\t",
           FontColor->GrayLevel[0]], 
          StyleBox[
           RowBox[{"PlotRange", "->", 
            RowBox[{"{", 
             RowBox[{"0", ",", "4"}], "}"}]}],
           FontColor->GrayLevel[0]], 
          StyleBox[",",
           FontColor->GrayLevel[0]], 
          StyleBox[
           RowBox[{"AxesLabel", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"\"\<x\>\"", ",", "\"\<y\>\""}], "}"}]}],
           FontColor->GrayLevel[0]], 
          StyleBox[",",
           FontColor->GrayLevel[0]], 
          RowBox[{
           StyleBox["PlotLabel",
            FontColor->GrayLevel[0]], 
           StyleBox["\[Rule]",
            FontColor->GrayLevel[0]], 
           RowBox[{
            StyleBox["StringJoin",
             FontColor->GrayLevel[0]], 
            StyleBox["[",
             FontColor->GrayLevel[0]], 
            RowBox[{
             StyleBox["\"\<energy \\n\>\"",
              FontColor->GrayLevel[0]], 
             StyleBox[",",
              FontColor->GrayLevel[0]], 
             "\"\<E/\!\(\*SubscriptBox[\(E\), \(0\)]\)=\>\"", ",", 
             RowBox[{"ToString", "[", 
              RowBox[{
               RowBox[{"Last", "[", "energy", "]"}], "/", "E0"}], "]"}]}], 
            "]"}]}]}], "]"}], 
        StyleBox[",",
         FontColor->GrayLevel[0]], 
        StyleBox["gratingPlot",
         FontColor->GrayLevel[0]], 
        StyleBox[",",
         FontColor->GrayLevel[0]], 
        RowBox[{
         StyleBox["ViewPoint",
          FontColor->GrayLevel[0]], 
         StyleBox["\[Rule]",
          FontColor->GrayLevel[0]], 
         RowBox[{
          StyleBox["{",
           FontColor->GrayLevel[0]], 
          RowBox[{"Left", ",", "Top"}], "}"}]}]}], 
       StyleBox["]",
        FontColor->GrayLevel[0]]}]}], 
     StyleBox[",",
      FontColor->GrayLevel[0]], 
     StyleBox["\n",
      FontColor->GrayLevel[0]], 
     StyleBox["\t\t\t\t",
      FontColor->GrayLevel[0]], 
     StyleBox[
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "24"}], "}"}],
      FontColor->GrayLevel[0]]}], 
    StyleBox["]",
     FontColor->GrayLevel[0]]}], 
   StyleBox["]",
    FontColor->GrayLevel[0]]}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.511622020819927*^9, 3.511622055346403*^9}, 
   3.51162222442065*^9, {3.511622270507703*^9, 3.511622297164693*^9}, {
   3.512231329965105*^9, 3.512231334963483*^9}, {3.51223185550581*^9, 
   3.5122318563197536`*^9}, {3.512231898299644*^9, 3.512231907143848*^9}, {
   3.512231975910984*^9, 3.5122319771095037`*^9}}],

Cell["\<\
From the animation we see that we our results are the worst when we have \
partial penetration of the dielectric. In this regime small errors make a big \
difference because the energy density is sensitive to \[Epsilon]. In short, \
it matters a great deal if the wave is in the dielectric or not. We did not \
see this effect to the same degree in diffraction through a slit since there \
most of the wave, and thus most of the energy density, passed through the \
slits. Here we hit the dielectric headon and small errors are magnified.\
\>", "Text",
 CellChangeTimes->{{3.5122321387756968`*^9, 3.512232154368725*^9}, {
   3.512232226062098*^9, 3.512232259588591*^9}, {3.512232300576167*^9, 
   3.512232310942588*^9}, {3.512235103487108*^9, 3.512235153806386*^9}, {
   3.512235201713151*^9, 3.51223547370045*^9}, 3.512235510228817*^9, 
   3.514819518611784*^9, {3.517420379437819*^9, 3.517420411035737*^9}}],

Cell[CellGroupData[{

Cell["Problem Four", "Subsection",
 CellChangeTimes->{{3.510484221338511*^9, 3.510484225353459*^9}, {
  3.511194399415028*^9, 3.5111944014853153`*^9}, {3.5128192889267187`*^9, 
  3.512819289918531*^9}}],

Cell["\<\
Scatter a wave off a dielectric wedge.  Be sure to plot the energy of wave as \
a function of time as well as the intensity of the electric field. A sample \
dielectric wedge that will scale with the grid size is given in the code \
below. Since you will want to show the dielectric wedge in your simulation, \
the code also generates an interpolating function for the wedge and makes a \
translucent plot of it, named \[OpenCurlyDoubleQuote]wedgePlot\
\[CloseCurlyDoubleQuote]. What happens to energy conservation as you change \
the dielectric constant?\
\>", "Text",
 CellChangeTimes->{{3.512819190595783*^9, 3.5128192182751637`*^9}, {
   3.51281930366261*^9, 3.5128193542487917`*^9}, {3.512819386177835*^9, 
   3.512819402562489*^9}, {3.512819434468192*^9, 3.512819480773673*^9}, {
   3.512820434387622*^9, 3.512820584098118*^9}, {3.512821630164213*^9, 
   3.512821656403624*^9}, 3.514819524574066*^9, {3.514826230913391*^9, 
   3.514826233846641*^9}, {3.517420441664097*^9, 3.5174204525667133`*^9}}],

Cell[BoxData[{
 RowBox[{"Clear", "[", "step", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"scale", "=", 
   RowBox[{"step", "/", "0.1"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"step", "=", "0.1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"end", "=", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"grid", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", "y"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"y", ",", 
       RowBox[{"-", "end"}], ",", "end", ",", "step"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"-", "end"}], ",", "end", ",", "step"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Epsilon]Data", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"y", "-", 
             RowBox[{"150", "/", "scale"}]}], ")"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"x", "-", 
             RowBox[{"100", "/", "scale"}]}], ")"}], "2"]}], "<", 
         RowBox[{"1200", "/", "scale"}]}], "&&", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"y", "-", 
               RowBox[{"150", "/", "scale"}]}], ")"}], "2"], "-", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"x", "-", 
               RowBox[{"100", "/", "scale"}]}], ")"}], "2"]}], "<", "0"}], "||", 
          RowBox[{"y", ">", 
           RowBox[{"150", "/", "scale"}]}]}], ")"}]}], ",", "2", ",", "1"}], 
      "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"y", ",", "0", ",", 
       RowBox[{"200", "/", "scale"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "0", ",", 
       RowBox[{"200", "/", "scale"}], ",", "1"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ListDensityPlot", "[", "\[Epsilon]Data", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"wedge", "=", 
   RowBox[{"Interpolation", "[", 
    RowBox[{"Partition", "[", 
     RowBox[{
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"Transpose", "[", 
         RowBox[{"Riffle", "[", 
          RowBox[{"grid", ",", 
           RowBox[{"\[Epsilon]Data", "-", "1"}]}], "]"}], "]"}], ",", "1"}], 
       "]"}], ",", "2"}], "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"wedgePlot", "=", 
   RowBox[{"Plot3D", "[", 
    RowBox[{
     RowBox[{"wedge", "[", 
      RowBox[{"x", ",", "y"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"-", "end"}], ",", "end"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"y", ",", 
       RowBox[{"-", "end"}], ",", "end"}], "}"}], ",", 
     RowBox[{"PlotStyle", "->", 
      RowBox[{"Opacity", "[", ".3", "]"}]}], ",", 
     RowBox[{"Mesh", "\[Rule]", "None"}], ",", 
     RowBox[{"Axes", "\[Rule]", "None"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.510476804090559*^9, 3.510476835205168*^9}, {
   3.510476869822904*^9, 3.5104769189444513`*^9}, {3.51047696873892*^9, 
   3.510476988716111*^9}, {3.510477018957301*^9, 3.510477090703783*^9}, {
   3.5104834939224052`*^9, 3.510483588022463*^9}, {3.5104836388799257`*^9, 
   3.510483705417901*^9}, {3.510483982801038*^9, 3.510483995630701*^9}, {
   3.510484026422621*^9, 3.510484136732271*^9}, {3.51048417053244*^9, 
   3.5104841899172077`*^9}, {3.51049729467102*^9, 3.510497300841482*^9}, 
   3.5111146869900723`*^9, {3.5111147444960413`*^9, 3.511114744977014*^9}, {
   3.5128205887612*^9, 3.5128206170807943`*^9}, {3.512821154112795*^9, 
   3.512821156470956*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Problem Five", "Subsection",
 CellChangeTimes->{{3.510484221338511*^9, 3.510484225353459*^9}, {
  3.511194399415028*^9, 3.5111944014853153`*^9}, {3.5128192889267187`*^9, 
  3.512819289918531*^9}, {3.512820382092642*^9, 3.512820382793346*^9}}],

Cell["\<\
Make up your own dielectric structure and scatter a wave off it. Comment on \
your results. Among the questions you should address are:
Do your results match your physical intuition?
How do you know if your answer is accurate? 
How accurate is it? 
Do you believe the results from your simulation? 

Yes or no answers are not acceptable. You must explain your answers and be \
able to defend them.\
\>", "Text",
 CellChangeTimes->{{3.512819533930537*^9, 3.512819820651574*^9}, {
  3.512820398802279*^9, 3.5128203991621304`*^9}, {3.514045036028954*^9, 
  3.514045040465889*^9}, {3.514826258484294*^9, 3.5148262605201807`*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Projects", "Section",
 CellChangeTimes->{{3.512819525808969*^9, 3.512819528703562*^9}}],

Cell["\<\
There are numerous possible projects. I have listed a few as suggestions, but \
you should be able to come up with many others if none of these interest you.

\[Bullet]\tWe have looked at the TM modes. Study the TE modes. Be sure to \
comment on the differences between the TM modes and the TE modes.

\[Bullet]\tMake a dielectric lens. There are several ways to do this. You \
could make a \[OpenCurlyDoubleQuote]spherical\[CloseCurlyDoubleQuote] lens, \
which in two dimensions would be a disk. You could also look at a parabolic \
lens or a convex lens. Are your results what you would expect? Are you in the \
ray optics limit?

\[Bullet]\tInstead of a dielectric, scatter a wave off a perfect conductor. \
You may wish to look at Yee [2].

\[Bullet]\tFor the one-dimensional case, simulate a thin film coating. What \
do you gain by using multiple layers?

\[Bullet]\tRedo problem three for elliptically polarized waves.
\
\>", "Text",
 CellChangeTimes->{{3.5140454028896017`*^9, 3.5140454935077763`*^9}, {
   3.514045557182979*^9, 3.514045781815301*^9}, {3.514045818416698*^9, 
   3.514045997631948*^9}, {3.514046030076578*^9, 3.5140460945077457`*^9}, {
   3.514046180163081*^9, 3.51404620747987*^9}, 3.514739527301901*^9, 
   3.514826262534531*^9, {3.5174205429968557`*^9, 3.5174205816620817`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["References", "Section",
 CellChangeTimes->{{3.4831818311299753`*^9, 3.4831818352084103`*^9}}],

Cell[TextData[{
 "[1]\tJohn D. Joannopoulos, Steven G. Johnson, Joshua N. Winn & Robert D. \
Meade, \t\t\[OpenCurlyDoubleQuote]",
 StyleBox["Photonic Crystals: Molding the Flow of Light",
  FontSlant->"Italic"],
 "\[CloseCurlyDoubleQuote], Princeton, 2008.\n[2]\tPeter Vukusic & J. Roy \
Sambles, \[OpenCurlyDoubleQuote]",
 StyleBox["Photonic structures in biology",
  FontSlant->"Italic"],
 "\[CloseCurlyDoubleQuote], Nature 424, \t\t852-855 (14 August 2003) | \
doi:10.1038/nature01941\n[3] \tK.Yee, IEEE Transactions on Antennas and \
Propagation\n\tAP - ",
 StyleBox["14",
  FontWeight->"Bold"],
 ", p302 (1966).\n[4]\tDavid W. Ward and Keith A. Nelson,",
 StyleBox[" Finite Difference Time Domain (FDTD) \t\tSimulations of \
Electromagnetic Wave Propagation Using a Spreadsheet",
  FontSlant->"Italic"],
 ".  \t\t\tArix:physics/0402096 v1 2004.\n[5]\tM. Sipos and B. G. Thompson, \
",
 StyleBox["Electrodynamics on a grid: The finite -difference time \tdomain \
method applied to optics and cloaking",
  FontSlant->"Italic"],
 ", Am. J. Phys. ",
 StyleBox["76",
  FontWeight->"Bold"],
 " p 464, 2008.\n[6]\t",
 StyleBox["Computational Electrodynamics: The Finite-Difference Time-Domain \
Method",
  FontSlant->"Italic"],
 ", edited \tby A. Taflove and S.C. Hagness (Artech House, Boston, 2005), 3rd \
ed.\n[7]\tBo. Yang and Constantine A. Balanis, ",
 StyleBox["Divergence Properties of the Nonstandard \t\tFinite Difference \
Methods",
  FontSlant->"Italic"],
 ", IEEE Microwave and Wireless Components Lett. ",
 StyleBox["17",
  FontWeight->"Bold"],
 ", p88, \t2007.\n[8]\tR. Courant, K. Friedrichs and H. Lewy, ",
 StyleBox["On the partial difference equations of \t\t\tmathematical physics",
  
  FontSlant->"Italic"],
 ", IBM J. of Research and Development, ",
 StyleBox["11",
  FontWeight->"Bold"],
 ",  p215, 1967\n[9]\tLandau, P\[AAcute]ez and Bordeianu, ",
 StyleBox["A Survey of Computational Physics",
  FontSlant->"Italic"],
 ", p499, \t\t\tPrinceton, 2008."
}], "Text",
 CellChangeTimes->{{3.483181841385594*^9, 3.483181849349716*^9}, {
   3.485513007153853*^9, 3.485513178677846*^9}, 3.485769885762475*^9, {
   3.485879144699141*^9, 3.485879307809474*^9}, {3.486140722827366*^9, 
   3.4861410542464323`*^9}, {3.48614119528829*^9, 3.486141331857943*^9}, 
   3.486287695562256*^9, 3.48628784937599*^9, {3.486316556895561*^9, 
   3.4863165890545807`*^9}, {3.486316662745298*^9, 3.486316995085169*^9}, 
   3.514734025351156*^9, {3.514739334963681*^9, 3.514739517274571*^9}, {
   3.5147410824209023`*^9, 3.514741228784786*^9}, 3.5147412786496067`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Glossary", "Subsubtitle",
 CellChangeTimes->{{3.449312267847327*^9, 3.449312269844873*^9}},
 TextAlignment->Center,
 TextJustification->0.],

Cell["\<\
I have provided a hyperlinked glossary for some of the concepts that appear \
in the notebook. Clicking on the term will take you to a website with more \
information about the link. I have tried to use sites that I think will be \
persistent so that the links will continue to work over time.\
\>", "Text",
 CellChangeTimes->{{3.449333567804854*^9, 3.449333712972444*^9}, {
  3.4493345441355047`*^9, 3.449334548811906*^9}}],

Cell["", "Text"],

Cell[TextData[{
 ButtonBox["Circular Polarization",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://webphysics.davidson.edu/physlet_resources/dav_optics/Examples/\
polarization.html"], None},
  ButtonNote->
   "http://webphysics.davidson.edu/physlet_resources/dav_optics/Examples/\
polarization.html"],
 "\n",
 ButtonBox["Dispersion",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://en.wikipedia.org/wiki/Dispersion_(optics)"], None},
  ButtonNote->"http://en.wikipedia.org/wiki/Dispersion_(optics)"],
 "\n",
 ButtonBox["Electric Polarization",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://scienceworld.wolfram.com/physics/ElectricPolarization.html"], 
    None},
  ButtonNote->
   "http://scienceworld.wolfram.com/physics/ElectricPolarization.html"],
 "\n",
 ButtonBox["Elliptical Polarization",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://webphysics.davidson.edu/physlet_resources/dav_optics/Examples/\
polarization.html"], None},
  ButtonNote->
   "http://webphysics.davidson.edu/physlet_resources/dav_optics/Examples/\
polarization.html"],
 "\n",
 ButtonBox["Linear Polarization",
  BaseStyle->"Hyperlink",
  ButtonData->{"Linear Polarization", None}],
 "\n",
 ButtonBox["Magnetization",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://scienceworld.wolfram.com/physics/Magnetization.html"], None},
  ButtonNote->"http://scienceworld.wolfram.com/physics/Magnetization.html"],
 "\n",
 ButtonBox["Permittivity",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://www.britannica.com/EBchecked/topic/452314/permittivity"], 
    None},
  ButtonNote->"http://www.britannica.com/EBchecked/topic/452314/permittivity"],
 "\n",
 ButtonBox["TEM Mode",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://scienceworld.wolfram.com/physics/Waveguide.html"], None},
  ButtonNote->"http://scienceworld.wolfram.com/physics/Waveguide.html"],
 "\n"
}], "Text",
 CellChangeTimes->{
  3.514884657835923*^9, {3.514884701316958*^9, 3.5148847650461273`*^9}, {
   3.5149032370866623`*^9, 3.514903310871476*^9}, {3.5149034934531527`*^9, 
   3.5149035339897337`*^9}, {3.514903604704246*^9, 3.514903604707768*^9}, {
   3.514903688740665*^9, 3.514903688744134*^9}, {3.5149037388158007`*^9, 
   3.5149037388193007`*^9}, {3.514909396930707*^9, 3.514909396934111*^9}, {
   3.51490956075062*^9, 3.514909570253474*^9}, 3.514910366999819*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowToolbars->{"RulerBar", "EditBar"},
WindowSize->{868, 1140},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
PrintingCopies->1,
PrintingPageRange->{1, Automatic},
PrintingOptions->{"PaperOrientation"->"Portrait",
"PaperSize"->{600, 780}},
ShowSelection->True,
Magnification:>FEPrivate`If[
  FEPrivate`Equal[FEPrivate`$VersionNumber, 6.], 1.5, 1.5 Inherited],
FrontEndVersion->"8.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (February 23, \
2011)",
StyleDefinitions->"Default.nb",
PrivateNotebookOptions -> {"NotebookAuthor" -> ""}
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "partial differential equations -solution by finite differences"->{
  Cell[90039, 2376, 3103, 50, 675, "Input",
   CellTags->{
    "partial differential equations -solution by finite differences", 
     "diffusion equation"}]},
 "diffusion equation"->{
  Cell[90039, 2376, 3103, 50, 675, "Input",
   CellTags->{
    "partial differential equations -solution by finite differences", 
     "diffusion equation"}]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"partial differential equations -solution by finite differences", 255280, \
6859},
 {"diffusion equation", 255465, 6864}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[545, 20, 69, 1, 40, "Input"],
Cell[CellGroupData[{
Cell[639, 25, 167, 3, 185, "Title"],
Cell[809, 30, 434, 12, 129, "Text"],
Cell[1246, 44, 1349, 18, 36, "Subsubsubsection"],
Cell[CellGroupData[{
Cell[2620, 66, 110, 1, 25, "Subsubsection"],
Cell[2733, 69, 563, 9, 129, "Text"],
Cell[CellGroupData[{
Cell[3321, 82, 131, 1, 36, "Subsubsubsection"],
Cell[3455, 85, 972, 18, 152, "Text"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[4476, 109, 113, 1, 36, "Subsubsection"],
Cell[4592, 112, 971, 15, 84, "Text"],
Cell[5566, 129, 16, 0, 39, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5619, 134, 104, 1, 36, "Subsubsection"],
Cell[CellGroupData[{
Cell[5748, 139, 101, 1, 36, "Subsubsubsection"],
Cell[5852, 142, 1009, 35, 90, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6898, 182, 107, 1, 36, "Subsubsubsection"],
Cell[7008, 185, 450, 8, 66, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7495, 198, 154, 2, 36, "Subsubsubsection"],
Cell[7652, 202, 782, 12, 90, "Text"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[8483, 220, 112, 1, 36, "Subsubsection"],
Cell[8598, 223, 643, 16, 264, "Text"],
Cell[9244, 241, 84, 1, 39, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9365, 247, 179, 2, 36, "Subsubsection"],
Cell[9547, 251, 175, 3, 39, "Text"],
Cell[9725, 256, 599, 19, 115, "Text"],
Cell[10327, 277, 200, 3, 39, "Text"],
Cell[10530, 282, 541, 10, 64, "Text"],
Cell[11074, 294, 142, 2, 39, "Text"],
Cell[11219, 298, 413, 8, 41, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11669, 311, 176, 2, 36, "Subsubsection"],
Cell[11848, 315, 474, 9, 62, "Text"],
Cell[12325, 326, 84, 1, 39, "Text"],
Cell[12412, 329, 2430, 39, 332, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14879, 373, 102, 1, 69, "Subtitle"],
Cell[14984, 376, 983, 15, 129, "Text"],
Cell[15970, 393, 1508, 45, 141, "Text"],
Cell[17481, 440, 1305, 43, 102, "Text"],
Cell[18789, 485, 1338, 42, 146, "Input"],
Cell[20130, 529, 1670, 56, 96, "Text"],
Cell[21803, 587, 3412, 95, 268, "Text"],
Cell[25218, 684, 782, 12, 84, "Text"],
Cell[26003, 698, 5424, 113, 592, "Input"],
Cell[31430, 813, 583, 10, 56, "Text"],
Cell[32016, 825, 3383, 103, 357, "Text"],
Cell[35402, 930, 4301, 114, 468, "Input"],
Cell[39706, 1046, 884, 26, 65, "Text"],
Cell[40593, 1074, 3420, 83, 350, "Input"],
Cell[44016, 1159, 109, 1, 39, "Text"],
Cell[44128, 1162, 3349, 84, 324, "Input"],
Cell[47480, 1248, 6655, 197, 265, "Text"],
Cell[54138, 1447, 517, 10, 84, "Text"],
Cell[CellGroupData[{
Cell[54680, 1461, 160, 2, 100, "Section"],
Cell[54843, 1465, 535, 10, 84, "Text"],
Cell[55381, 1477, 1866, 51, 253, "Text"],
Cell[57250, 1530, 1117, 28, 107, "Text"],
Cell[58370, 1560, 484, 13, 42, "Input"],
Cell[58857, 1575, 417, 10, 62, "Text"],
Cell[59277, 1587, 437, 10, 40, "Input"],
Cell[59717, 1599, 2404, 56, 242, "Text"],
Cell[62124, 1657, 575, 9, 40, "Input"],
Cell[62702, 1668, 2001, 58, 234, "Input"],
Cell[64706, 1728, 906, 23, 62, "Text"],
Cell[65615, 1753, 269, 7, 40, "Input"],
Cell[65887, 1762, 362, 6, 62, "Text"],
Cell[66252, 1770, 166, 3, 40, "Input"],
Cell[66421, 1775, 166, 3, 40, "Input"],
Cell[66590, 1780, 144, 1, 39, "Text"],
Cell[66737, 1783, 169, 3, 40, "Input"],
Cell[66909, 1788, 190, 4, 39, "Text"],
Cell[67102, 1794, 203, 4, 40, "Input"],
Cell[67308, 1800, 3141, 77, 309, "Text"],
Cell[70452, 1879, 5089, 135, 571, "Input"],
Cell[75544, 2016, 547, 9, 84, "Text"],
Cell[76094, 2027, 401, 6, 40, "Input"],
Cell[76498, 2035, 87, 1, 64, "Input"],
Cell[76588, 2038, 973, 29, 107, "Text"],
Cell[77564, 2069, 131, 2, 40, "Input"],
Cell[77698, 2073, 415, 10, 62, "Text"],
Cell[78116, 2085, 127, 2, 40, "Input"],
Cell[78246, 2089, 1721, 42, 115, "Text"],
Cell[CellGroupData[{
Cell[79992, 2135, 126, 2, 51, "Subsection"],
Cell[80121, 2139, 1153, 20, 174, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[81311, 2164, 172, 2, 51, "Subsection"],
Cell[81486, 2168, 729, 11, 152, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[82252, 2184, 115, 1, 51, "Subsection"],
Cell[82370, 2187, 948, 22, 107, "Text"],
Cell[83321, 2211, 2714, 63, 270, "Input"],
Cell[86038, 2276, 482, 18, 58, "Text"],
Cell[86523, 2296, 434, 7, 60, "Input"],
Cell[86960, 2305, 133, 2, 58, "Text"],
Cell[87096, 2309, 694, 14, 60, "Input"],
Cell[87793, 2325, 267, 5, 93, "Text"],
Cell[88063, 2332, 526, 13, 60, "Input"],
Cell[88592, 2347, 273, 5, 60, "Input"],
Cell[88868, 2354, 1168, 20, 228, "Text"],
Cell[90039, 2376, 3103, 50, 675, "Input",
 CellTags->{
  "partial differential equations -solution by finite differences", 
   "diffusion equation"}],
Cell[93145, 2428, 407, 7, 93, "Text"],
Cell[93555, 2437, 3263, 76, 258, "Input"],
Cell[96821, 2515, 401, 12, 58, "Text"],
Cell[97225, 2529, 306, 5, 60, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[97568, 2539, 226, 3, 76, "Subsection"],
Cell[97797, 2544, 865, 20, 160, "Text"],
Cell[98665, 2566, 1496, 40, 238, "Text"],
Cell[100164, 2608, 119, 1, 58, "Text"],
Cell[100286, 2611, 2880, 80, 610, "Text"],
Cell[103169, 2693, 599, 15, 97, "Text"],
Cell[103771, 2710, 3371, 99, 307, "Text"],
Cell[107145, 2811, 289, 3, 58, "Text"],
Cell[107437, 2816, 399, 11, 60, "Input"],
Cell[107839, 2829, 374, 6, 93, "Text"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[108262, 2841, 163, 2, 150, "Section"],
Cell[108428, 2845, 560, 11, 126, "Text"],
Cell[108991, 2858, 3419, 83, 525, "Input"],
Cell[112413, 2943, 109, 1, 58, "Text"],
Cell[112525, 2946, 3349, 84, 486, "Input"],
Cell[115877, 3032, 161, 2, 58, "Text"],
Cell[116041, 3036, 1557, 42, 198, "Text"],
Cell[117601, 3080, 1068, 28, 142, "Input"],
Cell[118672, 3110, 118, 2, 60, "Input"],
Cell[118793, 3114, 2358, 61, 265, "Text"],
Cell[121154, 3177, 1096, 25, 165, "Input"],
Cell[122253, 3204, 297, 6, 58, "Text"],
Cell[122553, 3212, 1493, 42, 199, "Input"],
Cell[124049, 3256, 444, 11, 96, "Input"],
Cell[124496, 3269, 655, 13, 160, "Text"],
Cell[125154, 3284, 1244, 33, 234, "Input"],
Cell[126401, 3319, 638, 16, 130, "Input"],
Cell[127042, 3337, 848, 23, 165, "Input"],
Cell[127893, 3362, 148, 3, 60, "Input"],
Cell[128044, 3367, 1222, 25, 193, "Text"],
Cell[129269, 3394, 466, 14, 60, "Input"],
Cell[129738, 3410, 610, 12, 93, "Text"],
Cell[130351, 3424, 430, 12, 60, "Input"],
Cell[130784, 3438, 138, 3, 58, "Text"],
Cell[130925, 3443, 436, 12, 60, "Input"],
Cell[131364, 3457, 412, 10, 58, "Text"],
Cell[131779, 3469, 221, 4, 60, "Input"],
Cell[132003, 3475, 256, 5, 58, "Text"],
Cell[132262, 3482, 207, 4, 60, "Input"],
Cell[132472, 3488, 202, 4, 58, "Text"],
Cell[132677, 3494, 343, 9, 130, "Input"],
Cell[133023, 3505, 108, 1, 58, "Text"],
Cell[133134, 3508, 484, 13, 96, "Input"],
Cell[133621, 3523, 113, 1, 58, "Text"],
Cell[133737, 3526, 415, 11, 130, "Input"],
Cell[134155, 3539, 107, 1, 58, "Text"],
Cell[134265, 3542, 575, 16, 96, "Input"],
Cell[134843, 3560, 701, 13, 126, "Text"],
Cell[135547, 3575, 478, 13, 96, "Input"],
Cell[136028, 3590, 489, 8, 126, "Text"],
Cell[136520, 3600, 276, 6, 96, "Input"],
Cell[136799, 3608, 651, 19, 93, "Text"],
Cell[137453, 3629, 534, 15, 96, "Input"],
Cell[137990, 3646, 100, 1, 60, "Input"],
Cell[138093, 3649, 258, 5, 93, "Text"],
Cell[138354, 3656, 309, 7, 60, "Input"],
Cell[138666, 3665, 87, 1, 58, "Text"],
Cell[138756, 3668, 241, 6, 60, "Input"],
Cell[139000, 3676, 554, 13, 126, "Text"],
Cell[139557, 3691, 293, 7, 60, "Input"],
Cell[139853, 3700, 402, 13, 93, "Text"],
Cell[140258, 3715, 1188, 38, 171, "Input"],
Cell[141449, 3755, 1581, 39, 160, "Text"],
Cell[143033, 3796, 364, 10, 60, "Input"],
Cell[143400, 3808, 208, 4, 93, "Text"],
Cell[143611, 3814, 696, 20, 130, "Input"],
Cell[144310, 3836, 757, 17, 93, "Text"],
Cell[145070, 3855, 334, 11, 60, "Input"],
Cell[145407, 3868, 167, 2, 58, "Text"],
Cell[145577, 3872, 911, 28, 96, "Input"],
Cell[146491, 3902, 156, 3, 58, "Text"],
Cell[146650, 3907, 1093, 33, 199, "Input"],
Cell[147746, 3942, 87, 1, 58, "Text"],
Cell[147836, 3945, 162, 3, 60, "Input"],
Cell[148001, 3950, 97, 1, 58, "Text"],
Cell[148101, 3953, 151, 4, 58, "Text"],
Cell[148255, 3959, 1634, 47, 268, "Input"],
Cell[149892, 4008, 123, 3, 58, "Text"],
Cell[150018, 4013, 1307, 32, 268, "Input"],
Cell[151328, 4047, 1935, 52, 300, "Text"],
Cell[153266, 4101, 10351, 271, 943, "Input"],
Cell[163620, 4374, 2344, 63, 267, "Text"],
Cell[165967, 4439, 235, 6, 60, "Input"],
Cell[166205, 4447, 918, 23, 58, "Text"],
Cell[167126, 4472, 153, 3, 60, "Input"],
Cell[167282, 4477, 279, 5, 58, "Text"],
Cell[167564, 4484, 310, 8, 60, "Input"],
Cell[167877, 4494, 408, 10, 58, "Text"],
Cell[168288, 4506, 87, 2, 60, "Input"],
Cell[168378, 4510, 485, 11, 93, "Text"],
Cell[168866, 4523, 212, 5, 60, "Input"],
Cell[169081, 4530, 1241, 27, 202, "Text"],
Cell[170325, 4559, 157, 4, 60, "Input"],
Cell[170485, 4565, 273, 6, 96, "Input"],
Cell[170761, 4573, 6265, 159, 558, "Input"],
Cell[177029, 4734, 210, 5, 58, "Text"],
Cell[177242, 4741, 592, 16, 99, "Input"],
Cell[177837, 4759, 397, 9, 93, "Text"],
Cell[178237, 4770, 3382, 99, 648, "Input"],
Cell[181622, 4871, 6415, 163, 592, "Input"],
Cell[188040, 5036, 221, 5, 58, "Text"],
Cell[188264, 5043, 673, 18, 133, "Input"],
Cell[188940, 5063, 470, 7, 160, "Text"],
Cell[189413, 5072, 356, 8, 130, "Input"],
Cell[189772, 5082, 1232, 30, 201, "Text"],
Cell[191007, 5114, 1111, 30, 199, "Input"],
Cell[192121, 5146, 296, 4, 60, "Input"],
Cell[192420, 5152, 82, 1, 58, "Text"],
Cell[192505, 5155, 1238, 39, 130, "Text"],
Cell[193746, 5196, 3359, 101, 499, "Input"],
Cell[197108, 5299, 1628, 48, 268, "Input"],
Cell[198739, 5349, 1002, 19, 160, "Text"],
Cell[199744, 5370, 1062, 30, 234, "Input"],
Cell[200809, 5402, 92, 1, 60, "Input"],
Cell[200904, 5405, 7567, 193, 898, "Input"],
Cell[208474, 5600, 608, 12, 160, "Text"],
Cell[209085, 5614, 575, 16, 133, "Input"],
Cell[209663, 5632, 298, 6, 93, "Text"],
Cell[209964, 5640, 1000, 26, 199, "Input"],
Cell[210967, 5668, 842, 25, 130, "Input"],
Cell[211812, 5695, 331, 7, 60, "Input"],
Cell[212146, 5704, 133, 3, 58, "Text"],
Cell[212282, 5709, 1208, 32, 234, "Input"],
Cell[213493, 5743, 1047, 36, 171, "Input"],
Cell[214543, 5781, 4477, 134, 741, "Input"],
Cell[219023, 5917, 10298, 260, 1288, "Input"],
Cell[229324, 6179, 170, 3, 58, "Text"],
Cell[229497, 6184, 622, 17, 133, "Input"],
Cell[230122, 6203, 1824, 37, 372, "Text"],
Cell[231949, 6242, 8547, 243, 1297, "Input"],
Cell[240499, 6487, 919, 13, 228, "Text"],
Cell[CellGroupData[{
Cell[241443, 6504, 202, 3, 76, "Subsection"],
Cell[241648, 6509, 1014, 15, 228, "Text"],
Cell[242665, 6526, 3764, 101, 543, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[246466, 6632, 248, 3, 76, "Subsection"],
Cell[246717, 6637, 635, 13, 328, "Text"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[247401, 6656, 93, 1, 150, "Section"],
Cell[247497, 6659, 1315, 26, 633, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[248849, 6690, 99, 1, 150, "Section"],
Cell[248951, 6693, 2565, 57, 700, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[251553, 6755, 145, 3, 58, "Subsubtitle"],
Cell[251701, 6760, 434, 7, 126, "Text"],
Cell[252138, 6769, 16, 0, 58, "Text"],
Cell[252157, 6771, 2380, 63, 328, "Text"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
